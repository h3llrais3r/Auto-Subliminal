"use strict";!function(n){PubSub.subscribe(n.settings.LOADED,function(){n.library.checkScannerRunning(),PubSub.subscribe(n.websockets.PROCESS_STARTED,n.library.scannerStartedEventSubscriber),PubSub.subscribe(n.websockets.PROCESS_FINISHED,n.library.scannerFinishedEventSubscriber),window.Vue.component("library-movie-details",{data:function(){return{movie:null,imdbUrl:n.IMDB_URL,posterFullSizeUrl:n.getUrl("/artwork/imdb/poster/fullsize/"),posterThumbnailUrl:n.getUrl("/artwork/imdb/poster/thumbnail/"),languages:n.LANGUAGES,movieSettings:null,movieSettingsWantedLanguages:[],selectedFileLocation:null,selectedFileName:null,selectedHardcodedLanguages:[]}},created:function(){},mounted:function(){this.getMovieDetails()},updated:function(){n.keepDropdownsOpen(),n.vue.styleProgressBar(this.movieProgressPercentage)},computed:{movieProgressPercentage:function(){return this.movie.total_subtitles_available/this.movie.total_subtitles_wanted*100},movieProgressText:function(){return this.movie.total_subtitles_available+" of "+this.movie.total_subtitles_wanted}},methods:{getMovieDetails:function(){var t=this,i=window.location.href.substr(window.location.href.lastIndexOf("/")+1);$(".loading").removeClass("hidden"),$.get(n.getUrl("/api/movies/"+i),function(e){t.movie=e,t.movieSettings=t.movie.settings}).fail(function(e){404==e.status&&$.deleteJson(n.getUrl("/api/movies/"+i),null,function(){var e=n.types.Notification();e.message="Movie does not exist anymore and has been removed from the library!",e.type=n.notifications.WARNING,e.sticky=!1,n.notifications.showNotification(e),window.location=n.getUrl("/library/movies")})}).always(function(){$(".loading").addClass("hidden")})},setPosterPlaceholderUrl:n.vue.setPosterPlaceholderUrl,getPlayVideoUrl:n.constructPlayVideoUrl,getLanguages:n.convertToLanguages,getLanguageCodes:n.convertToLanguageCodes,internalLanguagesAvailable:function(e){var t=!1;return(e.hardcoded_languages&&0<e.hardcoded_languages.length||e.embedded_languages&&0<e.embedded_languages.length)&&(t=!0),t},refreshMovieDetails:function(e){e.preventDefault();var t=this;$(".refresh-running").removeClass("hidden"),$.putJson(n.getUrl("/api/movies/"+t.movie.imdb_id+"/refresh"),null,function(){t.getMovieDetails(),$(".refresh-running").addClass("hidden")})},openSettingsModal:function(e){e.preventDefault();var t=this;t.movieSettings=t.movie.settings,t.movieSettingsWantedLanguages=t.getLanguages(t.movie.settings.wanted_languages),$("#settingsModal").modal("show")},openDeleteModal:function(e){e.preventDefault(),$("#deleteModal").modal("show")},openSubtitlesModal:function(e,t,i,n){n.preventDefault();var a=this;a.selectedFileLocation=e,a.selectedFileName=t,a.selectedHardcodedLanguages=a.getLanguages(i),$("#subtitlesModal").modal("show")},saveSettings:function(e){e.preventDefault();var t=this,i=t.movieSettings;i.wanted_languages=t.getLanguageCodes(t.movieSettingsWantedLanguages),$.putJson(n.getUrl("/api/movies/"+t.movie.imdb_id+"/settings"),i,function(){$("#settingsModal").modal("hide"),t.refreshMovieDetails(e)})},deleteMovie:function(e){e.preventDefault(),$.deleteJson(n.getUrl("/api/movies/"+this.movie.imdb_id),null,function(){$("#deleteModal").modal("hide"),window.location=n.getUrl("/library/movies")})},saveHardcodedSubtitles:function(e){e.preventDefault();var t=this,i={file_location:t.selectedFileLocation,file_name:t.selectedFileName,languages:t.getLanguageCodes(t.selectedHardcodedLanguages)};$.putJson(n.getUrl("/api/movies/"+t.movie.imdb_id+"/subtitles/hardcoded"),i,function(){$("#subtitlesModal").modal("hide"),t.getMovieDetails()})},addMoviePathToVideoPaths:function(e){e.preventDefault();var t=this,i={videoPath:t.movie.path};$.putJson(n.getUrl("/api/settings/general/videoPaths"),i,function(){t.getMovieDetails()})}}}),window.Vue.component("multiselect",window.VueMultiselect.default),new window.Vue({el:"#app"})})}(autosubliminal);