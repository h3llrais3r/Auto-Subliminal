"use strict";!function(d){PubSub.subscribe(d.settings.LOADED,function(){window.Vue.component("settings",{props:{type:String,indexerId:String,title:String,settings:Object},data:function(){return{languages:d.LANGUAGES,wantedLanguages:[]}},computed:{posterThumbnailUrl:function(){var e="";return this.type==d.EPISODE_TYPE?e="tvdb":this.type==d.MOVIE_TYPE&&(e="imdb"),d.getUrl("/artwork/"+e+"/poster/thumbnail/")}},watch:{settings:function(e){var t=this;e&&e.wanted_languages&&(t.wantedLanguages=t.getLanguages(t.settings.wanted_languages))}},created:function(){},mounted:function(){},updated:function(){d.keepDropdownsOpen()},methods:{setPosterPlaceholderUrl:d.vue.setPosterPlaceholderUrl,getLanguages:d.convertToLanguages,getLanguageCodes:d.convertToLanguageCodes,saveSettings:function(e){e.preventDefault();var t=this,n="";t.type==d.EPISODE_TYPE?n=d.getUrl("/api/shows/"+t.indexerId+"/settings"):t.type==d.MOVIE_TYPE&&(n=d.getUrl("/api/movies/"+t.indexerId+"/settings"));var i=t.settings;i.wanted_languages=t.getLanguageCodes(t.wantedLanguages),$.putJson(n,i,function(){$("#settingsModal").modal("hide")})}}}),window.Vue.component("multiselect",window.VueMultiselect.default),new window.Vue({el:"#app",data:function(){return{type:null,indexerId:null,title:null,settings:null}},created:function(){},mounted:function(){this.setupHome()},updated:function(){},methods:{setupHome:function(){d.keepDropdownsOpen(),$("#wanteditems").tablesorter({debug:!1,widgets:["reflow","filter","saveSort"],widgetOptions:{filter_columnFilters:!1,filter_external:".wanteditems-filter",filter_searchDelay:50,filter_saveFilters:!0,filter_reset:".wanteditems-filter-reset"},dateFormat:d.TABLESORTER_DATE_FORMAT,headers:{0:{sorter:"false"},1:{sorter:"text"}},sortList:[[9,1]],initialized:function(){var e=$("#wanteditems");e.find(".loading-row").remove(),e.find(".content-row").removeClass("hidden"),e.trigger("update")}}).tablesorterPager({container:$("#wanteditemsPager"),output:"{startRow} to {endRow} ({filteredRows})"}),$(".wanteditems-filter-reset").on("click",function(){$(this).prev("input").val("").focus(),$.tablesorter.storage($("#wanteditems"),"tablesorter-filters","")}),$("#lastdownloads").tablesorter({debug:!1,widgets:["reflow","filter","saveSort"],widgetOptions:{filter_columnFilters:!1,filter_external:".lastdownloads-filter",filter_searchDelay:50,filter_saveFilters:!0,filter_reset:".lastdownloads-filter-reset"},dateFormat:d.TABLESORTER_DATE_FORMAT,headers:{1:{sorter:"text"}},sortList:[[9,1]],initialized:function(){var e=$("#lastdownloads");e.find(".loading-row").remove(),e.find(".content-row").removeClass("hidden"),e.trigger("update")}}).tablesorterPager({container:$("#lastdownloadsPager"),output:"{startRow} to {endRow} ({filteredRows})"}),$(".lastdownloads-filter-reset").on("click",function(){$(this).prev("input").val("").focus(),$.tablesorter.storage($("#lastdownloads"),"tablesorter-filters","")}),$(".manualsearch-container-link").on("click",function(e){e.preventDefault();var t=$(this);if(t.data("running"))return!1;t.data("running",!0);var n=t.attr("href"),i=t.next("i"),a=t.parent("div").next("div");return i.removeClass("invisible").addClass("visible"),a.empty(),$.get(n,function(e){i.removeClass("visible").addClass("invisible"),a.append(e)}).always(function(){t.data("running",!1)}),!1}),$(".update-wanted-item-link").on("click",function(e){e.preventDefault();var t=$(this),n=t.attr("href"),i=t.closest(".panel-body"),a=t.closest(".wanted-item"),s={title:i.find("input.update-wanted-item-title").val(),year:i.find("input.update-wanted-item-year").val(),season:i.find("input.update-wanted-item-season").val(),episode:i.find("input.update-wanted-item-episode").val(),source:i.find("input.update-wanted-item-source").val(),quality:i.find("input.update-wanted-item-quality").val(),codec:i.find("input.update-wanted-item-codec").val(),releasegrp:i.find("input.update-wanted-item-releasegrp").val()};return $.post(n,s,function(e){jQuery.isEmptyObject(e)||(t.closest(".dropdown").find(".dropdown-toggle").dropdown("toggle"),a.find(".wanted-item-title").text(e.displaytitle),a.find(".wanted-item-season").text(e.season),a.find(".wanted-item-episode").text(e.episode),a.find(".wanted-item-source").text(e.source),a.find(".wanted-item-quality").text(e.quality),a.find(".wanted-item-codec").text(e.codec),a.find(".wanted-item-releasegrp").text(e.releasegrp))}),!1}),$(".reset-wanted-item-link").on("click",function(e){e.preventDefault();var t=$(this),n=t.attr("href"),i=t.closest(".panel-body"),a=t.closest(".wanted-item");return $.get(n,function(e){jQuery.isEmptyObject(e)||(t.closest(".dropdown").find(".dropdown-toggle").dropdown("toggle"),i.find("input.update-wanted-item-title").val(e.title),i.find("input.update-wanted-item-year").val(e.year),i.find("input.update-wanted-item-season").val(e.season),i.find("input.update-wanted-item-episode").val(e.episode),i.find("input.update-wanted-item-source").val(e.source),i.find("input.update-wanted-item-quality").val(e.quality),i.find("input.update-wanted-item-codec").val(e.codec),i.find("input.update-wanted-item-releasegrp").val(e.releasegrp),a.find(".wanted-item-title").text(e.displaytitle),a.find(".wanted-item-season").text(e.season),a.find(".wanted-item-episode").text(e.episode),a.find(".wanted-item-source").text(e.source),a.find(".wanted-item-quality").text(e.quality),a.find(".wanted-item-codec").text(e.codec),a.find(".wanted-item-releasegrp").text(e.releasegrp))}),!1})},openSettingsModal:function(e,t,n,i){e.preventDefault();var a=this,s="";t==d.EPISODE_TYPE?s=d.getUrl("/api/shows/"+n+"/settings"):t==d.MOVIE_TYPE&&(s=d.getUrl("/api/movies/"+n+"/settings")),$.get(s,function(e){a.type=t,a.indexerId=n,a.title=i,a.settings=e}),$("#settingsModal").modal("show")}}})})}(autosubliminal);