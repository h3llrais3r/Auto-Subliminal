"use strict";!function(s){PubSub.subscribe(s.settings.LOADED,function(){s.library.checkScannerRunning(),PubSub.subscribe(s.websockets.PROCESS_STARTED,s.library.scannerStartedEventSubscriber),PubSub.subscribe(s.websockets.PROCESS_FINISHED,s.library.scannerFinishedEventSubscriber),window.Vue.component("library-show-details",{data:function(){return{show:null,tvdbUrl:s.TVDB_URL,posterFullSizeUrl:s.getUrl("/artwork/tvdb/poster/fullsize/"),posterThumbnailUrl:s.getUrl("/artwork/tvdb/poster/thumbnail/"),languages:s.LANGUAGES,showSettings:null,showSettingsWantedLanguages:[],selectedEpisodeTvdbId:null,selectedFileLocation:null,selectedFileName:null,selectedHardcodedLanguages:[]}},created:function(){},mounted:function(){this.getShowDetails()},updated:function(){s.keepDropdownsOpen(),s.vue.styleProgressBar(this.showProgressPercentage)},computed:{showProgressPercentage:function(){return this.show.total_subtitles_available/this.show.total_subtitles_wanted*100},showProgressText:function(){return"".concat(this.show.total_subtitles_available," of ").concat(this.show.total_subtitles_wanted)}},methods:{getShowDetails:function(){var t=this,n=window.location.href.substr(window.location.href.lastIndexOf("/")+1);$(".loading").removeClass("hidden"),$.get(s.getUrl("/api/shows/".concat(n)),function(e){t.show=e,t.showSettings=t.show.settings}).fail(function(e){404==e.status&&$.deleteJson(s.getUrl("/api/shows/".concat(n)),null,function(){var e=s.types.Notification();e.message="Show does not exist anymore and has been removed from the library!",e.type=s.notifications.WARNING,e.sticky=!1,s.notifications.showNotification(e),window.location=s.getUrl("/library/shows")})}).always(function(){$(".loading").addClass("hidden")})},setPosterPlaceholderUrl:s.vue.setPosterPlaceholderUrl,getPlayVideoUrl:s.constructPlayVideoUrl,getLanguages:s.convertToLanguages,getLanguageCodes:s.convertToLanguageCodes,internalLanguagesAvailable:function(e){var t=!1;return(e.hardcoded_languages&&0<e.hardcoded_languages.length||e.embedded_languages&&0<e.embedded_languages.length)&&(t=!0),t},refreshShowDetails:function(e){e.preventDefault();var t=this;$(".refresh-running").removeClass("hidden"),$.putJson(s.getUrl("/api/shows/".concat(t.show.tvdb_id,"/refresh")),null,function(){t.getShowDetails(),$(".refresh-running").addClass("hidden")})},openSettingsModal:function(e){e.preventDefault();var t=this;t.showSettings=t.show.settings,t.showSettingsWantedLanguages=t.getLanguages(t.show.settings.wanted_languages),$("#settingsModal").modal("show")},openDeleteModal:function(e){e.preventDefault(),$("#deleteModal").modal("show")},openSubtitlesModal:function(e,t,n,s,a){a.preventDefault();var o=this;o.selectedEpisodeTvdbId=s,o.selectedFileLocation=e,o.selectedFileName=t,o.selectedHardcodedLanguages=o.getLanguages(n),$("#subtitlesModal").modal("show")},saveSettings:function(e){e.preventDefault();var t=this,n=t.showSettings;n.wanted_languages=t.getLanguageCodes(t.showSettingsWantedLanguages),$.putJson(s.getUrl("/api/shows/".concat(t.show.tvdb_id,"/settings")),n,function(){$("#settingsModal").modal("hide"),t.refreshShowDetails(e)})},deleteShow:function(e){e.preventDefault(),$.deleteJson(s.getUrl("/api/shows/".concat(this.show.tvdb_id)),null,function(){$("#deleteModal").modal("hide"),window.location=s.getUrl("/library/shows")})},saveHardcodedSubtitles:function(e){e.preventDefault();var t=this,n={file_location:t.selectedFileLocation,file_name:t.selectedFileName,languages:t.getLanguageCodes(t.selectedHardcodedLanguages)};$.putJson(s.getUrl("/api/shows/".concat(t.show.tvdb_id,"/subtitles/hardcoded/").concat(t.selectedEpisodeTvdbId)),n,function(){$("#subtitlesModal").modal("hide"),t.getShowDetails()})},addShowPathToVideoPaths:function(e){e.preventDefault();var t=this,n={videoPath:t.show.path};$.putJson(s.getUrl("/api/settings/general/videoPaths"),n,function(){t.getShowDetails()})},getNrOfSubtitles:function(e,t){var n=0;return e.forEach(function(e){"subtitle"==e.type&&null!=e.language&&e.language==t?n++:"video"==e.type&&(null!=e.hardcoded_languages&&e.hardcoded_languages.forEach(function(e){e==t&&n++}),null!=e.embedded_languages&&e.embedded_languages.forEach(function(e){e==t&&n++}))}),n},getNrOfVideos:function(e){var t=0;return e.forEach(function(e){"video"==e.type&&t++}),t}}}),window.Vue.component("multiselect",window.VueMultiselect.default),new window.Vue({el:"#app"})})}(autosubliminal);