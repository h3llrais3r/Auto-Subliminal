"use strict";var autosubliminal={types:{},settings:{},notifications:{},websockets:{},vue:{},library:{}};!function(i){i.WEB_ROOT=webRoot,i.BASE_URL="".concat(window.location.protocol,"//").concat(window.location.host).concat(i.WEB_ROOT),i.DEVELOPER_MODE=!1,i.SCAN_DISK="DiskScanner",i.SCAN_LIBRARY="LibraryScanner",i.CHECK_SUB="SubChecker",i.CHECK_VERSION="VersionChecker",i.TVDB_URL="http://thetvdb.com/?tab=series&id=",i.IMDB_URL="http://www.imdb.com/title/",i.TIMESTAMP_FORMAT="%Y-%m-%d %H:%M:%S",i.DATE_FORMAT=i.TIMESTAMP_FORMAT.split(" ")[0],i.TIME_FORMAT=i.TIMESTAMP_FORMAT.split(" ")[1],i.TABLESORTER_DATE_FORMAT="yyyymmdd",i.PATH_SEPARTOR="/",i.LANGUAGES=[],i.EPISODE_TYPE="episode",i.MOVIE_TYPE="movie",i.getUrl=function(t){return"".concat(i.BASE_URL).concat(t)},i.constructPlayVideoUrl=function(t,e){return"playvideo://".concat(t).concat(i.PATH_SEPARTOR).concat(e)},i.convertToLanguages=function(t){var n=[];return t.forEach(function(e){i.LANGUAGES.forEach(function(t){t.code==e&&n.push(t)})}),n},i.convertToLanguageCodes=function(t){var e=[];return t.forEach(function(t){e.push(t.code)}),e},i.enableScrollToBottom=function(){var t=$(".scroll-icon-bottom");t.removeClass("hidden"),$(window).scroll(function(){$(window).scrollTop()<$(document).height()-$(window).height()?t.fadeIn():t.fadeOut()}),t.click(function(t){return t.preventDefault(),$("html, body").animate({scrollTop:$(document).height()},"slow"),!1})},i.enableScrollToTop=function(){var t=$(".scroll-icon-top");t.removeClass("hidden"),$(window).scroll(function(){100<$(window).scrollTop()?t.fadeIn():t.fadeOut()}),t.click(function(t){return t.preventDefault(),$("html, body").animate({scrollTop:0},"slow"),!1})},i.types.DiskUsage={freeBytes:null,freePercentage:null,freeSpace:null,name:null,path:null,totalBytes:null,totalSpace:null},i.types.Settings={developerMode:null,webRoot:null,scanDisk:null,scanLibrary:null,checkSub:null,checkVersion:null,tvdbUrl:null,imdbUrl:null,timestampFormat:null,pathSeparator:null,languages:[]},i.types.Notification={message:null,type:null,sticky:null},i.types.WebsocketNotification={type:i.websockets.NOTIFICATION,notification:i.types.Notification},i.types.WebsocketPageReloadEvent={type:i.websockets.EVENT,event:{type:i.websockets.PAGE_RELOAD,data:{name:null}}},i.types.WebsocketProcessStartedEvent={type:i.websockets.EVENT,event:{type:i.websockets.PROCESS_STARTED,data:i.types.Process}},i.types.WebsocketProcessFinishedEvent={type:i.websockets.EVENT,event:{type:i.websockets.PROCESS_FINISHED,data:i.types.Process}},i.types.Process={name:null,interval:null,active:null,alive:null,lastRun:null,nextRun:null,running:null},i.types.ShowSettings={hearingImpaired:null,refine:null,utf8Encoding:null,wantedLanguages:null},i.types.ShowFiles=[{seasonFiles:{embeddedLanguages:[],filename:null,hardcodedLanguages:[],tvdbId:null,type:null},seasonName:null,seasonPath:null}],i.types.Show={path:null,tvdbId:null,title:null,year:null,overview:null,poster:null,banner:null,settings:i.types.ShowSettings,pathInVideoPaths:null,totalSubtitlesWanted:null,totalSubtitlesMissing:null,totalSubtitlesAvailable:null,files:i.types.ShowFiles},i.types.MovieSettings={hearingImpaired:null,refine:null,utf8Encoding:null,wantedLanguages:[]},i.types.MovieFiles=[{embeddedLanguages:[],filename:null,hardcodedLanguages:[],language:null,type:null}],i.types.Movie={path:null,imdbId:null,title:null,year:null,overview:null,poster:null,settings:i.types.MovieSettings,pathInVideoPaths:null,totalSubtitlesWanted:null,totalSubtitlesMissing:null,totalSubtitlesAvailable:null,files:i.types.MovieFiles},i.types.SubtitleLanguage={code:null,name:null},i.settings.LOADED="SETTINGS_LOADED",i.settings.loadSettings=function(){$.get(i.getUrl("/api/settings/frontend"),function(t){if(!jQuery.isEmptyObject(t)){i.DEVELOPER_MODE=t.developerMode,i.SCAN_DISK=t.scanDisk,i.SCAN_LIBRARY=t.scanLibrary,i.CHECK_SUB=t.checkSub,i.CHECK_VERSION=t.checkVersion,i.TVDB_URL=t.tvdbUrl,i.IMDB_URL=t.imdbUrl,i.TIMESTAMP_FORMAT=t.timestampFormat,i.DATE_FORMAT=i.TIMESTAMP_FORMAT.split(" ")[0],i.TIME_FORMAT=i.TIMESTAMP_FORMAT.split(" ")[1];var e=i.DATE_FORMAT.match(/[Ymd]+/g).join("");"Ymd"==e?i.TABLESORTER_DATE_FORMAT="yyyymmdd":"mdY"==e?i.TABLESORTER_DATE_FORMAT="mmddyyyy":"dmY"==e&&(i.TABLESORTER_DATE_FORMAT="ddmmyyyy"),i.PATH_SEPARTOR=t.pathSeparator,i.LANGUAGES=t.languages,PubSub.publish(i.settings.LOADED,null)}})},i.settings.loadSettings(),i.notifications.INFO="info",i.notifications.SUCCESS="success",i.notifications.WARNING="notice",i.notifications.ERROR="error",i.notifications.stackBottomRight=new PNotify.Stack({dir1:"up",dir2:"left",firstpos1:10,firstpos2:10,spacing1:10,spacing2:10}),i.notifications.stackContext=new PNotify.Stack({dir1:"down",dir2:"right",context:document.getElementById("stickyNotificationContext")}),PNotify.defaults.stack=i.notifications.stackBottomRight,PNotify.defaults.addClass="stack-bottomright",PNotify.defaults.styling="bootstrap3",PNotify.defaults.icons="bootstrap3",PNotify.defaults.delay=5e3,PNotify.defaultModules.set(PNotifyBootstrap3,{}),PNotify.defaultModules.set(PNotifyGlyphicon,{}),PNotify.defaultModules.set(PNotifyMobile,{}),PNotify.defaultModules.set(PNotifyDesktop,{}),PNotifyDesktop.permission(),i.notifications.stackContextModules=new Map(Array.from(PNotify.defaultModules)),i.notifications.stackContextModules.delete(PNotifyDesktop),i.notifications.showNotification=function(t){var e=t.message,n=t.type;t.sticky?PNotify.alert({title:!1,text:e,textTrusted:!0,type:n,hide:!1,width:"auto",addClass:"container stack-context",stack:i.notifications.stackContext,modules:i.notifications.stackContextModules}):PNotify.alert({title:"Auto-Subliminal",text:e,textTrusted:!0,type:n})},i.websockets.EVENT="EVENT",i.websockets.NOTIFICATION="NOTIFICATION",i.websockets.PAGE_RELOAD="PAGE_RELOAD",i.websockets.PROCESS_STARTED="PROCESS_STARTED",i.websockets.PROCESS_FINISHED="PROCESS_FINISHED",i.websockets.RUN_PROCESS="RUN_PROCESS",i.websockets.websocketProtocol="ws:","https:"===window.location.protocol&&(i.websockets.websocketProtocol="wss:");var t="".concat(i.websockets.websocketProtocol,"//").concat(window.location.host).concat(i.WEB_ROOT,"/system/websocket");i.websockets.ws=new WebSocket(t),i.websockets.ws.onmessage=function(t){var e=t.data;if(!jQuery.isEmptyObject(e)){var n=JSON.parse(e);i.websockets.handleWebsocketMessage(n)}},i.websockets.handleWebsocketMessage=function(t){t.type==i.websockets.NOTIFICATION?i.notifications.showNotification(t.notification):t.type==i.websockets.EVENT?i.websockets.handleWebsocketEvent(t.event):console.error("Unsupported message: ".concat(t))},i.websockets.handleWebsocketEvent=function(t){var e=t.type,n=t.data;if(e==i.websockets.PAGE_RELOAD)jQuery.isEmptyObject(n)?setTimeout(function(){window.location.reload()},1e3):0<=window.location.pathname.indexOf("/".concat(n.name))&&setTimeout(function(){window.location.reload()},1e3);else if(e==i.websockets.PROCESS_STARTED){if(!jQuery.isEmptyObject(n)){PubSub.publish(i.websockets.PROCESS_STARTED,n);var o=$("#scanDiskNextRun"),s=$("#checkSubNextRun");n.name==i.SCAN_DISK?(o.countdown("stop"),o.text("Running...")):n.name==i.CHECK_SUB&&(s.countdown("stop"),s.text("Running..."))}}else e==i.websockets.PROCESS_FINISHED?jQuery.isEmptyObject(n)||(PubSub.publish(i.websockets.PROCESS_FINISHED,n),n.name==i.SCAN_DISK?$("#scanDiskNextRun").countdown(n.nextRun):n.name==i.CHECK_SUB&&$("#checkSubNextRun").countdown(n.nextRun)):console.error("Unsupported event type: ".concat(e))},i.websockets.sendWebsocketMessage=function(t){i.websockets.ws.send(t)},i.websockets.runProcessOnServer=function(t){var e={type:i.websockets.EVENT,event:{type:i.websockets.RUN_PROCESS,data:{name:t}}};i.websockets.sendWebsocketMessage(JSON.stringify(e))},i.vue.formatDate=function(t){return strftime(i.DATE_FORMAT,new Date(t))},i.vue.formatTime=function(t){return strftime(i.TIME_FORMAT,new Date(t))},i.vue.formatDateTime=function(t){return strftime(i.TIMESTAMP_FORMAT,new Date(t))},i.vue.formatDuration=function(t){var e=Math.floor(t/86400),n=Math.floor(t%86400/3600),o=Math.floor(t%3600/60),s=Math.floor(t%60);return(0<e?e+(1==e?" day ":" days "):"")+(0<n?n+(1==n?" hour ":" hours "):"")+(0<o?o+(1==o?" minute ":" minutes "):"")+(0<s?s+(1==s?" second":" seconds"):"")},i.vue.getBannerPlaceholderUrl=function(){return i.getUrl("/images/banner-placeholder.jpg")},i.vue.getPosterPlaceholderUrl=function(){return i.getUrl("/images/poster-placeholder.jpg")},i.vue.getPosterLoadingUrl=function(){return i.getUrl("/images/poster-loading.jpg")},i.vue.styleProgressBar=function(o){$(".vue-simple-progress-bar").each(function(){var t=$(this),e=o;null==e&&(e=parseInt(t.css("width"))/parseInt(t.prev(".vue-simple-progress-text").css("width"))*100),e=Math.round(e);for(var n=100;0<e&&e<n;)n-=5;t.removeClass(function(t,e){return(e.match(/\bprogress-\S+/g)||[]).join(" ")}),t.addClass("progress-".concat(n))})},$(".navbar .nav a").on("click",function(){$(this).hasClass("run-process")||($(".navbar").find(".nav").find(".active").removeClass("active"),$(this).parent().addClass("active"))});var e="/".concat(location.pathname.replace(i.WEB_ROOT,"").split("/")[1],"/");$(".navbar").find(".nav").find('a[href="'.concat(e,'"]')).closest("li").addClass("active"),$(".navbar .nav a.run-process").on("click",function(t){t.preventDefault();var e=$(this).data("process-name");i.websockets.runProcessOnServer(e)}),$("input[type=checkbox][data-toggle=toggle][data-on=Enabled][data-off=Disabled]").on("change",function(){var t=$(this).parent().next("input[type=hidden]").val();t="False"==t?"True":"False",$(this).parent().next("input[type=hidden]").val(t)}),i.keepDropdownsOpen=function(){$(".dropdown .dropdown-menu.keep-open,.dropdown-menu.info-list").on("click",function(t){t.stopPropagation()})},i.keepDropdownsOpen(),i.enablePopovers=function(){$("[data-toggle=popover]").popover(),$(document).on("click",function(t){$('[data-toggle="popover"],[data-original-title]').each(function(){$(this).is(t.target)||0!==$(this).has(t.target).length||0!==$(".popover").has(t.target).length||((($(this).popover("hide").data("bs.popover")||{}).inState||{}).click=!1)})})},i.enablePopovers();var n=new Date;n.setTime($("#scanDiskNextRunTimeMs").val()),$("#scanDiskNextRun").countdown(n,function(t){"00:00:00"==t.strftime(i.TIME_FORMAT)?$(this).text("Running..."):$(this).text(t.strftime(i.TIME_FORMAT))});var o=new Date;o.setTime($("#checkSubNextRunTimeMs").val()),$("#checkSubNextRun").countdown(o,function(t){"00:00:00"==t.strftime(i.TIME_FORMAT)?$(this).text("Running..."):$(this).text(t.strftime(i.TIME_FORMAT))}),i.initMultiInputTextArea=function(t){$(t).hide();var e=$(t).val().split("\n");$(t).next("div.multi-input-fields").remove(),$(t).after('<div class="multi-input-fields"></div>');var n=$(t).next("div.multi-input-fields");e.forEach(function(t){$(n).append('<div class="input-group">\n                <input type="text" class="form-control input-sm" value="'.concat(t,'">\n                <span class="input-group-addon addon-remove"><i class="fa fa-times" aria-hidden="true"></i></span>\n                </div>'))}),$(n).append('<div class="input-group">\n            <input type="text" class="form-control input-sm" placeholder="New value">\n            <span class="input-group-addon addon-add"><i class="fa fa-plus" aria-hidden="true"></i></span>\n            </div>')},i.initMultiInputTextAreas=function(){$("textarea.multi-input").each(function(){i.initMultiInputTextArea(this)})},i.initMultiInputTextAreas(),$(document).on("click",".multi-input-fields .input-group .addon-add",function(){var t=$(this).parents(".multi-input-fields").siblings(".multi-input"),e=$(t).val().split("\n"),n=$(this).siblings("input").val(),o=e.filter(function(t){return t===n});if(n&&0===o.length){var s=e.concat([n]);$(t).val(s.join("\n")),i.initMultiInputTextArea(t)}else $(this).siblings("input").val("")}),$(document).on("click",".multi-input-fields .input-group .addon-remove",function(){var t=$(this).parents(".multi-input-fields").siblings(".multi-input"),e=t.val().split("\n"),n=$(this).siblings("input").val(),o=e.filter(function(t){return t!==n});t.val(o.join("\n")),i.initMultiInputTextArea(t)})}(autosubliminal),$.postJson=function(t,e,n,o){"string"!=typeof e&&(e=JSON.stringify(e)),$.ajax({url:t,type:"post",data:e,dataType:o||"json",contentType:"application/json; charset=utf-8",success:n})},$.putJson=function(t,e,n,o){"string"!=typeof e&&(e=JSON.stringify(e)),$.ajax({url:t,type:"put",data:e,dataType:o||"json",contentType:"application/json; charset=utf-8",success:n})},$.deleteJson=function(t,e,n,o){"string"!=typeof e&&(e=JSON.stringify(e)),$.ajax({url:t,type:"delete",data:e,dataType:o||"json",contentType:"application/json; charset=utf-8",success:n})};