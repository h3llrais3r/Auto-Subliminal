(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{Fycy:function(t,e,o){"use strict";o.r(e),o.d(e,"LogModule",(function(){return H}));var n=o("PCNd"),l=o("tyNb"),s=o("fXoL"),i=o("lJxs"),c=o("NMGg"),r=o("XJcI"),g=o("tk/3");let a=(()=>{class t extends r.a{constructor(t){super(t),this.httpClient=t,this.URL=c.b.webRoot+"/api/logs"}getLogs(t){return this.httpClient.get(t?`${this.URL}/${t}`:this.URL,this.options)}clearLogs(){return this.httpClient.delete(this.URL,this.options).pipe(Object(i.a)(()=>!0))}getLogCount(){return this.httpClient.get(this.URL+"/count",this.options).pipe(Object(i.a)(t=>t.count))}}return t.\u0275fac=function(e){return new(e||t)(s.Tb(g.a))},t.\u0275prov=s.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var b=o("acRR");let h=(()=>{class t{constructor(t,e,o){this.router=t,this.logService=e,this.messageService=o}ngOnInit(){this.logService.clearLogs().subscribe(t=>{t&&this.router.navigateByUrl("/log/view")},()=>this.messageService.showErrorMessage("Unable to clear the logs!"))}}return t.\u0275fac=function(e){return new(e||t)(s.Jb(l.b),s.Jb(a),s.Jb(b.a))},t.\u0275cmp=s.Db({type:t,selectors:[["app-log-clear"]],decls:0,vars:0,template:function(t,e){},styles:[""]}),t})();var u=o("lcII"),d=function(t){return t.DEBUG="DEBUG",t.INFO="INFO",t.WARNING="WARNING",t.ERROR="ERROR",t.CRITICAL="CRITICAL",t}({}),p=o("7CaW"),m=o("7zfz"),f=o("ofXK"),v=o("jIHw"),O=o("arFO"),L=o("3Pt+"),C=o("fqV1");const w=function(t){return{"d-none":t}};let y=(()=>{class t{constructor(){}ngOnInit(){this.scrollHeight=this.getScrollHeight(),this.maxScrollHeight=this.getMaxScrollHeight()}get scrollBottom(){return this.scrollHeight<this.maxScrollHeight}get scrollTop(){return this.scrollHeight>=100}onWindowScroll(){this.scrollHeight=this.getScrollHeight(),this.maxScrollHeight=this.getMaxScrollHeight()}scrollToTop(){this.scrollHeight>0&&(this.target?this.target.scrollIntoView({block:"start",inline:"nearest",behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"}))}scrollToBottom(){this.maxScrollHeight>0&&(this.target?this.target.scrollIntoView({block:"end",inline:"nearest",behavior:"smooth"}):window.scrollTo({top:this.maxScrollHeight,behavior:"smooth"}))}getScrollHeight(){return document.documentElement.scrollTop||document.body.scrollTop}getMaxScrollHeight(){return(document.documentElement.scrollHeight||document.body.scrollHeight)-(document.documentElement.offsetHeight||document.body.offsetHeight)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Db({type:t,selectors:[["app-scroll"]],hostBindings:function(t,e){1&t&&s.Wb("scroll",(function(){return e.onWindowScroll()}),!1,s.pc)},inputs:{target:"target"},decls:6,vars:12,consts:[[1,"scroll-icons","top"],["aria-hidden","true","title","Scroll to bottom",1,"fa","fa-arrow-circle-down","scroll-icon-bottom",3,"ngClass","click"],["aria-hidden","true","title","Scroll to top",1,"fa","fa-arrow-circle-up","scroll-icon-top",3,"ngClass","click"],[1,"scroll-icons","bottom"]],template:function(t,e){1&t&&(s.Pb(0,"span",0),s.Pb(1,"i",1),s.Wb("click",(function(){return e.scrollToBottom()})),s.Ob(),s.Pb(2,"i",2),s.Wb("click",(function(){return e.scrollToTop()})),s.Ob(),s.Ob(),s.Pb(3,"span",3),s.Pb(4,"i",1),s.Wb("click",(function(){return e.scrollToBottom()})),s.Ob(),s.Pb(5,"i",2),s.Wb("click",(function(){return e.scrollToTop()})),s.Ob(),s.Ob()),2&t&&(s.yb(1),s.dc("ngClass",s.gc(4,w,!e.scrollBottom)),s.yb(1),s.dc("ngClass",s.gc(6,w,!e.scrollTop)),s.yb(2),s.dc("ngClass",s.gc(8,w,!e.scrollBottom)),s.yb(1),s.dc("ngClass",s.gc(10,w,!e.scrollTop)))},directives:[f.h],styles:[".scroll-icons[_ngcontent-%COMP%]{position:fixed;right:.25rem;font-size:1.5rem}.scroll-icons.top[_ngcontent-%COMP%]{top:4.375rem}.scroll-icons.bottom[_ngcontent-%COMP%]{bottom:1.5rem}@media screen and (max-width:767px){.scroll-icons.bottom[_ngcontent-%COMP%]{bottom:2.5rem}}.scroll-icon-bottom[_ngcontent-%COMP%], .scroll-icon-top[_ngcontent-%COMP%]{overflow:hidden;z-index:999;cursor:pointer;background-color:var(--surface-d);color:var(--text-color);font-size:1.5rem;border-radius:.5rem;padding:.25rem}.scroll-icon-bottom[_ngcontent-%COMP%]:hover, .scroll-icon-top[_ngcontent-%COMP%]:hover{background-color:var(--text-color);color:var(--surface-d)}"]}),t})();const P=function(t){return{"p-badge-secondary":t}};function M(t,e){if(1&t){const t=s.Qb();s.Pb(0,"span",12),s.Wb("click",(function(){s.qc(t);const o=e.$implicit;return s.Yb().getLogs(o)})),s.yc(1),s.Ob()}if(2&t){const t=e.$implicit,o=s.Yb();s.dc("ngClass",s.gc(2,P,o.selectedLogNum!==t)),s.yb(1),s.zc(t)}}const S=function(t){return{"p-tag-secondary":t}},k=[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:(()=>{class t{constructor(t,e){this.logService=t,this.messageService=e,this.LOG_MESSAGE_REGEX=/^((?<date>\d{4}\-\d{2}\-\d{2})\s(?<time>\d{2}:\d{2}:\d{2},\d{3})\s(?<loglevel>\w+))/,this.selectedLogNum=0,this.selectedLoglevel="",this.loading=!1,this.tailing=!1,this.tailingDisabled=!1,this.tailButtonLabel="Start tailing",this.tailButtonIcon="pi pi-play",this.logMessages=[]}ngOnInit(){this.loglevels=this.getLogLevels(),this.logService.getLogCount().subscribe(t=>this.logNums=Array.from(Array(t).keys()).map(t=>t+1)),this.getLogs(0)}getLogs(t){this.loading=!0,this.selectedLogNum=t,this.tailingDisabled=0!==this.selectedLogNum,this.logService.getLogs(t).subscribe(t=>{this.logMessages=t,this.loading=!1,this.handleLogTailing()},()=>this.messageService.showErrorMessage("Unable to get the logs!"))}toggleTailing(){this.tailing=!this.tailing,this.tailing?(this.tailButtonLabel="Stop tailing",this.tailButtonIcon="pi pi-pause"):(this.tailButtonLabel="Start tailing",this.tailButtonIcon="pi pi-play"),this.handleLogTailing()}get filteredLogMessages(){return this.logMessages.filter(t=>{if(this.selectedLoglevel){const e=this.LOG_MESSAGE_REGEX.exec(t);return e&&e.groups.loglevel===this.selectedLoglevel}return!0})}get logContent(){return this.filteredLogMessages.join("\n")}getLogLevels(){const t=[];return t.push({label:"ALL",value:""}),Object.entries(d).forEach(e=>t.push({label:e[0],value:e[1]})),t}createLogWebSocket(){let t="ws:";"https:"===window.location.protocol&&(t="wss:");const e={url:`${t}//${window.location.host}${c.b.webRoot}/websocket/log`,deserializer:t=>t.data,serializer:t=>t};return Object(u.a)(e)}handleLogTailing(){this.tailing&&!this.tailingDisabled?(this.logWebsocket=this.createLogWebSocket(),this.logWebsocket.subscribe(t=>{this.logMessages.push(t)}),console.log("Log tailing enabled")):(this.logWebsocket&&this.logWebsocket.unsubscribe(),console.log("Log tailing disabled"))}}return t.\u0275fac=function(e){return new(e||t)(s.Jb(a),s.Jb(b.a))},t.\u0275cmp=s.Db({type:t,selectors:[["app-log-view"]],decls:18,vars:11,consts:[[1,"container-lg"],[1,"w-100"],[1,"p-panel-title"],[1,"log-num"],[1,"p-tag","p-tag-rounded",3,"ngClass","click"],["class","p-badge",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"log-tail"],["styleClass","p-button-outlined",3,"label","icon","disabled","onClick"],[1,"log-level"],["styleClass","p-dropdown-ar","scrollHeight","300px",3,"options","ngModel","ngModelChange"],[1,"log-content"],[3,"visible"],[1,"p-badge",3,"ngClass","click"]],template:function(t,e){1&t&&(s.Pb(0,"div",0),s.Pb(1,"p-panel"),s.Pb(2,"p-header",1),s.Pb(3,"div",2),s.yc(4,"Logfile"),s.Ob(),s.Pb(5,"div"),s.Pb(6,"span",3),s.Pb(7,"span",4),s.Wb("click",(function(){return e.getLogs(0)})),s.yc(8,"current"),s.Ob(),s.wc(9,M,2,4,"span",5),s.Ob(),s.Pb(10,"span",6),s.Pb(11,"p-button",7),s.Wb("onClick",(function(){return e.toggleTailing()})),s.Ob(),s.Ob(),s.Pb(12,"span",8),s.Pb(13,"p-dropdown",9),s.Wb("ngModelChange",(function(t){return e.selectedLoglevel=t})),s.Ob(),s.Ob(),s.Ob(),s.Ob(),s.Pb(14,"pre",10),s.yc(15),s.Ob(),s.Ob(),s.Ob(),s.Kb(16,"app-loading",11),s.Kb(17,"app-scroll")),2&t&&(s.yb(7),s.dc("ngClass",s.gc(9,S,0!==e.selectedLogNum)),s.yb(2),s.dc("ngForOf",e.logNums),s.yb(2),s.dc("label",e.tailButtonLabel)("icon",e.tailButtonIcon)("disabled",e.tailingDisabled),s.yb(2),s.dc("options",e.loglevels)("ngModel",e.selectedLoglevel),s.yb(2),s.zc(e.logContent),s.yb(1),s.dc("visible",e.loading))},directives:[p.a,m.c,f.h,f.i,v.a,O.a,L.j,L.l,C.a,y],styles:[".log-num[_ngcontent-%COMP%]   .p-badge[_ngcontent-%COMP%], .log-num[_ngcontent-%COMP%]   .p-tag[_ngcontent-%COMP%]{margin-right:.5rem;cursor:pointer}.log-num[_ngcontent-%COMP%]   .p-badge[_ngcontent-%COMP%]:hover, .log-num[_ngcontent-%COMP%]   .p-tag[_ngcontent-%COMP%]:hover{-moz-filter:brightness(125%);-o-filter:brightness(125%);filter:brightness(125%)}.log-tail[_ngcontent-%COMP%]{margin-right:.5rem}.log-content[_ngcontent-%COMP%]{overflow:auto;color:var(--text-color)}"]}),t})()},{path:"clear",component:h},{path:"**",redirectTo:"view"}];let T=(()=>{class t{}return t.\u0275mod=s.Hb({type:t}),t.\u0275inj=s.Gb({factory:function(e){return new(e||t)},imports:[[l.e.forChild(k)],l.e]}),t})(),H=(()=>{class t{}return t.\u0275mod=s.Hb({type:t}),t.\u0275inj=s.Gb({factory:function(e){return new(e||t)},imports:[[n.a,T]]}),t})()}}]);