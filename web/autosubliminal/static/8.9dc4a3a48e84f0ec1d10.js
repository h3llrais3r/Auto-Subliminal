(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{kse6:function(e,t,i){"use strict";i.r(t),i.d(t,"LibraryModule",(function(){return He}));var a=i("PCNd"),s=i("tyNb"),o=i("eZR5"),n=i("Zpym"),r=i("fXoL"),b=i("jhN1"),l=i("BO83"),c=i("VdJK"),d=i("kd3m"),g=i("acRR"),h=i("7zfz"),u=i("7CaW"),p=i("NMGg"),v=i("+613"),f=i("hlSE"),m=i("ZjcB");let w=(()=>{class e{constructor(e,t){this.systemService=e,this.systemEventService=t,this.scanningInProgress=!1}ngOnInit(){this.systemService.getScheduler(p.b.scanLibrary).subscribe(e=>{this.scanningInProgress=e.running}),this.systemEventService.schedulerStart.subscribe(e=>{this.scanningInProgress=e.name===p.b.scanLibrary||this.scanningInProgress}),this.systemEventService.schedulerFinish.subscribe(e=>{this.scanningInProgress=e.name!==p.b.scanLibrary&&this.scanningInProgress})}}return e.\u0275fac=function(t){return new(t||e)(r.Jb(v.a),r.Jb(f.a))},e.\u0275cmp=r.Db({type:e,selectors:[["app-library-scanning"]],decls:4,vars:1,consts:[[3,"visible"],["aria-hidden","true",1,"pi","pi-spin","pi-spinner","mr-2"]],template:function(e,t){1&e&&(r.Pb(0,"app-message",0),r.Kb(1,"i",1),r.Pb(2,"span"),r.yc(3,"Scanning library..."),r.Ob(),r.Ob()),2&e&&r.dc("visible",t.scanningInProgress)},directives:[m.a],styles:[""]}),e})();var y=i("ofXK"),P=i("Nf9I"),O=i("wf0l");let S=(()=>{class e{constructor(){this.value=0,this.total=100,this.showPercentage=!1}ngOnInit(){}get percentage(){return Math.round(this.value/this.total*100)}getText(){return this.showPercentage?this.percentage+"%":`${this.value} of ${this.total}`}getStyleClass(){return"progress-"+5*Math.floor(this.percentage/5)}getWidth(){return this.percentage+"%"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Db({type:e,selectors:[["app-progress-bar"]],inputs:{value:"value",total:"total",showPercentage:"showPercentage"},decls:4,vars:5,consts:[[1,"progress-bar-container"],[1,"progress-bar-text"],[1,"progress-bar-progress"]],template:function(e,t){1&e&&(r.Pb(0,"div",0),r.Pb(1,"div",1),r.yc(2),r.Ob(),r.Kb(3,"div",2),r.Ob()),2&e&&(r.yb(2),r.zc(t.getText()),r.yb(1),r.Ab(t.getStyleClass()),r.vc("width",t.getWidth()))},styles:[".progress-bar-container[_ngcontent-%COMP%]{position:relative;width:100%;background-color:#f4f4f4;border:1px solid var(--surface-d);border-radius:.25rem;color:#fff}.progress-bar-container[_ngcontent-%COMP%]   .progress-bar-text[_ngcontent-%COMP%]{position:absolute;left:0;right:0;color:#000;text-align:center;font-size:.875rem;margin:.0625rem}.progress-bar-container[_ngcontent-%COMP%]   .progress-bar-progress[_ngcontent-%COMP%]{min-width:15%;min-height:1.5rem;white-space:nowrap;overflow:hidden;border-radius:.125rem 0 0 .125rem}.progress-0[_ngcontent-%COMP%]{background:linear-gradient(#640000,#c80200);background:-o-linear-gradient(#640000,#c80200)}.progress-5[_ngcontent-%COMP%]{background:linear-gradient(#c80200,#ff1c00);background:-o-linear-gradient(#c80200,#ff1c00)}.progress-10[_ngcontent-%COMP%]{background:linear-gradient(#ff1c00,#ff3500);background:-o-linear-gradient(#ff1c00,#ff3500)}.progress-15[_ngcontent-%COMP%]{background:linear-gradient(#ff3500,#ff4e00);background:-o-linear-gradient(#ff3500,#ff4e00)}.progress-20[_ngcontent-%COMP%]{background:linear-gradient(#ff4e00,#ff6700);background:-o-linear-gradient(#ff4e00,#ff6700)}.progress-25[_ngcontent-%COMP%]{background:linear-gradient(#ff6700,#ff8100);background:-o-linear-gradient(#ff6700,#ff8100)}.progress-30[_ngcontent-%COMP%]{background:linear-gradient(#ff8100,#ff9a00);background:-o-linear-gradient(#ff8100,#ff9a00)}.progress-35[_ngcontent-%COMP%]{background:linear-gradient(#ff9a00,#ffb300);background:-o-linear-gradient(#ff9a00,#ffb300)}.progress-40[_ngcontent-%COMP%]{background:linear-gradient(#ffb300,#fc0);background:-o-linear-gradient(#ffb300,#fc0)}.progress-45[_ngcontent-%COMP%]{background:linear-gradient(#fc0,#ffe600);background:-o-linear-gradient(#fc0,#ffe600)}.progress-50[_ngcontent-%COMP%]{background:linear-gradient(#ffe600,#ff0);background:-o-linear-gradient(#ffe600,#ff0)}.progress-55[_ngcontent-%COMP%]{background:linear-gradient(#ff0,#e6ff00);background:-o-linear-gradient(#ff0,#e6ff00)}.progress-60[_ngcontent-%COMP%]{background:linear-gradient(#e6ff00,#cf0);background:-o-linear-gradient(#e6ff00,#cf0)}.progress-65[_ngcontent-%COMP%]{background:linear-gradient(#cf0,#b3ff00);background:-o-linear-gradient(#cf0,#b3ff00)}.progress-70[_ngcontent-%COMP%]{background:linear-gradient(#b3ff00,#9aff00);background:-o-linear-gradient(#b3ff00,#9aff00)}.progress-75[_ngcontent-%COMP%]{background:linear-gradient(#9aff00,#81ff00);background:-o-linear-gradient(#9aff00,#81ff00)}.progress-80[_ngcontent-%COMP%]{background:linear-gradient(#81ff00,#67ff00);background:-o-linear-gradient(#81ff00,#67ff00)}.progress-85[_ngcontent-%COMP%]{background:linear-gradient(#67ff00,#4eff00);background:-o-linear-gradient(#67ff00,#4eff00)}.progress-90[_ngcontent-%COMP%]{background:linear-gradient(#4eff00,#35ff00);background:-o-linear-gradient(#4eff00,#35ff00)}.progress-95[_ngcontent-%COMP%]{background:linear-gradient(#35ff00,#1cff00);background:-o-linear-gradient(#35ff00,#1cff00)}.progress-100[_ngcontent-%COMP%]{background:linear-gradient(#02c800,#029600);background:-o-linear-gradient(#02c800,#029600)}"]}),e})();var I=i("rEr+"),k=i("M3oc"),C=i("hNjJ"),M=i("3Pt+"),K=i("/RsI"),L=i("0xr8"),F=i("jIHw");function z(e,t){if(1&e&&(r.Pb(0,"form",3),r.Pb(1,"div",4),r.Pb(2,"div",5),r.yc(3,"Select the embedded hardcoded subtitle languages for video file:"),r.Ob(),r.Pb(4,"div",6),r.yc(5),r.Ob(),r.Ob(),r.Pb(6,"div",4),r.Pb(7,"div",5),r.Kb(8,"app-input-multi-select",7),r.Ob(),r.Ob(),r.Ob()),2&e){const e=r.Yb();r.dc("formGroup",e.videoSubtitlesForm),r.yb(5),r.zc(e.videoSubtitles.fileName),r.yb(3),r.dc("options",e.languages)}}function Y(e,t){if(1&e){const e=r.Qb();r.Pb(0,"p-button",8),r.Wb("click",(function(){return r.qc(e),r.Yb().close()})),r.Ob(),r.Pb(1,"p-button",9),r.Wb("click",(function(){return r.qc(e),r.Yb().saveVideoSubtitles()})),r.Ob()}}let D=(()=>{class e{constructor(e){this.fb=e,this.visible=!1,this.visibleChange=new r.n,this.save=new r.n}ngOnInit(){this.languages=C.a.languageSelectItems(),this.buildForm()}buildForm(){this.videoSubtitlesForm=this.fb.group({fileLocation:[this.videoSubtitles.fileLocation,[]],fileName:[this.videoSubtitles.fileName,[]],languages:[this.videoSubtitles.languages||[],[]]})}close(){this.visibleChange.emit(!1)}saveVideoSubtitles(){const e=new o.a;e.fileLocation=C.a.getFormControlValue(this.videoSubtitlesForm,"fileLocation"),e.fileName=C.a.getFormControlValue(this.videoSubtitlesForm,"fileName"),e.languages=C.a.getFormControlValue(this.videoSubtitlesForm,"languages"),this.save.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Jb(M.c))},e.\u0275cmp=r.Db({type:e,selectors:[["app-library-video-subtitles"]],inputs:{visible:"visible",videoSubtitles:"videoSubtitles"},outputs:{visibleChange:"visibleChange",save:"save"},decls:3,vars:5,consts:[["header","Hardcoded/embedded video subtitles","styleClass","p-dialog-video-subtitles",3,"visible","modal","closable","resizable","visibleChange"],["class","form",3,"formGroup",4,"ngIf"],["pTemplate","footer"],[1,"form",3,"formGroup"],[1,"row","form-row"],[1,"col-12"],[1,"col-12","file"],["formControlName","languages","placeholder","Select languages",3,"options"],["icon","pi pi-times","label","Cancel","styleClass","p-button p-button-secondary",3,"click"],["icon","pi pi-check","label","Save","styleClass","p-button mr-0",3,"click"]],template:function(e,t){1&e&&(r.Pb(0,"p-dialog",0),r.Wb("visibleChange",(function(e){return t.visible=e})),r.wc(1,z,9,3,"form",1),r.wc(2,Y,2,0,"ng-template",2),r.Ob()),2&e&&(r.dc("visible",t.visible)("modal",!0)("closable",!1)("resizable",!1),r.yb(1),r.dc("ngIf",t.videoSubtitlesForm))},directives:[K.a,y.j,h.f,M.o,M.k,M.f,L.a,M.j,M.e,F.a],styles:[".p-dialog-video-subtitles{width:500px}.file[_ngcontent-%COMP%]{font-weight:500;font-style:italic}"]}),e})();function U(e,t){if(1&e){const e=r.Qb();r.Pb(0,"a",20),r.Wb("click",(function(){return r.qc(e),r.Yb(2).addMoviePathToVideoPaths()})),r.Kb(1,"i",38),r.Ob()}}function T(e,t){if(1&e&&(r.Pb(0,"span",39),r.yc(1),r.Ob()),2&e){const e=t.$implicit;r.yb(1),r.zc(e)}}function V(e,t){if(1&e){const e=r.Qb();r.Pb(0,"a",20),r.Wb("click",(function(){r.qc(e);const t=r.Yb().$implicit,i=r.Yb(2);return i.openVideoSubtitlesDialog(i.movie.path,t.filename,t.hardcodedLanguages)})),r.Kb(1,"i",43),r.Ob()}}function $(e,t){if(1&e&&(r.Pb(0,"a",44),r.Kb(1,"i",45),r.Ob()),2&e){const e=r.Yb().$implicit,t=r.Yb(2);r.dc("href",t.getPlayVideoUrl(t.movie.path,e.filename),r.sc)}}function _(e,t){if(1&e&&(r.Pb(0,"span",50),r.yc(1),r.Ob()),2&e){const e=t.$implicit;r.yb(1),r.zc(e)}}function x(e,t){if(1&e&&(r.Pb(0,"span",50),r.yc(1),r.Ob()),2&e){const e=t.$implicit;r.yb(1),r.zc(e)}}function J(e,t){1&e&&(r.Pb(0,"span",50),r.yc(1,"internal"),r.Ob())}function W(e,t){if(1&e&&(r.Pb(0,"td",46),r.wc(1,_,2,1,"span",47),r.wc(2,x,2,1,"span",47),r.wc(3,J,2,0,"span",48),r.Pb(4,"span",49),r.yc(5),r.Ob(),r.Ob()),2&e){const e=r.Yb().$implicit;r.yb(1),r.dc("ngForOf",e.hardcodedLanguages),r.yb(1),r.dc("ngForOf",e.embeddedLanguages),r.yb(1),r.dc("ngIf",e.internalLanguagesAvailable),r.yb(2),r.zc(e.type)}}function E(e,t){if(1&e&&(r.Pb(0,"span",50),r.yc(1),r.Ob()),2&e){const e=r.Yb(2).$implicit;r.yb(1),r.zc(e.language)}}function j(e,t){if(1&e&&(r.Pb(0,"td",46),r.wc(1,E,2,1,"span",48),r.Pb(2,"span",49),r.yc(3),r.Ob(),r.Ob()),2&e){const e=r.Yb().$implicit;r.yb(1),r.dc("ngIf",e.language),r.yb(2),r.zc(e.type)}}function A(e,t){if(1&e&&(r.Pb(0,"tr"),r.Pb(1,"td",40),r.Pb(2,"span"),r.yc(3),r.Ob(),r.Pb(4,"span",17),r.wc(5,V,2,0,"a",28),r.wc(6,$,2,1,"a",41),r.Ob(),r.Ob(),r.wc(7,W,6,4,"td",42),r.wc(8,j,4,2,"td",42),r.Ob()),2&e){const e=t.$implicit;r.yb(3),r.zc(e.filename),r.yb(2),r.dc("ngIf",e.isVideo),r.yb(1),r.dc("ngIf",e.isVideo),r.yb(1),r.dc("ngIf",e.isVideo),r.yb(1),r.dc("ngIf",e.isSubtitle)}}function N(e,t){if(1&e){const e=r.Qb();r.Pb(0,"div",8),r.Pb(1,"div",9),r.Pb(2,"div",10),r.Pb(3,"div",11),r.Pb(4,"a",12),r.Kb(5,"img",13),r.Ob(),r.Ob(),r.Pb(6,"div",14),r.Pb(7,"div",15),r.Pb(8,"div",16),r.Pb(9,"span"),r.yc(10),r.Ob(),r.Pb(11,"span",17),r.Pb(12,"a",18),r.Kb(13,"i",19),r.Ob(),r.Pb(14,"a",20),r.Wb("click",(function(){return r.qc(e),r.Yb().openSettingsDialog()})),r.Kb(15,"i",21),r.Ob(),r.Pb(16,"a",20),r.Wb("click",(function(){return r.qc(e),r.Yb().refreshMovieDetails()})),r.Kb(17,"i",22),r.Ob(),r.Pb(18,"a",20),r.Wb("click",(function(){return r.qc(e),r.Yb().openDeleteDialog()})),r.Kb(19,"i",23),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Pb(20,"div",15),r.Pb(21,"div",24),r.Kb(22,"hr"),r.Ob(),r.Ob(),r.Pb(23,"div",9),r.Pb(24,"div",24),r.yc(25),r.Ob(),r.Ob(),r.Pb(26,"div",25),r.Pb(27,"div",26),r.yc(28,"Location:"),r.Ob(),r.Pb(29,"div",27),r.yc(30),r.wc(31,U,2,0,"a",28),r.Ob(),r.Ob(),r.Pb(32,"div",25),r.Pb(33,"div",26),r.yc(34,"Wanted languages:"),r.Ob(),r.Pb(35,"div",29),r.wc(36,T,2,1,"span",30),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Pb(37,"div",9),r.Pb(38,"div",24),r.Kb(39,"hr"),r.Pb(40,"div",31),r.Pb(41,"span",32),r.yc(42,"Files"),r.Ob(),r.Pb(43,"span",33),r.Kb(44,"app-progress-bar",34),r.Ob(),r.Ob(),r.Kb(45,"hr"),r.Ob(),r.Ob(),r.Pb(46,"div",9),r.Pb(47,"div",35),r.Pb(48,"p-table",36),r.wc(49,A,9,5,"ng-template",37),r.Ob(),r.Ob(),r.Ob(),r.Ob()}if(2&e){const e=r.Yb();r.yb(4),r.dc("href",e.getMoviePosterFullSizeUrl(),r.sc),r.yb(1),r.dc("lazyLoad",e.getMoviePosterThumbnailUrl())("defaultImage",e.getPosterPlaceholderUrl()),r.yb(5),r.zc(e.movie.name),r.yb(2),r.dc("href",e.getImdbUrl(),r.sc),r.yb(13),r.zc(e.movie.overview),r.yb(5),r.Ac(" ",e.movie.path," "),r.yb(1),r.dc("ngIf",!e.movie.pathInVideoPaths),r.yb(5),r.dc("ngForOf",e.movie.settings.wantedLanguages),r.yb(8),r.dc("value",e.movie.totalSubtitlesAvailable)("total",e.movie.totalSubtitlesWanted),r.yb(4),r.dc("value",e.movie.files)("autoLayout",!0)}}function q(e,t){if(1&e){const e=r.Qb();r.Pb(0,"app-movie-settings",51),r.Wb("visibleChange",(function(t){return r.qc(e),r.Yb().showMovieSettings=t})),r.Ob()}if(2&e){const e=r.Yb();r.dc("visible",e.showMovieSettings)("imdbId",e.movie.imdbId)("title",e.movie.name)("movieSettings",e.movie.settings)}}function R(e,t){if(1&e){const e=r.Qb();r.Pb(0,"app-library-video-subtitles",52),r.Wb("visibleChange",(function(t){return r.qc(e),r.Yb().showVideoSubtitles=t}))("save",(function(t){return r.qc(e),r.Yb().saveHardcodedSubtitles(t)})),r.Ob()}if(2&e){const e=r.Yb();r.dc("visible",e.showVideoSubtitles)("videoSubtitles",e.videoSubtitles)}}let H=(()=>{class e{constructor(e,t,i,a,s,o,n,r){this.route=e,this.router=t,this.domSanitizer=i,this.movieService=a,this.artworkService=s,this.settingsService=o,this.messageService=n,this.confirmationService=r,this.loading=!1,this.refreshInProgress=!1,this.showMovieSettings=!1,this.showVideoSubtitles=!1}ngOnInit(){this.route.paramMap.subscribe(e=>{this.loading=!0;const t=e.get("imdbId");this.getMovieDetails(t)})}getMoviePosterFullSizeUrl(){return this.artworkService.getMoviePosterFullSizeUrl(this.movie.imdbId)}getMoviePosterThumbnailUrl(){return this.artworkService.getMoviePosterThumbnailUrl(this.movie.imdbId)}getPosterPlaceholderUrl(){return Object(n.e)()}getImdbUrl(){return Object(n.c)(this.movie.imdbId)}getPlayVideoUrl(e,t){return this.domSanitizer.bypassSecurityTrustResourceUrl(Object(n.d)(e,t))}openSettingsDialog(){this.showMovieSettings=!0}refreshMovieDetails(){this.refreshInProgress=!0,this.movieService.refreshMovieDetails(this.movie.imdbId).subscribe(()=>{this.getMovieDetails(this.movie.imdbId),this.refreshInProgress=!1},()=>this.messageService.showErrorMessage("Unable to refresh the movie details!"))}openDeleteDialog(){this.confirmationService.confirm({message:`Are you sure that you want to delete <b>${this.movie.name}</b>?`,accept:()=>{this.movieService.deleteMovie(this.movie.imdbId).subscribe(()=>{this.router.navigateByUrl("/library/movie")},()=>this.messageService.showErrorMessage(`Unable to delete the movie ${this.movie.name}!`))}})}addMoviePathToVideoPaths(){this.settingsService.updateGeneralSetting("videoPaths",{videoPath:this.movie.path}).subscribe(()=>{this.messageService.showSuccessMessage(`Path ${this.movie.path} added to the video paths.`),this.getMovieDetails(this.movie.imdbId)},e=>{e.status&&409===e.status?this.messageService.showInfoMessage(`Path ${this.movie.path} already added to the video paths.`):this.messageService.showErrorMessage(`Unable to add path ${this.movie.path} to the video paths!`)})}openVideoSubtitlesDialog(e,t,i){this.videoSubtitles=new o.a,this.videoSubtitles.fileLocation=e,this.videoSubtitles.fileName=t,this.videoSubtitles.languages=i,this.showVideoSubtitles=!0}closeVideoSubtitlesDialog(){this.showVideoSubtitles=!1,this.videoSubtitles=null}saveHardcodedSubtitles(e){this.movieService.saveMovieHardcodedSubtitles(this.movie.imdbId,e).subscribe(()=>{this.closeVideoSubtitlesDialog(),this.getMovieDetails(this.movie.imdbId)},()=>this.messageService.showErrorMessage("Unable to save the hardcoded subtitles!"))}getMovieDetails(e){this.movieService.getMovieDetails(e).subscribe(e=>{this.movie=e,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the movie details!"))}}return e.\u0275fac=function(t){return new(t||e)(r.Jb(s.a),r.Jb(s.b),r.Jb(b.b),r.Jb(l.a),r.Jb(c.a),r.Jb(d.a),r.Jb(g.a),r.Jb(h.a))},e.\u0275cmp=r.Db({type:e,selectors:[["app-library-movie-detail"]],decls:11,vars:4,consts:[[1,"container-lg"],["header","Movie details"],[3,"visible"],["aria-hidden","true",1,"pi","pi-spin","pi-spinner","mr-2"],["class","library-details-container",4,"ngIf"],["header","Confirmation","icon","pi pi-exclamation-triangle"],[3,"visible","imdbId","title","movieSettings","visibleChange",4,"ngIf"],[3,"visible","videoSubtitles","visibleChange","save",4,"ngIf"],[1,"library-details-container"],[1,"row","mb-3"],[1,"col-12","library-details-info-container"],[1,"library-details-info-poster"],["target","_blank",3,"href"],["title","Click to view full size",1,"library-details-info-poster-image",3,"lazyLoad","defaultImage"],[1,"library-details-info"],[1,"row"],[1,"col-12","library-details-info-title"],[1,"icon-group","ml-1"],["target","_blank",1,"icon-link",3,"href"],["aria-hidden","true","title","Click to visit Imdb",1,"fa","fa-imdb"],[1,"icon-link",3,"click"],["aria-hidden","true","title","Click to edit movie settings",1,"fa","fa-wrench"],["aria-hidden","true","title","Click to refresh movie details",1,"fa","fa-repeat"],["aria-hidden","true","title","Click to delete movie from the database",1,"fa","fa-trash"],[1,"col-12"],[1,"row","mb-2"],[1,"col-3"],[1,"col-9","wrap-text"],["class","icon-link",3,"click",4,"ngIf"],[1,"col-9"],["class","p-tag language mr-2",4,"ngFor","ngForOf"],[1,"library-details-files-summary"],[1,"summary-title"],[1,"summary-progress-bar","ml-auto"],[3,"value","total"],[1,"col-12","library-details-files"],["styleClass","p-datatable-sm",3,"value","autoLayout"],["pTemplate","body"],["aria-hidden","true","title","Click to add the movie path to the video paths to scan",1,"fa","fa-plus"],[1,"p-tag","language","mr-2"],[1,"wrap-text"],["class","icon-link",3,"href",4,"ngIf"],["class","text-right",4,"ngIf"],["aria-hidden","true","title","Click to save hardcoded subtitle languages",1,"fa","fa-wrench"],[1,"icon-link",3,"href"],["aria-hidden","true","title","Click to play video",1,"fa","fa-play-circle-o"],[1,"text-right"],["class","p-tag language ml-2",4,"ngFor","ngForOf"],["class","p-tag language ml-2",4,"ngIf"],[1,"p-tag","filetype","ml-2"],[1,"p-tag","language","ml-2"],[3,"visible","imdbId","title","movieSettings","visibleChange"],[3,"visible","videoSubtitles","visibleChange","save"]],template:function(e,t){1&e&&(r.Pb(0,"div",0),r.Pb(1,"p-panel",1),r.Kb(2,"app-library-scanning"),r.Pb(3,"app-message",2),r.Kb(4,"i",3),r.Pb(5,"span"),r.yc(6,"Refreshing movie details..."),r.Ob(),r.Ob(),r.wc(7,N,50,13,"div",4),r.Ob(),r.Ob(),r.Kb(8,"p-confirmDialog",5),r.wc(9,q,1,4,"app-movie-settings",6),r.wc(10,R,1,2,"app-library-video-subtitles",7)),2&e&&(r.yb(3),r.dc("visible",t.refreshInProgress),r.yb(4),r.dc("ngIf",t.movie),r.yb(2),r.dc("ngIf",t.showMovieSettings),r.yb(1),r.dc("ngIf",t.showVideoSubtitles))},directives:[u.a,w,m.a,y.j,P.a,O.a,y.i,S,I.c,h.f,k.a,D],styles:[""]}),e})();var Q=i("JvaJ"),B=i("noUC");function G(e,t){if(1&e&&(r.Pb(0,"div",9),r.Pb(1,"span",10),r.Kb(2,"p-button",11),r.Ob(),r.Pb(3,"span",12),r.Kb(4,"app-table-filter",13),r.Ob(),r.Ob()),2&e){const e=r.Yb(),t=r.oc(6);r.yb(2),r.dc("label",e.nrOfMovies+" movies"),r.yb(2),r.dc("table",t)("tableStateKey",e.tableStateKey)}}function Z(e,t){1&e&&(r.Pb(0,"tr"),r.Pb(1,"th",14),r.Pb(2,"span"),r.yc(3,"Title"),r.Kb(4,"p-sortIcon",15),r.Ob(),r.Ob(),r.Pb(5,"th",16),r.Pb(6,"span"),r.yc(7,"Year"),r.Kb(8,"p-sortIcon",17),r.Ob(),r.Ob(),r.Pb(9,"th",18),r.Pb(10,"span"),r.yc(11,"Path"),r.Kb(12,"p-sortIcon",19),r.Ob(),r.Ob(),r.Pb(13,"th",20),r.Pb(14,"span"),r.yc(15,"Wanted subtitles"),r.Kb(16,"p-sortIcon",21),r.Ob(),r.Ob(),r.Pb(17,"th",22),r.Pb(18,"span"),r.yc(19,"Subtitles"),r.Kb(20,"p-sortIcon",23),r.Ob(),r.Ob(),r.Ob())}function X(e,t){if(1&e&&r.Kb(0,"img",36),2&e){const e=r.Yb().$implicit,t=r.Yb();r.dc("lazyLoad",t.getMoviePosterThumbnailUrl(e.imdbId))("defaultImage",t.getPosterPlaceholderUrl())}}function ee(e,t){if(1&e&&(r.Pb(0,"span",37),r.yc(1),r.Ob()),2&e){const e=t.$implicit;r.yb(1),r.zc(e)}}const te=function(e){return["/library/movie/detail",e]};function ie(e,t){if(1&e&&(r.Pb(0,"tr"),r.Pb(1,"td"),r.Pb(2,"span",24),r.yc(3,"Title"),r.Ob(),r.Pb(4,"span",25),r.Pb(5,"span",26),r.Pb(6,"span",27),r.Pb(7,"a",28),r.wc(8,X,1,2,"img",29),r.Ob(),r.Ob(),r.Pb(9,"span",30),r.Pb(10,"a",31),r.yc(11),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Pb(12,"td"),r.Pb(13,"span",24),r.yc(14,"Year"),r.Ob(),r.Pb(15,"span",32),r.yc(16),r.Ob(),r.Ob(),r.Pb(17,"td"),r.Pb(18,"span",24),r.yc(19,"Path"),r.Ob(),r.Pb(20,"span",33),r.yc(21),r.Ob(),r.Ob(),r.Pb(22,"td"),r.Pb(23,"span",24),r.yc(24,"Wanted subtitles"),r.Ob(),r.Pb(25,"span",32),r.wc(26,ee,2,1,"span",34),r.Ob(),r.Ob(),r.Pb(27,"td"),r.Pb(28,"span",24),r.yc(29,"Subtitles"),r.Ob(),r.Pb(30,"span",32),r.Kb(31,"app-progress-bar",35),r.Ob(),r.Ob(),r.Ob()),2&e){const e=t.$implicit;r.yb(7),r.dc("routerLink",r.gc(10,te,e.imdbId))("title",e.title),r.yb(1),r.dc("ngIf",e.poster),r.yb(2),r.dc("routerLink",r.gc(12,te,e.imdbId)),r.yb(1),r.zc(e.title),r.yb(5),r.zc(e.year),r.yb(5),r.zc(e.path),r.yb(5),r.dc("ngForOf",e.settings.wantedLanguages),r.yb(5),r.dc("value",e.totalSubtitlesAvailable)("total",e.totalSubtitlesWanted)}}const ae=function(){return{showAll:"All"}},se=function(e){return[5,10,25,50,e]};let oe=(()=>{class e{constructor(e,t,i,a){this.systemEventService=e,this.movieService=t,this.artworkService=i,this.messageService=a,this.loading=!1,this.nrOfMovies=0,this.globalFilterFields=["title","year","path","settings.wantedLanguages","totalSubtitlesAvailable"],this.tableStateKey="autosubliminal-library-movie-overview-table"}ngOnInit(){this.loadOverview(),this.scanLibrarySubscription=this.systemEventService.schedulerFinish.subscribe(e=>{e.name===p.b.scanLibrary&&this.loadOverview()})}ngOnDestroy(){this.scanLibrarySubscription.unsubscribe()}loadOverview(){this.loading=!0,this.movieService.getMovies().subscribe(e=>{this.movies=e,this.nrOfMovies=this.movies.length,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the movies!"))}sort(e){Object(Q.a)(e)}getMoviePosterThumbnailUrl(e){return this.artworkService.getMoviePosterThumbnailUrl(e)}getPosterPlaceholderUrl(){return"assets/poster-placeholder.jpg"}}return e.\u0275fac=function(t){return new(t||e)(r.Jb(f.a),r.Jb(l.a),r.Jb(c.a),r.Jb(g.a))},e.\u0275cmp=r.Db({type:e,selectors:[["app-library-movie-overview"]],decls:10,vars:14,consts:[[1,"container-lg"],["header","Movie library"],[1,"row"],[1,"col-12","library-overview-container"],["stateStorage","local","currentPageReportTemplate","{first} to {last} of {totalRecords}","styleClass","p-datatable-sm p-datatable-gridlines p-datatable-striped p-datatable-responsive-mode",3,"value","stateKey","loading","autoLayout","rowHover","paginator","rows","rowsPerPageOptions","showCurrentPageReport","globalFilterFields","customSort","sortFunction"],["movieTable",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"caption"],[1,"w-100"],["styleClass","p-button-static p-button-outlined",3,"label"],[1,"ml-auto"],["matchMode","contains",3,"table","tableStateKey"],["pSortableColumn","title"],["field","title"],["pSortableColumn","year"],["field","year"],["pSortableColumn","path"],["field","path"],["pSortableColumn","settings.wantedLanguages"],["field","settings.wantedLanguages"],["pSortableColumn","totalSubtitlesAvailable"],["field","totalSubtitlesAvailable"],[1,"p-column-title"],[1,"p-column-data","title-container"],[1,"title-container-wrapper"],[1,"title-poster-container"],[3,"routerLink","title"],["class","title-poster-image",3,"lazyLoad","defaultImage",4,"ngIf"],[1,"title-text"],[3,"routerLink"],[1,"p-column-data"],[1,"p-column-data","wrap-text"],["class","p-tag p-tag-small p-tag-secondary mr-2",4,"ngFor","ngForOf"],[1,"w-100",3,"value","total"],[1,"title-poster-image",3,"lazyLoad","defaultImage"],[1,"p-tag","p-tag-small","p-tag-secondary","mr-2"]],template:function(e,t){1&e&&(r.Pb(0,"div",0),r.Pb(1,"p-panel",1),r.Kb(2,"app-library-scanning"),r.Pb(3,"div",2),r.Pb(4,"div",3),r.Pb(5,"p-table",4,5),r.Wb("sortFunction",(function(e){return t.sort(e)})),r.wc(7,G,5,3,"ng-template",6),r.wc(8,Z,21,0,"ng-template",7),r.wc(9,ie,32,14,"ng-template",8),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Ob()),2&e&&(r.yb(5),r.dc("value",t.movies)("stateKey",t.tableStateKey)("loading",t.loading)("autoLayout",!0)("rowHover",!0)("paginator",!0)("rows",10)("rowsPerPageOptions",r.gc(12,se,r.fc(11,ae)))("showCurrentPageReport",!0)("globalFilterFields",t.globalFilterFields)("customSort",!0))},directives:[u.a,w,I.c,h.f,F.a,B.a,I.b,I.a,s.d,y.j,y.i,S,O.a],styles:[""]}),e})();var ne=i("cp0P"),re=i("GPj8"),be=i("MC25");function le(e,t){if(1&e&&(r.Pb(0,"li"),r.Pb(1,"span"),r.yc(2),r.Ob(),r.Ob()),2&e){const e=t.$implicit;r.yb(2),r.zc(e)}}function ce(e,t){if(1&e&&(r.Pb(0,"app-icon-dropdown",12),r.Pb(1,"li"),r.Pb(2,"span",13),r.yc(3,"List of failed shows:"),r.Ob(),r.Ob(),r.Kb(4,"hr"),r.wc(5,le,3,1,"li",14),r.Ob()),2&e){const e=r.Yb(2);r.yb(5),r.dc("ngForOf",e.showsOverview.failedShows)}}const de=function(){return["/library/show/overview"]};function ge(e,t){if(1&e&&(r.Pb(0,"div",5),r.Pb(1,"div",6),r.Pb(2,"div",7),r.Pb(3,"a",8),r.Kb(4,"img",9),r.Ob(),r.Ob(),r.Pb(5,"div",7),r.Pb(6,"span"),r.Pb(7,"span"),r.yc(8),r.Ob(),r.wc(9,ce,6,1,"app-icon-dropdown",10),r.Ob(),r.Pb(10,"span"),r.yc(11),r.Ob(),r.Ob(),r.Pb(12,"div",7),r.Pb(13,"span"),r.yc(14,"Total subtitles available:"),r.Ob(),r.Ob(),r.Pb(15,"div",7),r.Kb(16,"app-progress-bar",11),r.Ob(),r.Ob(),r.Ob()),2&e){const e=r.Yb();r.yb(3),r.dc("routerLink",r.fc(6,de)),r.yb(5),r.Ac("Total shows: ",e.showsOverview.totalShows,""),r.yb(1),r.dc("ngIf",e.showsOverview.failedShows.length>0),r.yb(2),r.Ac("Total episodes: ",e.showsOverview.totalEpisodes,""),r.yb(5),r.dc("value",e.showsOverview.totalSubtitlesAvailable)("total",e.showsOverview.totalSubtitlesWanted)}}function he(e,t){if(1&e&&(r.Pb(0,"li"),r.Pb(1,"span"),r.yc(2),r.Ob(),r.Ob()),2&e){const e=t.$implicit;r.yb(2),r.zc(e)}}function ue(e,t){if(1&e&&(r.Pb(0,"app-icon-dropdown",12),r.Pb(1,"li"),r.Pb(2,"span",13),r.yc(3,"List of failed movies:"),r.Ob(),r.Ob(),r.Kb(4,"hr"),r.wc(5,he,3,1,"li",14),r.Ob()),2&e){const e=r.Yb(2);r.yb(5),r.dc("ngForOf",e.moviesOverview.failedMovies)}}const pe=function(){return["/library/movie/overview"]};function ve(e,t){if(1&e&&(r.Pb(0,"div",15),r.Pb(1,"div",6),r.Pb(2,"div",7),r.Pb(3,"a",8),r.Kb(4,"img",16),r.Ob(),r.Ob(),r.Pb(5,"div",7),r.Pb(6,"span"),r.Pb(7,"span"),r.yc(8),r.Ob(),r.wc(9,ue,6,1,"app-icon-dropdown",10),r.Ob(),r.Ob(),r.Pb(10,"div",7),r.Pb(11,"span"),r.yc(12,"Total subtitles available:"),r.Ob(),r.Ob(),r.Pb(13,"div",7),r.Kb(14,"app-progress-bar",11),r.Ob(),r.Ob(),r.Ob()),2&e){const e=r.Yb();r.yb(3),r.dc("routerLink",r.fc(5,pe)),r.yb(5),r.Ac("Total movies: ",e.moviesOverview.totalMovies,""),r.yb(1),r.dc("ngIf",e.moviesOverview.failedMovies.length>0),r.yb(5),r.dc("value",e.moviesOverview.totalSubtitlesAvailable)("total",e.moviesOverview.totalSubtitlesWanted)}}let fe=(()=>{class e{constructor(e,t,i,a){this.systemEventService=e,this.showService=t,this.movieService=i,this.messageService=a,this.loading=!1}ngOnInit(){this.loadOverview(),this.scanLibrarySubscription=this.systemEventService.schedulerFinish.subscribe(e=>{e.name===p.b.scanLibrary&&this.loadOverview()})}ngOnDestroy(){this.scanLibrarySubscription.unsubscribe()}loadOverview(){this.loading=!0,Object(ne.a)([this.showService.getShowsOverview(),this.movieService.getMoviesOverview()]).subscribe(([e,t])=>{this.showsOverview=e,this.moviesOverview=t,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the library overview!"))}}return e.\u0275fac=function(t){return new(t||e)(r.Jb(f.a),r.Jb(re.a),r.Jb(l.a),r.Jb(g.a))},e.\u0275cmp=r.Db({type:e,selectors:[["app-library-overview"]],decls:6,vars:2,consts:[[1,"container-lg"],["header","Library overview"],[1,"row"],["class","col-12 col-sm-12 col-md-6 col-lg-6 mb-3 mb-sm-3 mb-md-0 mb-lg-0",4,"ngIf"],["class","col-12 col-sm-12 col-md-6 col-lg-6",4,"ngIf"],[1,"col-12","col-sm-12","col-md-6","col-lg-6","mb-3","mb-sm-3","mb-md-0","mb-lg-0"],[1,"overview-container"],[1,"overview-data"],[3,"routerLink"],["src","assets/shows.jpg","title","Click to view shows",1,"overview-image"],["iconClass","pi pi-fw pi-vm pi-exclamation-triangle text-danger",4,"ngIf"],[1,"w-100",3,"value","total"],["iconClass","pi pi-fw pi-vm pi-exclamation-triangle text-danger"],[1,"icon-dropdown-title"],[4,"ngFor","ngForOf"],[1,"col-12","col-sm-12","col-md-6","col-lg-6"],["src","assets/movies.jpg","title","Click to view movies",1,"overview-image","image-hover"]],template:function(e,t){1&e&&(r.Pb(0,"div",0),r.Pb(1,"p-panel",1),r.Kb(2,"app-library-scanning"),r.Pb(3,"div",2),r.wc(4,ge,17,7,"div",3),r.wc(5,ve,15,6,"div",4),r.Ob(),r.Ob(),r.Ob()),2&e&&(r.yb(4),r.dc("ngIf",t.showsOverview),r.yb(1),r.dc("ngIf",t.moviesOverview))},directives:[u.a,w,y.j,s.d,S,be.a,y.i],styles:[".image-box[_ngcontent-%COMP%], .overview-container[_ngcontent-%COMP%]   .overview-image[_ngcontent-%COMP%]{box-shadow:3px 3px 3px #000;-webkit-box-shadow:3px 3px 3px #000;-moz-box-shadow:3px 3px 3px #000;border:1px solid #000}.image-hover[_ngcontent-%COMP%]:hover, .overview-container[_ngcontent-%COMP%]   .overview-image[_ngcontent-%COMP%]:hover{-moz-filter:brightness(75%);-o-filter:brightness(75%);filter:brightness(75%)}.overview-container[_ngcontent-%COMP%]{border:1px solid var(--surface-d);border-radius:.25rem;padding:1rem}.overview-container[_ngcontent-%COMP%]   .overview-image[_ngcontent-%COMP%]{width:100%}.overview-container[_ngcontent-%COMP%]   .overview-data[_ngcontent-%COMP%]{display:flex;-moz-justify-content:space-between;-ms-justify-content:space-between;justify-content:space-between;-ms-flex-pack:space-between}.overview-container[_ngcontent-%COMP%]   .overview-data[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:.5rem}"]}),e})();var me=i("tlyu"),we=i("DRzA");function ye(e,t){if(1&e){const e=r.Qb();r.Pb(0,"a",20),r.Wb("click",(function(){return r.qc(e),r.Yb(2).addShowPathToVideoPaths()})),r.Kb(1,"i",36),r.Ob()}}function Pe(e,t){if(1&e&&(r.Pb(0,"span",37),r.yc(1),r.Ob()),2&e){const e=t.$implicit;r.yb(1),r.zc(e)}}function Oe(e,t){if(1&e&&r.Kb(0,"p-button",47),2&e){const e=t.$implicit,i=r.Yb(2).$implicit,a=r.Yb(2);r.dc("label",e)("badge",a.getNrOfSubtitles(i.files,e))}}function Se(e,t){if(1&e&&(r.Pb(0,"div",42),r.Pb(1,"div",43),r.Pb(2,"span"),r.yc(3),r.Ob(),r.Pb(4,"app-icon-dropdown"),r.Pb(5,"li"),r.yc(6),r.Ob(),r.Ob(),r.Ob(),r.Pb(7,"div",44),r.wc(8,Oe,1,2,"p-button",45),r.Kb(9,"p-button",46),r.Ob(),r.Ob()),2&e){const e=r.Yb().$implicit,t=r.Yb(2);r.yb(3),r.zc(e.seasonName),r.yb(3),r.zc(e.seasonPath),r.yb(2),r.dc("ngForOf",t.show.settings.wantedLanguages),r.yb(1),r.dc("badge",t.getNrOfVideos(e.files))}}function Ie(e,t){if(1&e){const e=r.Qb();r.Pb(0,"a",20),r.Wb("click",(function(){r.qc(e);const t=r.Yb().$implicit,i=r.Yb().$implicit;return r.Yb(2).openVideoSubtitlesDialog(i.seasonPath,t.filename,t.hardcodedLanguages,t.tvdbId)})),r.Kb(1,"i",51),r.Ob()}}function ke(e,t){if(1&e&&(r.Pb(0,"a",52),r.Kb(1,"i",53),r.Ob()),2&e){const e=r.Yb().$implicit,t=r.Yb().$implicit,i=r.Yb(2);r.dc("href",i.getPlayVideoUrl(t.seasonPath,e.filename),r.sc)}}function Ce(e,t){if(1&e&&(r.Pb(0,"span",58),r.yc(1),r.Ob()),2&e){const e=t.$implicit;r.yb(1),r.zc(e)}}function Me(e,t){if(1&e&&(r.Pb(0,"span",58),r.yc(1),r.Ob()),2&e){const e=t.$implicit;r.yb(1),r.zc(e)}}function Ke(e,t){1&e&&(r.Pb(0,"span",58),r.yc(1,"internal"),r.Ob())}function Le(e,t){if(1&e&&(r.Pb(0,"td",54),r.wc(1,Ce,2,1,"span",55),r.wc(2,Me,2,1,"span",55),r.wc(3,Ke,2,0,"span",56),r.Pb(4,"span",57),r.yc(5),r.Ob(),r.Ob()),2&e){const e=r.Yb().$implicit;r.yb(1),r.dc("ngForOf",e.hardcodedLanguages),r.yb(1),r.dc("ngForOf",e.embeddedLanguages),r.yb(1),r.dc("ngIf",e.internalLanguagesAvailable),r.yb(2),r.zc(e.type)}}function Fe(e,t){if(1&e&&(r.Pb(0,"span",58),r.yc(1),r.Ob()),2&e){const e=r.Yb(2).$implicit;r.yb(1),r.zc(e.language)}}function ze(e,t){if(1&e&&(r.Pb(0,"td",54),r.wc(1,Fe,2,1,"span",56),r.Pb(2,"span",57),r.yc(3),r.Ob(),r.Ob()),2&e){const e=r.Yb().$implicit;r.yb(1),r.dc("ngIf",e.language),r.yb(2),r.zc(e.type)}}function Ye(e,t){if(1&e&&(r.Pb(0,"tr"),r.Pb(1,"td",48),r.Pb(2,"span"),r.yc(3),r.Ob(),r.Pb(4,"span",17),r.wc(5,Ie,2,0,"a",28),r.wc(6,ke,2,1,"a",49),r.Ob(),r.Ob(),r.wc(7,Le,6,4,"td",50),r.wc(8,ze,4,2,"td",50),r.Ob()),2&e){const e=t.$implicit;r.yb(3),r.zc(e.filename),r.yb(2),r.dc("ngIf",e.isVideo),r.yb(1),r.dc("ngIf",e.isVideo),r.yb(1),r.dc("ngIf",e.isVideo),r.yb(1),r.dc("ngIf",e.isSubtitle)}}function De(e,t){if(1&e&&(r.Pb(0,"div",9),r.Pb(1,"div",38),r.Pb(2,"p-table",39),r.wc(3,Se,10,4,"ng-template",40),r.wc(4,Ye,9,5,"ng-template",41),r.Ob(),r.Ob(),r.Ob()),2&e){const e=t.$implicit;r.yb(2),r.dc("value",e.files)("autoLayout",!0)}}function Ue(e,t){if(1&e){const e=r.Qb();r.Pb(0,"div",8),r.Pb(1,"div",9),r.Pb(2,"div",10),r.Pb(3,"div",11),r.Pb(4,"a",12),r.Kb(5,"img",13),r.Ob(),r.Ob(),r.Pb(6,"div",14),r.Pb(7,"div",15),r.Pb(8,"div",16),r.Pb(9,"span"),r.yc(10),r.Ob(),r.Pb(11,"span",17),r.Pb(12,"a",18),r.Kb(13,"i",19),r.Ob(),r.Pb(14,"a",20),r.Wb("click",(function(){return r.qc(e),r.Yb().openSettingsDialog()})),r.Kb(15,"i",21),r.Ob(),r.Pb(16,"a",20),r.Wb("click",(function(){return r.qc(e),r.Yb().refreshShowDetails()})),r.Kb(17,"i",22),r.Ob(),r.Pb(18,"a",20),r.Wb("click",(function(){return r.qc(e),r.Yb().openDeleteDialog()})),r.Kb(19,"i",23),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Pb(20,"div",15),r.Pb(21,"div",24),r.Kb(22,"hr"),r.Ob(),r.Ob(),r.Pb(23,"div",9),r.Pb(24,"div",24),r.yc(25),r.Ob(),r.Ob(),r.Pb(26,"div",25),r.Pb(27,"div",26),r.yc(28,"Location:"),r.Ob(),r.Pb(29,"div",27),r.yc(30),r.wc(31,ye,2,0,"a",28),r.Ob(),r.Ob(),r.Pb(32,"div",25),r.Pb(33,"div",26),r.yc(34,"Wanted languages:"),r.Ob(),r.Pb(35,"div",29),r.wc(36,Pe,2,1,"span",30),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Pb(37,"div",9),r.Pb(38,"div",24),r.Kb(39,"hr"),r.Pb(40,"div",31),r.Pb(41,"span",32),r.yc(42,"Files"),r.Ob(),r.Pb(43,"span",33),r.Kb(44,"app-progress-bar",34),r.Ob(),r.Ob(),r.Kb(45,"hr"),r.Ob(),r.Ob(),r.wc(46,De,5,2,"div",35),r.Ob()}if(2&e){const e=r.Yb();r.yb(4),r.dc("href",e.getShowPosterFullSizeUrl(),r.sc),r.yb(1),r.dc("lazyLoad",e.getShowPosterThumbnailUrl())("defaultImage",e.getPosterPlaceholderUrl()),r.yb(5),r.zc(e.show.name),r.yb(2),r.dc("href",e.getTvdbUrl(),r.sc),r.yb(13),r.zc(e.show.overview),r.yb(5),r.Ac(" ",e.show.path," "),r.yb(1),r.dc("ngIf",!e.show.pathInVideoPaths),r.yb(5),r.dc("ngForOf",e.show.settings.wantedLanguages),r.yb(8),r.dc("value",e.show.totalSubtitlesAvailable)("total",e.show.totalSubtitlesWanted),r.yb(2),r.dc("ngForOf",e.show.seasons)}}function Te(e,t){if(1&e){const e=r.Qb();r.Pb(0,"app-show-settings",59),r.Wb("visibleChange",(function(t){return r.qc(e),r.Yb().showShowSettings=t})),r.Ob()}if(2&e){const e=r.Yb();r.dc("visible",e.showShowSettings)("tvdbId",e.show.tvdbId)("title",e.show.name)("showSettings",e.show.settings)}}function Ve(e,t){if(1&e){const e=r.Qb();r.Pb(0,"app-library-video-subtitles",60),r.Wb("visibleChange",(function(t){return r.qc(e),r.Yb().showVideoSubtitles=t}))("save",(function(t){return r.qc(e),r.Yb().saveHardcodedSubtitles(t)})),r.Ob()}if(2&e){const e=r.Yb();r.dc("visible",e.showVideoSubtitles)("videoSubtitles",e.videoSubtitles)}}let $e=(()=>{class e{constructor(e,t,i,a,s,o,n,r){this.route=e,this.router=t,this.domSanitizer=i,this.showService=a,this.artworkService=s,this.settingsService=o,this.messageService=n,this.confirmationService=r,this.loading=!1,this.refreshInProgress=!1,this.showShowSettings=!1,this.showVideoSubtitles=!1}ngOnInit(){this.route.paramMap.subscribe(e=>{this.loading=!0;const t=Number(e.get("tvdbId"));this.getShowDetails(t)})}getShowPosterFullSizeUrl(){return this.artworkService.getShowPosterFullSizeUrl(this.show.tvdbId)}getShowPosterThumbnailUrl(){return this.artworkService.getShowPosterThumbnailUrl(this.show.tvdbId)}getPosterPlaceholderUrl(){return Object(n.e)()}getTvdbUrl(){return Object(n.f)(this.show.tvdbId)}getPlayVideoUrl(e,t){return this.domSanitizer.bypassSecurityTrustResourceUrl(Object(n.d)(e,t))}openSettingsDialog(){this.showShowSettings=!0}refreshShowDetails(){this.refreshInProgress=!0,this.showService.refreshShowDetails(this.show.tvdbId).subscribe(()=>{this.getShowDetails(this.show.tvdbId),this.refreshInProgress=!1},()=>this.messageService.showErrorMessage("Unable to refresh the show details!"))}openDeleteDialog(){this.confirmationService.confirm({message:`Are you sure that you want to delete <b>${this.show.name}</b>?`,accept:()=>{this.showService.deleteShow(this.show.tvdbId).subscribe(()=>{this.router.navigateByUrl("/library/show")},()=>this.messageService.showErrorMessage(`Unable to delete the show ${this.show.name}!`))}})}addShowPathToVideoPaths(){this.settingsService.updateGeneralSetting("videoPaths",{videoPath:this.show.path}).subscribe(()=>{this.messageService.showSuccessMessage(`Path ${this.show.path} added to the video paths.`),this.getShowDetails(this.show.tvdbId)},e=>{e.status&&409===e.status?this.messageService.showWarningMessage(`Path ${this.show.path} already added to the video paths.`):this.messageService.showErrorMessage(`Unable to add path ${this.show.path} to the video paths!`)})}openVideoSubtitlesDialog(e,t,i){this.videoSubtitles=new o.a,this.videoSubtitles.fileLocation=e,this.videoSubtitles.fileName=t,this.videoSubtitles.languages=i,this.showVideoSubtitles=!0}closeVideoSubtitlesDialog(){this.showVideoSubtitles=!1,this.videoSubtitles=null}saveHardcodedSubtitles(e,t){this.showService.saveShowHardcodedSubtitles(this.show.tvdbId,e,t).subscribe(()=>{this.closeVideoSubtitlesDialog(),this.getShowDetails(this.show.tvdbId)},()=>this.messageService.showErrorMessage("Unable to save the harcoded subtitles!"))}getNrOfSubtitles(e,t){let i=0;return e.forEach(e=>{e.type===me.a.SUBTITLE&&e.language&&e.language===t?i++:e.type===me.a.VIDEO&&(e.hardcodedLanguages&&e.hardcodedLanguages.forEach(e=>{e===t&&i++}),e.embeddedLanguages&&e.embeddedLanguages.forEach(e=>{e===t&&i++}))}),i.toString()}getNrOfVideos(e){let t=0;return e.forEach(e=>{e.type===me.a.VIDEO&&t++}),t.toString()}getShowDetails(e){this.showService.getShowDetails(e).subscribe(e=>{this.show=e,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the show details!"))}}return e.\u0275fac=function(t){return new(t||e)(r.Jb(s.a),r.Jb(s.b),r.Jb(b.b),r.Jb(re.a),r.Jb(c.a),r.Jb(d.a),r.Jb(g.a),r.Jb(h.a))},e.\u0275cmp=r.Db({type:e,selectors:[["app-library-show-detail"]],decls:11,vars:4,consts:[[1,"container-lg"],["header","Show details"],[3,"visible"],["aria-hidden","true",1,"pi","pi-spin","pi-spinner","mr-2"],["class","library-details-container",4,"ngIf"],["header","Confirmation","icon","pi pi-exclamation-triangle"],[3,"visible","tvdbId","title","showSettings","visibleChange",4,"ngIf"],[3,"visible","videoSubtitles","visibleChange","save",4,"ngIf"],[1,"library-details-container"],[1,"row","mb-3"],[1,"col-12","library-details-info-container"],[1,"library-details-info-poster"],["target","_blank",3,"href"],["title","Click to view full size",1,"library-details-info-poster-image",3,"lazyLoad","defaultImage"],[1,"library-details-info"],[1,"row"],[1,"col-12","library-details-info-title"],[1,"icon-group","ml-1"],["target","_blank",1,"icon-link",3,"href"],["aria-hidden","true","title","Click to visit Tvdb",1,"fa","fa-television"],[1,"icon-link",3,"click"],["aria-hidden","true","title","Click to edit show settings",1,"fa","fa-wrench"],["aria-hidden","true","title","Click to refresh show details",1,"fa","fa-repeat"],["aria-hidden","true","title","Click to delete show from the database",1,"fa","fa-trash"],[1,"col-12"],[1,"row","mb-2"],[1,"col-3"],[1,"col-9","wrap-text"],["class","icon-link",3,"click",4,"ngIf"],[1,"col-9"],["class","p-tag language mr-2",4,"ngFor","ngForOf"],[1,"library-details-files-summary"],[1,"summary-title"],[1,"summary-progress-bar","ml-auto"],[3,"value","total"],["class","row mb-3",4,"ngFor","ngForOf"],["aria-hidden","true","title","Click to add the show path to the video paths to scan",1,"fa","fa-plus"],[1,"p-tag","language","mr-2"],[1,"col-12","library-details-files"],["styleClass","p-datatable-sm",3,"value","autoLayout"],["pTemplate","caption"],["pTemplate","body"],[1,"table-caption"],[1,"table-caption-title"],[1,"ml-auto"],["styleClass","p-button-static p-button-outlined p-button-sm ml-2",3,"label","badge",4,"ngFor","ngForOf"],["label","video","styleClass","p-button-static p-button-outlined p-button-sm ml-2",3,"badge"],["styleClass","p-button-static p-button-outlined p-button-sm ml-2",3,"label","badge"],[1,"wrap-text"],["class","icon-link",3,"href",4,"ngIf"],["class","text-right",4,"ngIf"],["aria-hidden","true","title","Click to save hardcoded subtitle languages",1,"fa","fa-wrench"],[1,"icon-link",3,"href"],["aria-hidden","true","title","Click to play video",1,"fa","fa-play-circle-o"],[1,"text-right"],["class","p-tag language ml-2",4,"ngFor","ngForOf"],["class","p-tag language ml-2",4,"ngIf"],[1,"p-tag","filetype","ml-2"],[1,"p-tag","language","ml-2"],[3,"visible","tvdbId","title","showSettings","visibleChange"],[3,"visible","videoSubtitles","visibleChange","save"]],template:function(e,t){1&e&&(r.Pb(0,"div",0),r.Pb(1,"p-panel",1),r.Kb(2,"app-library-scanning"),r.Pb(3,"app-message",2),r.Kb(4,"i",3),r.Pb(5,"span"),r.yc(6,"Refreshing show details..."),r.Ob(),r.Ob(),r.wc(7,Ue,47,12,"div",4),r.Ob(),r.Ob(),r.Kb(8,"p-confirmDialog",5),r.wc(9,Te,1,4,"app-show-settings",6),r.wc(10,Ve,1,2,"app-library-video-subtitles",7)),2&e&&(r.yb(3),r.dc("visible",t.refreshInProgress),r.yb(4),r.dc("ngIf",t.show),r.yb(2),r.dc("ngIf",t.showShowSettings),r.yb(1),r.dc("ngIf",t.showVideoSubtitles))},directives:[u.a,w,m.a,y.j,P.a,O.a,y.i,S,I.c,h.f,be.a,F.a,we.a,D],styles:[""]}),e})();function _e(e,t){if(1&e&&(r.Pb(0,"div",9),r.Pb(1,"span",10),r.Kb(2,"p-button",11),r.Ob(),r.Pb(3,"span",12),r.Kb(4,"app-table-filter",13),r.Ob(),r.Ob()),2&e){const e=r.Yb(),t=r.oc(6);r.yb(2),r.dc("label",e.nrOfShows+" shows"),r.yb(2),r.dc("table",t)("tableStateKey",e.tableStateKey)}}function xe(e,t){1&e&&(r.Pb(0,"tr"),r.Pb(1,"th",14),r.Pb(2,"span"),r.yc(3,"Title"),r.Kb(4,"p-sortIcon",15),r.Ob(),r.Ob(),r.Pb(5,"th",16),r.Pb(6,"span"),r.yc(7,"Year"),r.Kb(8,"p-sortIcon",17),r.Ob(),r.Ob(),r.Pb(9,"th",18),r.Pb(10,"span"),r.yc(11,"Path"),r.Kb(12,"p-sortIcon",19),r.Ob(),r.Ob(),r.Pb(13,"th",20),r.Pb(14,"span"),r.yc(15,"Wanted subtitles"),r.Kb(16,"p-sortIcon",21),r.Ob(),r.Ob(),r.Pb(17,"th",22),r.Pb(18,"span"),r.yc(19,"Subtitles"),r.Kb(20,"p-sortIcon",23),r.Ob(),r.Ob(),r.Ob())}function Je(e,t){if(1&e&&r.Kb(0,"img",33),2&e){const e=r.Yb().$implicit,t=r.Yb();r.dc("lazyLoad",t.getShowBannerThumbnailUrl(e.tvdbId))("defaultImage",t.getBannerPlaceholderUrl())}}function We(e,t){if(1&e&&(r.Pb(0,"span",34),r.yc(1),r.Ob()),2&e){const e=t.$implicit;r.yb(1),r.zc(e)}}const Ee=function(e){return["/library/show/detail",e]};function je(e,t){if(1&e&&(r.Pb(0,"tr"),r.Pb(1,"td"),r.Pb(2,"span",24),r.yc(3,"Title"),r.Ob(),r.Pb(4,"span",25),r.Pb(5,"span",26),r.Pb(6,"a",27),r.wc(7,Je,1,2,"img",28),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Pb(8,"td"),r.Pb(9,"span",24),r.yc(10,"Year"),r.Ob(),r.Pb(11,"span",29),r.yc(12),r.Ob(),r.Ob(),r.Pb(13,"td"),r.Pb(14,"span",24),r.yc(15,"Path"),r.Ob(),r.Pb(16,"span",30),r.yc(17),r.Ob(),r.Ob(),r.Pb(18,"td"),r.Pb(19,"span",24),r.yc(20,"Wanted subtitles"),r.Ob(),r.Pb(21,"span",29),r.wc(22,We,2,1,"span",31),r.Ob(),r.Ob(),r.Pb(23,"td"),r.Pb(24,"span",24),r.yc(25,"Subtitles"),r.Ob(),r.Pb(26,"span",29),r.Kb(27,"app-progress-bar",32),r.Ob(),r.Ob(),r.Ob()),2&e){const e=t.$implicit;r.yb(6),r.dc("routerLink",r.gc(8,Ee,e.tvdbId))("title",e.title),r.yb(1),r.dc("ngIf",e.banner),r.yb(5),r.zc(e.year),r.yb(5),r.zc(e.path),r.yb(5),r.dc("ngForOf",e.settings.wantedLanguages),r.yb(5),r.dc("value",e.totalSubtitlesAvailable)("total",e.totalSubtitlesWanted)}}const Ae=function(){return{showAll:"All"}},Ne=function(e){return[5,10,25,50,e]},qe=[{path:"",redirectTo:"overview",pathMatch:"full"},{path:"overview",component:fe},{path:"show",children:[{path:"overview",component:(()=>{class e{constructor(e,t,i,a){this.systemEventService=e,this.showService=t,this.artworkService=i,this.messageService=a,this.nrOfShows=0,this.globalFilterFields=["title","year","path","settings.wantedLanguages","totalSubtitlesAvailable"],this.tableStateKey="autosubliminal-library-show-overview-table",this.loading=!1}ngOnInit(){this.loadOverview(),this.scanLibrarySubscription=this.systemEventService.schedulerFinish.subscribe(e=>{e.name===p.b.scanLibrary&&this.loadOverview()})}ngOnDestroy(){this.scanLibrarySubscription.unsubscribe()}loadOverview(){this.loading=!0,this.showService.getShows().subscribe(e=>{this.shows=e,this.nrOfShows=this.shows.length,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the shows!"))}sort(e){Object(Q.a)(e)}getShowBannerThumbnailUrl(e){return this.artworkService.getShowBannerThumbnailUrl(e)}getBannerPlaceholderUrl(){return Object(n.a)()}}return e.\u0275fac=function(t){return new(t||e)(r.Jb(f.a),r.Jb(re.a),r.Jb(c.a),r.Jb(g.a))},e.\u0275cmp=r.Db({type:e,selectors:[["app-library-show-overview"]],decls:10,vars:14,consts:[[1,"container-lg"],["header","Show library"],[1,"row"],[1,"col-12","library-overview-container"],["stateStorage","local","currentPageReportTemplate","{first} to {last} of {totalRecords}","styleClass","p-datatable-sm p-datatable-gridlines p-datatable-striped p-datatable-responsive-mode",3,"value","stateKey","loading","autoLayout","rowHover","paginator","rows","rowsPerPageOptions","showCurrentPageReport","globalFilterFields","customSort","sortFunction"],["showTable",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"caption"],[1,"w-100"],["styleClass","p-button-static p-button-outlined",3,"label"],[1,"ml-auto"],["matchMode","contains",3,"table","tableStateKey"],["pSortableColumn","title"],["field","title"],["pSortableColumn","year"],["field","year"],["pSortableColumn","path"],["field","path"],["pSortableColumn","settings.wantedLanguages"],["field","settings.wantedLanguages"],["pSortableColumn","totalSubtitlesAvailable"],["field","totalSubtitlesAvailable"],[1,"p-column-title"],[1,"p-column-data","title-banner-container"],[1,"title-banner"],[3,"routerLink","title"],["class","title-banner-image",3,"lazyLoad","defaultImage",4,"ngIf"],[1,"p-column-data"],[1,"p-column-data","wrap-text"],["class","p-tag p-tag-small p-tag-secondary mr-2",4,"ngFor","ngForOf"],[1,"w-100",3,"value","total"],[1,"title-banner-image",3,"lazyLoad","defaultImage"],[1,"p-tag","p-tag-small","p-tag-secondary","mr-2"]],template:function(e,t){1&e&&(r.Pb(0,"div",0),r.Pb(1,"p-panel",1),r.Kb(2,"app-library-scanning"),r.Pb(3,"div",2),r.Pb(4,"div",3),r.Pb(5,"p-table",4,5),r.Wb("sortFunction",(function(e){return t.sort(e)})),r.wc(7,_e,5,3,"ng-template",6),r.wc(8,xe,21,0,"ng-template",7),r.wc(9,je,28,10,"ng-template",8),r.Ob(),r.Ob(),r.Ob(),r.Ob(),r.Ob()),2&e&&(r.yb(5),r.dc("value",t.shows)("stateKey",t.tableStateKey)("loading",t.loading)("autoLayout",!0)("rowHover",!0)("paginator",!0)("rows",10)("rowsPerPageOptions",r.gc(12,Ne,r.fc(11,Ae)))("showCurrentPageReport",!0)("globalFilterFields",t.globalFilterFields)("customSort",!0))},directives:[u.a,w,I.c,h.f,F.a,B.a,I.b,I.a,s.d,y.j,y.i,S,O.a],styles:[""]}),e})()},{path:"detail/:tvdbId",component:$e}]},{path:"movie",children:[{path:"overview",component:oe},{path:"detail/:imdbId",component:H}]},{path:"**",redirectTo:"overview"}];let Re=(()=>{class e{}return e.\u0275mod=r.Hb({type:e}),e.\u0275inj=r.Gb({factory:function(t){return new(t||e)},imports:[[s.e.forChild(qe)],s.e]}),e})(),He=(()=>{class e{}return e.\u0275mod=r.Hb({type:e}),e.\u0275inj=r.Gb({factory:function(t){return new(t||e)},imports:[[a.a,Re]]}),e})()}}]);