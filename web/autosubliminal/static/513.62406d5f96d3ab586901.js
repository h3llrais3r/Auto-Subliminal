"use strict";(self.webpackChunkautosubliminal=self.webpackChunkautosubliminal||[]).push([[513],{2513:(je,x,l)=>{l.r(x),l.d(x,{HomeModule:()=>Ve});var F=l(3082),Z=l(4157),e=l(639),S=l(4020),_=l(1131),f=l(6716),T=l(3695);function U(n,o="",t=!1){let i=n||o;try{i=i&&String(i)}catch(s){i=o}return i&&t?i.toUpperCase():i}function q(n){return n.charAt(0).toUpperCase()+n.slice(1)}var I=l(3660),c=l(8002),v=l(4364);class M{constructor(o){Object.assign(this,o)}get isEpisode(){return this.type===f.Z.EPISODE}get isMovie(){return this.type===f.Z.MOVIE}get name(){let o=this.title;return o+=this.year?` (${this.year})`:"",o}get longName(){if(this.isMovie)return this.name;if(this.isEpisode){const o=`00${this.season}`.slice(-2),t=Array.isArray(this.episode)?this.episode.map(i=>`00${i}`.slice(-2)).join("-"):`00${this.episode}`.slice(-2);return`${this.name} S${o}E${t}`}}}class h extends M{constructor(o){super(o)}get timestampFormatted(){return(0,v.o0)((0,v.bl)(this.timestamp,"YYYY-MM-DD hh:mm:ss").getTime())}}class $ extends M{constructor(o){super(o)}get timestampFormatted(){return(0,v.o0)((0,v.bl)(this.timestamp,"YYYY-MM-DD hh:mm:ss").getTime())}}class J{constructor(o){Object.assign(this,o)}}var W=l(8621),P=l(1841);let b=(()=>{class n extends W.g{constructor(t){super(t),this.httpClient=t,this.URL=`${_.$0.webRoot}/api/items`}getWantedItems(){return this.httpClient.get(`${this.URL}/wanted`,this.options).pipe((0,c.U)(t=>t.map(i=>new h(i))))}getWantedItem(t){return this.httpClient.get(`${this.URL}/wanted/${t}`,this.options).pipe((0,c.U)(i=>new h(i)))}updateWantedItem(t){return this.httpClient.put(`${this.URL}/wanted/${t.id}`,JSON.stringify(t),this.options).pipe((0,c.U)(i=>new h(i)))}resetWantedItem(t){return this.httpClient.patch(`${this.URL}/wanted/${t}`,{action:"reset"},this.options).pipe((0,c.U)(i=>new h(i)))}deleteWantedItem(t,i){return this.httpClient.patch(`${this.URL}/wanted/${t}`,{action:"delete",cleanup:i},this.options).pipe((0,c.U)(()=>!0))}skipWantedItem(t,i,s){return this.httpClient.patch(`${this.URL}/wanted/${t}`,{action:"skip",type:i,season:s},this.options).pipe((0,c.U)(()=>!0))}postProcessWantedItem(t,i){return this.httpClient.patch(`${this.URL}/wanted/${t}`,{action:"postProcess",subtitleIndex:i},this.options).pipe((0,c.U)(()=>!0))}searchWantedItemIndexerId(t){return this.httpClient.patch(`${this.URL}/wanted/${t}`,{action:"searchIndexerId"},this.options).pipe((0,c.U)(i=>new h(i)))}searchWantedItemSubtitles(t,i){return this.httpClient.patch(`${this.URL}/wanted/${t}`,{action:"searchSubtitles",language:i},this.options).pipe((0,c.U)(s=>s.map(a=>new J(a))))}saveWantedItemSubtitle(t,i){return this.httpClient.patch(`${this.URL}/wanted/${t}`,{action:"saveSubtitle",subtitleIndex:i},this.options).pipe((0,c.U)(()=>!0))}deleteWantedItemSubtitle(t){return this.httpClient.patch(`${this.URL}/wanted/${t}`,{action:"deleteSubtitle"},this.options).pipe((0,c.U)(()=>!0))}getDownloadedItems(){return this.httpClient.get(`${this.URL}/downloaded`,this.options).pipe((0,c.U)(t=>t.map(i=>new $(i))))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(P.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var O=l(8317),w=l(1245),d=l(3013),m=l(3380),g=l(8583),E=l(3473),A=l(4207),y=l(103),H=l(1450),k=l(1738),Q=l(3994),Y=l(2735),p=l(3679);function C(n){const o=Number(n);if(!n||isNaN(o))throw Error(`Value is not a number: '${n}'`);return o}var u=l(2571),R=l(3383),N=l(5121),L=l(6015),G=l(8424);function z(n,o){if(1&n&&(e.TgZ(0,"form",3),e.TgZ(1,"div",4),e.TgZ(2,"div",5),e.TgZ(3,"label",6),e._uU(4,"Title"),e.qZA(),e.qZA(),e.TgZ(5,"div",7),e._UZ(6,"app-input-text",8),e.qZA(),e.qZA(),e.TgZ(7,"div",4),e.TgZ(8,"div",5),e.TgZ(9,"label",9),e._uU(10,"Year"),e.qZA(),e.qZA(),e.TgZ(11,"div",7),e._UZ(12,"app-input-number",10),e.qZA(),e.qZA(),e.TgZ(13,"div",4),e.TgZ(14,"div",5),e.TgZ(15,"label",11),e._uU(16,"Season"),e.qZA(),e.qZA(),e.TgZ(17,"div",7),e._UZ(18,"app-input-number",12),e.qZA(),e.qZA(),e.TgZ(19,"div",4),e.TgZ(20,"div",5),e.TgZ(21,"label",13),e._uU(22,"Episode"),e.qZA(),e.qZA(),e.TgZ(23,"div",7),e._UZ(24,"app-input-text",14),e.qZA(),e.qZA(),e.TgZ(25,"div",4),e.TgZ(26,"div",5),e.TgZ(27,"label",15),e._uU(28,"Source"),e.qZA(),e.qZA(),e.TgZ(29,"div",7),e._UZ(30,"app-input-text",16),e.qZA(),e.qZA(),e.TgZ(31,"div",4),e.TgZ(32,"div",5),e.TgZ(33,"label",17),e._uU(34,"Codec"),e.qZA(),e.qZA(),e.TgZ(35,"div",7),e._UZ(36,"app-input-text",18),e.qZA(),e.qZA(),e.TgZ(37,"div",4),e.TgZ(38,"div",5),e.TgZ(39,"label",19),e._uU(40,"Group"),e.qZA(),e.qZA(),e.TgZ(41,"div",7),e._UZ(42,"app-input-text",20),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.Q6J("formGroup",t.itemForm),e.xp6(6),e.Q6J("validationFeedback",t.updateAttempt),e.xp6(6),e.Q6J("showButtons",!1),e.xp6(6),e.Q6J("showButtons",!1)}}function V(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e.qZA(),e.TgZ(1,"p-button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().resetWantedItem()}),e.qZA(),e.TgZ(2,"p-button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateWantedItem()}),e.qZA()}}let j=(()=>{class n{constructor(t,i,s){this.fb=t,this.itemService=i,this.messageService=s,this.visible=!1,this.visibleChange=new e.vpe,this.wantedItemChange=new e.vpe,this.updateAttempt=!1}ngOnInit(){this.buildForm(this.wantedItem)}buildForm(t){this.itemForm=this.fb.group({title:[t.title,[p.kI.required,R.U.notEmpty]],year:[t.year,[]],season:[t.season,[]],episode:[t.episode?t.episode.toString():t.codec,[]],source:[t.source?t.source.toString():t.codec,[]],quality:[t.quality,[]],codec:[t.codec?t.codec.toString():t.codec,[]],releaseGroup:[t.releaseGroup,[]]})}resetWantedItem(){const t=this.getWantedItem();this.itemService.resetWantedItem(t.id).subscribe(i=>{this.wantedItemChange.emit(i),this.messageService.showSuccessMessage(`Restored ${i.longName}.`),this.close()},()=>this.messageService.showErrorMessage(`Unable to restore ${t.longName}`))}updateWantedItem(){if(this.updateAttempt=!0,this.itemForm.valid){const t=this.getWantedItem();this.itemService.updateWantedItem(t).subscribe(i=>{this.wantedItemChange.emit(i),this.messageService.showSuccessMessage(`Updated ${i.longName}.`),this.close()},()=>this.messageService.showErrorMessage(`Unable to update ${t.longName}`))}}getWantedItem(){const t=new h(this.wantedItem);t.title=u.h.getFormControlValue(this.itemForm,"title"),t.year=u.h.getFormControlValue(this.itemForm,"year"),t.season=u.h.getFormControlValue(this.itemForm,"season");const i=u.h.getFormControlValue(this.itemForm,"episode");t.episode=i&&i.indexOf(",")>0?function(n){if(n){if("number"==typeof n)return[n];if("string"==typeof n)return n.split(",").map(t=>C(t))}throw Error(`Value is not a list of numbers: '${n}'`)}(i):i?C(i):null;const s=u.h.getFormControlValue(this.itemForm,"source");t.source=s&&s.indexOf(",")>0?s.split(",").map(r=>r.trim()):s,t.quality=u.h.getFormControlValue(this.itemForm,"quality");const a=u.h.getFormControlValue(this.itemForm,"codec");return t.codec=a&&a.indexOf(",")>0?a.split(",").map(r=>r.trim()):a,t.releaseGroup=u.h.getFormControlValue(this.itemForm,"releaseGroup"),t}close(){this.visibleChange.emit(!1)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(b),e.Y36(w.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-manual-refine"]],inputs:{visible:"visible",wantedItem:"wantedItem"},outputs:{visibleChange:"visibleChange",wantedItemChange:"wantedItemChange"},decls:3,vars:5,consts:[["header","Manually refine item details","styleClass","dialog-manual-refine",3,"visible","modal","closable","resizable","visibleChange"],["class","form",3,"formGroup",4,"ngIf"],["pTemplate","footer"],[1,"form",3,"formGroup"],[1,"row","form-row"],[1,"col-12","col-sm-4","form-row-label"],["for","title",1,"label"],[1,"col-12","col-sm-8"],["formControlName","title",3,"validationFeedback"],["for","year",1,"label"],["formControlName","year",3,"showButtons"],["for","season",1,"label"],["formControlName","season",3,"showButtons"],["for","episode",1,"label"],["formControlName","episode"],["for","source",1,"label"],["formControlName","source"],["for","codec",1,"label"],["formControlName","codec"],["for","releaseGroup",1,"label"],["formControlName","releaseGroup"],["icon","pi pi-times","label","Cancel","styleClass","p-button p-button-secondary",3,"click"],["icon","pi pi-undo","label","Reset","styleClass","p-button",3,"click"],["icon","pi pi-check","label","Update","styleClass","p-button mr-0",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"p-dialog",0),e.NdJ("visibleChange",function(a){return i.visible=a}),e.YNc(1,z,43,4,"form",1),e.YNc(2,V,3,0,"ng-template",2),e.qZA()),2&t&&(e.Q6J("visible",i.visible)("modal",!0)("closable",!1)("resizable",!1),e.xp6(1),e.Q6J("ngIf",i.itemForm))},directives:[N.V,g.O5,d.jx,p._Y,p.JL,p.sg,L.m,p.JJ,p.u,G.l,A.zx],styles:[".dialog-manual-refine{width:30rem}"]}),n})();var B=l(5301),K=l(3928);function X(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",15),e.TgZ(1,"div",16),e.TgZ(2,"span",17),e._uU(3,"Type"),e.qZA(),e.TgZ(4,"p-dropdown",18),e.NdJ("onChange",function(s){return e.CHM(t),e.oxw(),e.MAs(1).filter(s.value,"type","equals")}),e.qZA(),e.qZA(),e.TgZ(5,"span",19),e._UZ(6,"app-table-filter",20),e.qZA(),e.qZA()}if(2&n){const t=e.oxw(),i=e.MAs(1);e.xp6(4),e.Q6J("options",t.videoTypes),e.xp6(2),e.Q6J("table",i)("tableStateKey",t.tableStateKey)}}function ee(n,o){1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"th",21),e.TgZ(2,"span"),e._uU(3,"Name"),e._UZ(4,"p-sortIcon",22),e.qZA(),e.qZA(),e.TgZ(5,"th",23),e.TgZ(6,"span"),e._uU(7,"Season"),e._UZ(8,"p-sortIcon",24),e.qZA(),e.qZA(),e.TgZ(9,"th",25),e.TgZ(10,"span"),e._uU(11,"Episode"),e._UZ(12,"p-sortIcon",26),e.qZA(),e.qZA(),e.TgZ(13,"th",27),e.TgZ(14,"span"),e._uU(15,"Source"),e._UZ(16,"p-sortIcon",28),e.qZA(),e.qZA(),e.TgZ(17,"th",29),e.TgZ(18,"span"),e._uU(19,"Quality"),e._UZ(20,"p-sortIcon",30),e.qZA(),e.qZA(),e.TgZ(21,"th",31),e.TgZ(22,"span"),e._uU(23,"Codec"),e._UZ(24,"p-sortIcon",32),e.qZA(),e.qZA(),e.TgZ(25,"th",33),e.TgZ(26,"span"),e._uU(27,"Group"),e._UZ(28,"p-sortIcon",34),e.qZA(),e.qZA(),e.TgZ(29,"th",35),e.TgZ(30,"span"),e._uU(31,"Lang"),e._UZ(32,"p-sortIcon",36),e.qZA(),e.qZA(),e.TgZ(33,"th",37),e.TgZ(34,"span"),e._uU(35,"Time"),e._UZ(36,"p-sortIcon",38),e.qZA(),e.qZA(),e.qZA())}function te(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"ul",50),e.TgZ(1,"li",51),e.TgZ(2,"a",52),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().postProcessWantedItem(s)}),e._uU(3,"Post process show"),e.qZA(),e.qZA(),e.TgZ(4,"li",51),e.TgZ(5,"a",52),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().deleteWantedItem(s)}),e._uU(6,"Delete show"),e.qZA(),e.qZA(),e.TgZ(7,"li",51),e.TgZ(8,"a",52),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().skipShow(s)}),e._uU(9,"Skip show"),e.qZA(),e.qZA(),e.qZA()}}function ne(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"ul",50),e.TgZ(1,"li",51),e.TgZ(2,"a",52),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().postProcessWantedItem(s)}),e._uU(3,"Post process movie"),e.qZA(),e.qZA(),e.TgZ(4,"li",51),e.TgZ(5,"a",52),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().deleteWantedItem(s)}),e._uU(6,"Delete movie"),e.qZA(),e.qZA(),e.TgZ(7,"li",51),e.TgZ(8,"a",52),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().skipMovie(s)}),e._uU(9,"Skip movie"),e.qZA(),e.qZA(),e.qZA()}}function ie(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a",57),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit;return e.oxw().searchIndexerId(s)}),e._UZ(1,"i",58),e.qZA()}}function oe(n,o){if(1&n&&(e.TgZ(0,"a",59),e._UZ(1,"i",60),e.qZA()),2&n){const t=e.oxw(2).$implicit,i=e.oxw();e.Q6J("href",i.getTvdbUrl(t),e.LSH)}}function se(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,ie,2,0,"a",53),e.YNc(2,oe,2,1,"a",54),e.TgZ(3,"a",55),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().openShowSettingsDialog(s)}),e._UZ(4,"i",56),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!t.tvdbId),e.xp6(1),e.Q6J("ngIf",t.tvdbId)}}function ae(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a",57),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit;return e.oxw().searchIndexerId(s)}),e._UZ(1,"i",62),e.qZA()}}function le(n,o){if(1&n&&(e.TgZ(0,"a",59),e._UZ(1,"i",63),e.qZA()),2&n){const t=e.oxw(2).$implicit,i=e.oxw();e.Q6J("href",i.getImdbUrl(t),e.LSH)}}function re(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,ae,2,0,"a",53),e.YNc(2,le,2,1,"a",54),e.TgZ(3,"a",55),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().openMovieSettingsDialog(s)}),e._UZ(4,"i",61),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!t.imdbId),e.xp6(1),e.Q6J("ngIf",t.imdbId)}}function ce(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",55),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().openManualRefineDialog(s)}),e._UZ(2,"i",64),e.qZA(),e.BQk()}}function pe(n,o){1&n&&e._UZ(0,"i",65)}function me(n,o){1&n&&e._UZ(0,"i",66)}function de(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"span",67),e.TgZ(1,"a",68),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw().$implicit;return e.oxw().goToManualSearch(r,a)}),e._uU(2),e.qZA(),e.qZA()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t)}}function ue(n,o){if(1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"span",39),e._uU(3,"Name"),e.qZA(),e.TgZ(4,"span",40),e.TgZ(5,"span",41),e.TgZ(6,"a",42),e._uU(7),e.qZA(),e.YNc(8,te,10,0,"ul",43),e.YNc(9,ne,10,0,"ul",43),e.qZA(),e.TgZ(10,"app-icon-dropdown"),e.TgZ(11,"li"),e.TgZ(12,"span",44),e._uU(13,"File name:"),e.qZA(),e.TgZ(14,"span"),e._uU(15),e.qZA(),e.qZA(),e.TgZ(16,"li"),e.TgZ(17,"span",44),e._uU(18,"File path:"),e.qZA(),e.TgZ(19,"span"),e._uU(20),e.qZA(),e.qZA(),e.TgZ(21,"li"),e.TgZ(22,"span",44),e._uU(23,"File size:"),e.qZA(),e.TgZ(24,"span"),e._uU(25),e.qZA(),e.qZA(),e.qZA(),e.TgZ(26,"span",45),e.YNc(27,se,5,2,"ng-container",46),e.YNc(28,re,5,2,"ng-container",46),e.YNc(29,ce,3,0,"ng-container",46),e.YNc(30,pe,1,0,"i",47),e.YNc(31,me,1,0,"i",48),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"td"),e.TgZ(33,"span",39),e._uU(34,"Season"),e.qZA(),e.TgZ(35,"span",40),e._uU(36),e.qZA(),e.qZA(),e.TgZ(37,"td"),e.TgZ(38,"span",39),e._uU(39,"Episode"),e.qZA(),e.TgZ(40,"span",40),e._uU(41),e.qZA(),e.qZA(),e.TgZ(42,"td"),e.TgZ(43,"span",39),e._uU(44,"Source"),e.qZA(),e.TgZ(45,"span",40),e._uU(46),e.qZA(),e.qZA(),e.TgZ(47,"td"),e.TgZ(48,"span",39),e._uU(49,"Quality"),e.qZA(),e.TgZ(50,"span",40),e._uU(51),e.qZA(),e.qZA(),e.TgZ(52,"td"),e.TgZ(53,"span",39),e._uU(54,"Codec"),e.qZA(),e.TgZ(55,"span",40),e._uU(56),e.qZA(),e.qZA(),e.TgZ(57,"td"),e.TgZ(58,"span",39),e._uU(59,"Group"),e.qZA(),e.TgZ(60,"span",40),e._uU(61),e.qZA(),e.qZA(),e.TgZ(62,"td"),e.TgZ(63,"span",39),e._uU(64,"Lang"),e.qZA(),e.TgZ(65,"span",40),e.YNc(66,de,3,1,"span",49),e.qZA(),e.qZA(),e.TgZ(67,"td"),e.TgZ(68,"span",39),e._uU(69,"Time"),e.qZA(),e.TgZ(70,"span",40),e._uU(71),e.qZA(),e.qZA(),e.qZA()),2&n){const t=o.$implicit,i=e.oxw();e.xp6(7),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.isEpisode),e.xp6(1),e.Q6J("ngIf",t.isMovie),e.xp6(6),e.Oqu(t.videoFileName),e.xp6(5),e.Oqu(t.videoFilePath),e.xp6(5),e.Oqu(t.videoFileSize),e.xp6(2),e.Q6J("ngIf",t.isEpisode),e.xp6(1),e.Q6J("ngIf",t.isMovie),e.xp6(1),e.Q6J("ngIf",i.manualRefineEnabled),e.xp6(1),e.Q6J("ngIf",t.isSearchActive),e.xp6(1),e.Q6J("ngIf",!t.isSearchActive),e.xp6(5),e.Oqu(t.season),e.xp6(5),e.Oqu(t.episode),e.xp6(5),e.Oqu(i.displayUpperCase(t.source)),e.xp6(5),e.Oqu(i.displayUpperCase(t.quality)),e.xp6(5),e.Oqu(i.displayUpperCase(t.codec)),e.xp6(5),e.Oqu(i.displayUpperCase(t.releaseGroup)),e.xp6(5),e.Q6J("ngForOf",t.languages),e.xp6(5),e.Oqu(t.timestampFormatted)}}function ge(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"app-show-settings",69),e.NdJ("visibleChange",function(s){return e.CHM(t),e.oxw().showShowSettings=s}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("visible",t.showShowSettings)("tvdbId",t.selectedWantedItem.tvdbId)("title",t.selectedWantedItem.name)}}function _e(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"app-movie-settings",70),e.NdJ("visibleChange",function(s){return e.CHM(t),e.oxw().showMovieSettings=s}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("visible",t.showMovieSettings)("imdbId",t.selectedWantedItem.imdbId)("title",t.selectedWantedItem.name)}}function he(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"app-manual-refine",71),e.NdJ("visibleChange",function(s){return e.CHM(t),e.oxw().showManualRefine=s})("wantedItemChange",function(s){return e.CHM(t),e.oxw().updateWantedItem(s)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("visible",t.showManualRefine)("wantedItem",t.selectedWantedItem)}}function Ze(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",72),e.TgZ(1,"span",73),e._uU(2,"Cleanup leftovers"),e.qZA(),e.TgZ(3,"p-inputSwitch",74),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().cleanupOnDelete=s}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngModel",t.cleanupOnDelete)}}function fe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",75),e.TgZ(1,"span",73),e._uU(2,"Season(s)"),e.qZA(),e.TgZ(3,"input",76),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().seasonToSkip=s}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngModel",t.seasonToSkip)}}const Te=function(){return{showAll:"All"}},ve=function(n){return[5,10,25,50,n]};let be=(()=>{class n{constructor(t,i,s,a,r){this.router=t,this.itemService=i,this.systemEventService=s,this.messageService=a,this.confirmationService=r,this.totals=new e.vpe,this.showShowSettings=!1,this.showMovieSettings=!1,this.showManualRefine=!1,this.manualRefineEnabled=!1,this.loading=!1,this.cleanupOnDelete=!1,this.seasonToSkip="00",this.globalFilterFields=["name","season","episode","source","quality","codec","releaseGroup","languages","timestamp"],this.tableStateKey="autosubliminal-home-wanted-table"}ngOnInit(){this.manualRefineEnabled=_.$0.manualRefineVideo,this.buildSelectItems(),this.loadWantedItems(),this.scanDiskSubscription=this.systemEventService.schedulerFinish.subscribe(t=>{t.name===_.$0.scanDisk&&this.loadWantedItems()}),this.checkSubSubscription=this.systemEventService.schedulerFinish.subscribe(t=>{t.name===_.$0.checkSub&&this.loadWantedItems()})}ngOnDestroy(){this.scanDiskSubscription.unsubscribe(),this.checkSubSubscription.unsubscribe()}buildSelectItems(){this.videoTypes=[],this.videoTypes.push({label:"All",value:null}),Object.values(f.Z).forEach(t=>this.videoTypes.push({label:q(t),value:t}))}loadWantedItems(){this.loading=!0,this.itemService.getWantedItems().subscribe(t=>{this.wantedItems=t,this.emitTotals(),this.loading=!1},()=>{this.loading=!1,this.messageService.showErrorMessage("Unable to get the wanted items")})}sort(t){(0,I.S)(t)}displayUpperCase(t){return U(t,"N/A",!0)}getTvdbUrl(t){return(0,T.zS)(t.tvdbId)}getImdbUrl(t){return(0,T.$X)(t.imdbId)}searchIndexerId(t){const i=t.isEpisode?"tvdb id":"imdb id";this.messageService.showInfoMessage(`Searching for ${i} for ${t.longName}.`),this.itemService.searchWantedItemIndexerId(t.id).subscribe(s=>{this.updateWantedItem(s),this.messageService.showSuccessMessage(`${q(i)} found for ${s.longName}.`)},()=>this.messageService.showErrorMessage(`Unable to search ${i} for ${t.longName}!`))}openShowSettingsDialog(t){this.showShowSettings=!0,this.selectedWantedItem=t}openMovieSettingsDialog(t){this.showMovieSettings=!0,this.selectedWantedItem=t}openManualRefineDialog(t){this.showManualRefine=!0,this.selectedWantedItem=t}goToManualSearch(t,i){this.router.navigate(["/home/search"],{queryParams:{wantedItemId:t.id,language:i}})}updateWantedItem(t){this.wantedItems=this.wantedItems.map(i=>i.id===t.id?t:i)}postProcessWantedItem(t){this.itemService.postProcessWantedItem(t.id).subscribe(()=>{this.removeWantedItemFromList(t),this.messageService.showSuccessMessage(`Post processed ${t.longName}.`)},()=>this.messageService.showErrorMessage(`Unable to post process ${t.longName}!`))}deleteWantedItem(t){this.confirmationType="delete",this.cleanupOnDelete=!1,this.confirmationService.confirm({message:`Are you sure that you want to delete <b>${t.longName}</b>?<br><small><i>Toggle button if you want to cleanup leftovers as well.</i></small>`,accept:()=>{this.itemService.deleteWantedItem(t.id,this.cleanupOnDelete).subscribe(()=>{this.removeWantedItemFromList(t),this.messageService.showSuccessMessage(`Deleted ${t.longName}.`)},()=>this.messageService.showErrorMessage(`Unable to delete ${t.longName}!`))}})}skipShow(t){this.confirmationType="skip",this.seasonToSkip="00",this.confirmationService.confirm({message:`Are you sure that you want to skip show <b>${t.name}</b>?<br><small><i>Enter season(s) to skip (comma separated, 00 = all seasons, 0 = specials).</i></small>`,accept:()=>{this.itemService.skipWantedItem(t.id,t.type,this.seasonToSkip).subscribe(()=>{this.removeWantedItemFromList(t),this.messageService.showSuccessMessage(this.seasonToSkip&&"00"!==this.seasonToSkip?`Skipped the show ${t.name} season(s) ${this.seasonToSkip}.`:`Skipped the show ${t.name} all seasons.`)},()=>this.messageService.showErrorMessage(`Unable to skip the show ${t.name}!`))}})}skipMovie(t){this.confirmationService.confirm({message:`Are you sure that you want to skip movie <b>${t.name}</b>?`,accept:()=>{this.itemService.skipWantedItem(t.id,t.type).subscribe(()=>{this.removeWantedItemFromList(t),this.messageService.showSuccessMessage(`Skipped the movie ${t.name}.`)},()=>this.messageService.showErrorMessage(`Unable to skip the movie ${t.name}!`))}})}removeWantedItemFromList(t){this.wantedItems=this.wantedItems.filter(i=>i.id!==t.id),this.emitTotals()}emitTotals(){const t=this.wantedItems.length,i=this.wantedItems.filter(a=>a.isEpisode).length,s=this.wantedItems.filter(a=>a.isMovie).length;this.totals.emit({total:t,totalEpisodes:i,totalMovies:s})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Z.F0),e.Y36(b),e.Y36(O.h),e.Y36(w.e),e.Y36(d.YP))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-home-wanted"]],inputs:{wantedItems:"wantedItems"},outputs:{totals:"totals"},decls:17,vars:19,consts:[["stateStorage","local","currentPageReportTemplate","{first} to {last} of {totalRecords}","styleClass","p-datatable-sm p-datatable-gridlines p-datatable-striped p-datatable-responsive-mode",3,"value","stateKey","loading","autoLayout","rowHover","paginator","rows","rowsPerPageOptions","showCurrentPageReport","globalFilterFields","customSort","sortFunction"],["wantedTable",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[3,"visible","tvdbId","title","visibleChange",4,"ngIf"],[3,"visible","imdbId","title","visibleChange",4,"ngIf"],[3,"visible","wantedItem","visibleChange","wantedItemChange",4,"ngIf"],["header","Confirmation","icon","pi pi-exclamation-triangle"],["cd",""],[1,"confirmation-buttons"],["class","confirmation-cleanup-toggle",4,"ngIf"],["class","confirmation-skip-season",4,"ngIf"],["type","button","pButton","","icon","pi pi-times","label","No",3,"click"],["type","button","pButton","","icon","pi pi-check","label","Yes",3,"click"],[1,"caption"],[1,"p-inputgroup","dropdown"],[1,"p-inputgroup-addon"],[3,"options","onChange"],[1,"ml-auto"],["matchMode","contains",3,"table","tableStateKey"],["pSortableColumn","name"],["field","name"],["pSortableColumn","season"],["field","season"],["pSortableColumn","episode"],["field","episode"],["pSortableColumn","source"],["field","source"],["pSortableColumn","quality"],["field","quality"],["pSortableColumn","codec"],["field","codec"],["pSortableColumn","releaseGroup"],["field","releaseGroup"],["pSortableColumn","languages"],["field","languages"],["pSortableColumn","timestamp"],["field","timestamp"],[1,"p-column-title"],[1,"p-column-data"],[1,"dropdown"],["data-toggle","dropdown","data-display","static","aria-haspopup","true","aria-expanded","false","title","Click for actions",1,"dropdown-toggle","has-tip","dropdown-link"],["class","dropdown-menu has-tip",4,"ngIf"],[1,"icon-dropdown-title"],[1,"icon-group"],[4,"ngIf"],["class","fa fa-check-circle text-success","aria-hidden","true","title","Included in automatic search",4,"ngIf"],["class","fa fa-pause-circle text-warning","aria-hidden","true","title","Not included in automatic search",4,"ngIf"],["class","p-tag language mr-2",4,"ngFor","ngForOf"],[1,"dropdown-menu","has-tip"],[1,"dropdown-item"],[3,"click"],["class","icon-link text-danger",3,"click",4,"ngIf"],["class","icon-link","target","_blank",3,"href",4,"ngIf"],[1,"icon-link",3,"click"],["aria-hidden","true","title","Click to edit show settings",1,"fa","fa-wrench"],[1,"icon-link","text-danger",3,"click"],["aria-hidden","true","title","Click to search tvdb id",1,"fa","fa-exclamation-triangle"],["target","_blank",1,"icon-link",3,"href"],["aria-hidden","true","title","Click to visit Tvdb",1,"fa","fa-television"],["aria-hidden","true","title","Click to edit movie settings",1,"fa","fa-wrench"],["aria-hidden","true","title","Click to search imdb id",1,"fa","fa-exclamation-triangle"],["aria-hidden","true","title","Click to visit Imdb",1,"fa","fa-imdb"],["aria-hidden","true","title","Click to manually refine item details",1,"fa","fa-pencil"],["aria-hidden","true","title","Included in automatic search",1,"fa","fa-check-circle","text-success"],["aria-hidden","true","title","Not included in automatic search",1,"fa","fa-pause-circle","text-warning"],[1,"p-tag","language","mr-2"],["title","Click to search subtitles",1,"icon-link",3,"click"],[3,"visible","tvdbId","title","visibleChange"],[3,"visible","imdbId","title","visibleChange"],[3,"visible","wantedItem","visibleChange","wantedItemChange"],[1,"confirmation-cleanup-toggle"],[1,"label"],[3,"ngModel","ngModelChange"],[1,"confirmation-skip-season"],["type","text","pInputText","",3,"ngModel","ngModelChange"]],template:function(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"p-table",0,1),e.NdJ("sortFunction",function(r){return i.sort(r)}),e.YNc(2,X,7,3,"ng-template",2),e.YNc(3,ee,37,0,"ng-template",3),e.YNc(4,ue,72,19,"ng-template",4),e.qZA(),e.YNc(5,ge,1,3,"app-show-settings",5),e.YNc(6,_e,1,3,"app-movie-settings",6),e.YNc(7,he,1,2,"app-manual-refine",7),e.TgZ(8,"p-confirmDialog",8,9),e.TgZ(10,"p-footer"),e.TgZ(11,"div",10),e.YNc(12,Ze,4,1,"div",11),e.YNc(13,fe,4,1,"div",12),e.TgZ(14,"div"),e.TgZ(15,"button",13),e.NdJ("click",function(){return e.CHM(s),e.MAs(9).reject()}),e.qZA(),e.TgZ(16,"button",14),e.NdJ("click",function(){return e.CHM(s),e.MAs(9).accept()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}2&t&&(e.Q6J("value",i.wantedItems)("stateKey",i.tableStateKey)("loading",i.loading)("autoLayout",!0)("rowHover",!0)("paginator",!0)("rows",10)("rowsPerPageOptions",e.VKq(17,ve,e.DdM(16,Te)))("showCurrentPageReport",!0)("globalFilterFields",i.globalFilterFields)("customSort",!0),e.xp6(5),e.Q6J("ngIf",i.showShowSettings),e.xp6(1),e.Q6J("ngIf",i.showMovieSettings),e.xp6(1),e.Q6J("ngIf",i.showManualRefine),e.xp6(5),e.Q6J("ngIf","delete"===i.confirmationType),e.xp6(1),e.Q6J("ngIf","skip"===i.confirmationType))},directives:[m.iA,d.jx,g.O5,E.Q,d.$_,A.Hq,y.Lt,H.l,m.lQ,m.fz,k.G,g.sg,Q.G,Y.T,j,B.Ql,p.JJ,p.On,p.Fj,K.o],styles:[".p-datatable-auto-layout>.p-datatable-wrapper{overflow-x:visible!important}.dropdown[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{white-space:nowrap}.confirmation-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.confirmation-buttons[_ngcontent-%COMP%]   .confirmation-cleanup-toggle[_ngcontent-%COMP%], .confirmation-buttons[_ngcontent-%COMP%]   .confirmation-skip-season[_ngcontent-%COMP%]{display:flex;align-items:center}.confirmation-buttons[_ngcontent-%COMP%]   .confirmation-cleanup-toggle[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .confirmation-buttons[_ngcontent-%COMP%]   .confirmation-skip-season[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-right:.5rem}"]}),n})();function we(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",5),e.TgZ(1,"div",6),e.TgZ(2,"span",7),e._uU(3,"Type"),e.qZA(),e.TgZ(4,"p-dropdown",8),e.NdJ("onChange",function(s){return e.CHM(t),e.oxw(),e.MAs(1).filter(s.value,"type","equals")}),e.qZA(),e.qZA(),e.TgZ(5,"span",9),e._UZ(6,"app-table-filter",10),e.qZA(),e.qZA()}if(2&n){const t=e.oxw(),i=e.MAs(1);e.xp6(4),e.Q6J("options",t.videoTypes),e.xp6(2),e.Q6J("table",i)("tableStateKey",t.tableStateKey)}}function Ae(n,o){1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"th",11),e.TgZ(2,"span"),e._uU(3,"Name"),e._UZ(4,"p-sortIcon",12),e.qZA(),e.qZA(),e.TgZ(5,"th",13),e.TgZ(6,"span"),e._uU(7,"Season"),e._UZ(8,"p-sortIcon",14),e.qZA(),e.qZA(),e.TgZ(9,"th",15),e.TgZ(10,"span"),e._uU(11,"Episode"),e._UZ(12,"p-sortIcon",16),e.qZA(),e.qZA(),e.TgZ(13,"th",17),e.TgZ(14,"span"),e._uU(15,"Source"),e._UZ(16,"p-sortIcon",18),e.qZA(),e.qZA(),e.TgZ(17,"th",19),e.TgZ(18,"span"),e._uU(19,"Quality"),e._UZ(20,"p-sortIcon",20),e.qZA(),e.qZA(),e.TgZ(21,"th",21),e.TgZ(22,"span"),e._uU(23,"Codec"),e._UZ(24,"p-sortIcon",22),e.qZA(),e.qZA(),e.TgZ(25,"th",23),e.TgZ(26,"span"),e._uU(27,"Group"),e._UZ(28,"p-sortIcon",24),e.qZA(),e.qZA(),e.TgZ(29,"th",25),e.TgZ(30,"span"),e._uU(31,"Lang"),e._UZ(32,"p-sortIcon",26),e.qZA(),e.qZA(),e.TgZ(33,"th",27),e.TgZ(34,"span"),e._uU(35,"Time"),e._UZ(36,"p-sortIcon",28),e.qZA(),e.qZA(),e.qZA())}function qe(n,o){if(1&n&&(e.TgZ(0,"li"),e.TgZ(1,"span",32),e._uU(2,"Video path:"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(t.videoFilePath)}}function Ce(n,o){if(1&n&&(e.TgZ(0,"li"),e.TgZ(1,"span",32),e._uU(2,"Video name:"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(t.videoFileName)}}function xe(n,o){if(1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"span",29),e._uU(3,"Name"),e.qZA(),e.TgZ(4,"span",30),e.TgZ(5,"span"),e._uU(6),e.qZA(),e.TgZ(7,"app-icon-dropdown"),e.YNc(8,qe,5,1,"li",31),e.YNc(9,Ce,5,1,"li",31),e.TgZ(10,"li"),e.TgZ(11,"span",32),e._uU(12,"Subtitle:"),e.qZA(),e.TgZ(13,"span"),e._uU(14),e.qZA(),e.qZA(),e.TgZ(15,"li"),e.TgZ(16,"span",32),e._uU(17,"Provider:"),e.qZA(),e.TgZ(18,"span"),e._uU(19),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"td"),e.TgZ(21,"span",29),e._uU(22,"Season"),e.qZA(),e.TgZ(23,"span",30),e._uU(24),e.qZA(),e.qZA(),e.TgZ(25,"td"),e.TgZ(26,"span",29),e._uU(27,"Episode"),e.qZA(),e.TgZ(28,"span",30),e._uU(29),e.qZA(),e.qZA(),e.TgZ(30,"td"),e.TgZ(31,"span",29),e._uU(32,"Source"),e.qZA(),e.TgZ(33,"span",30),e._uU(34),e.qZA(),e.qZA(),e.TgZ(35,"td"),e.TgZ(36,"span",29),e._uU(37,"Quality"),e.qZA(),e.TgZ(38,"span",30),e._uU(39),e.qZA(),e.qZA(),e.TgZ(40,"td"),e.TgZ(41,"span",29),e._uU(42,"Codec"),e.qZA(),e.TgZ(43,"span",30),e._uU(44),e.qZA(),e.qZA(),e.TgZ(45,"td"),e.TgZ(46,"span",29),e._uU(47,"Group"),e.qZA(),e.TgZ(48,"span",30),e._uU(49),e.qZA(),e.qZA(),e.TgZ(50,"td"),e.TgZ(51,"span",29),e._uU(52,"Lang"),e.qZA(),e.TgZ(53,"span",30),e.TgZ(54,"span",33),e._uU(55),e.qZA(),e.qZA(),e.qZA(),e.TgZ(56,"td"),e.TgZ(57,"span",29),e._uU(58,"Time"),e.qZA(),e.TgZ(59,"span",30),e._uU(60),e.qZA(),e.qZA(),e.qZA()),2&n){const t=o.$implicit,i=e.oxw();e.xp6(6),e.Oqu(t.name),e.xp6(2),e.Q6J("ngIf",t.videoFilePath),e.xp6(1),e.Q6J("ngIf",t.videoFileName),e.xp6(5),e.Oqu(t.subtitle),e.xp6(5),e.Oqu(t.provider),e.xp6(5),e.Oqu(t.season),e.xp6(5),e.Oqu(t.episode),e.xp6(5),e.Oqu(i.displayUpperCase(t.source)),e.xp6(5),e.Oqu(i.displayUpperCase(t.quality)),e.xp6(5),e.Oqu(i.displayUpperCase(t.codec)),e.xp6(5),e.Oqu(i.displayUpperCase(t.releaseGroup)),e.xp6(6),e.Oqu(t.language),e.xp6(5),e.Oqu(t.timestampFormatted)}}const Se=function(){return{showAll:"All"}},Ue=function(n){return[5,10,25,50,n]};let Ie=(()=>{class n{constructor(t,i){this.itemService=t,this.messageService=i,this.loading=!1,this.globalFilterFields=["name","season","episode","source","quality","codec","releaseGroup","languages","timestamp"],this.tableStateKey="autosubliminal-home-downloaded-table"}ngOnInit(){this.buildSelectItems(),this.loadDownloadedItems()}buildSelectItems(){this.videoTypes=[],this.videoTypes.push({label:"All",value:null}),Object.values(f.Z).forEach(t=>this.videoTypes.push({label:q(t),value:t}))}loadDownloadedItems(){this.loading=!0,this.itemService.getDownloadedItems().subscribe(t=>{this.downloadedItems=t,this.loading=!1},()=>{this.loading=!1,this.messageService.showErrorMessage("Unable to get the downloaded items")})}sort(t){(0,I.S)(t)}displayUpperCase(t){return U(t,"N/A",!0)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b),e.Y36(w.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-home-downloaded"]],inputs:{downloadedItems:"downloadedItems"},decls:5,vars:14,consts:[["stateStorage","local","currentPageReportTemplate","{first} to {last} of {totalRecords}","styleClass","p-datatable-sm p-datatable-gridlines p-datatable-striped p-datatable-responsive-mode",3,"value","stateKey","loading","autoLayout","rowHover","paginator","rows","rowsPerPageOptions","showCurrentPageReport","globalFilterFields","customSort","sortFunction"],["downloadedTable",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"caption"],[1,"p-inputgroup","dropdown"],[1,"p-inputgroup-addon"],[3,"options","onChange"],[1,"ml-auto"],["matchMode","contains",3,"table","tableStateKey"],["pSortableColumn","name"],["field","name"],["pSortableColumn","season"],["field","season"],["pSortableColumn","episode"],["field","episode"],["pSortableColumn","source"],["field","source"],["pSortableColumn","quality"],["field","quality"],["pSortableColumn","codec"],["field","codec"],["pSortableColumn","releaseGroup"],["field","releaseGroup"],["pSortableColumn","languages"],["field","languages"],["pSortableColumn","timestamp"],["field","timestamp"],[1,"p-column-title"],[1,"p-column-data"],[4,"ngIf"],[1,"icon-dropdown-title"],[1,"p-tag","language"]],template:function(t,i){1&t&&(e.TgZ(0,"p-table",0,1),e.NdJ("sortFunction",function(a){return i.sort(a)}),e.YNc(2,we,7,3,"ng-template",2),e.YNc(3,Ae,37,0,"ng-template",3),e.YNc(4,xe,61,13,"ng-template",4),e.qZA()),2&t&&e.Q6J("value",i.downloadedItems)("stateKey",i.tableStateKey)("loading",i.loading)("autoLayout",!0)("rowHover",!0)("paginator",!0)("rows",10)("rowsPerPageOptions",e.VKq(12,Ue,e.DdM(11,Se)))("showCurrentPageReport",!0)("globalFilterFields",i.globalFilterFields)("customSort",!0)},directives:[m.iA,d.jx,y.Lt,H.l,m.lQ,m.fz,k.G,g.O5],styles:[".p-datatable-auto-layout>.p-datatable-wrapper{overflow-x:visible!important}"]}),n})(),Me=(()=>{class n{constructor(){this.total=0,this.totalEpisodes=0,this.totalMovies=0}ngOnInit(){}getTotals(t){this.total=t.total,this.totalEpisodes=t.totalEpisodes,this.totalMovies=t.totalMovies}getWantedHeader(){return`Wanted subtitles (${this.total}) - Episodes (${this.totalEpisodes}) - Movies (${this.totalMovies})`}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-home"]],decls:5,vars:1,consts:[[1,"container-lg"],["styleClass","mb-3",3,"header"],[3,"totals"],["header","Downloaded subtitles"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"p-panel",1),e.TgZ(2,"app-home-wanted",2),e.NdJ("totals",function(a){return i.getTotals(a)}),e.qZA(),e.qZA(),e.TgZ(3,"p-panel",3),e._UZ(4,"app-home-downloaded"),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("header",i.getWantedHeader()))},directives:[S.s,be,Ie],styles:[""]}),n})();var ye=l(9075),He=l(5102),ke=l(4250);function Ne(n,o){1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"th",25),e.TgZ(2,"span"),e._uU(3,"Score"),e._UZ(4,"p-sortIcon",26),e.qZA(),e.qZA(),e.TgZ(5,"th",27),e.TgZ(6,"span"),e._uU(7,"Provider"),e._UZ(8,"p-sortIcon",28),e.qZA(),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Preview"),e.qZA(),e._UZ(11,"th"),e._UZ(12,"th"),e._UZ(13,"th"),e._UZ(14,"th"),e._UZ(15,"th"),e.qZA())}function Fe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a",51),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw(2).showScoreDetails(s)}),e._UZ(1,"i",52),e.qZA()}}function $e(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a",51),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw(2).showScoreDetails(s)}),e._UZ(1,"i",53),e.qZA()}}function Je(n,o){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function We(n,o){1&n&&e._UZ(0,"i",54)}function Pe(n,o){1&n&&e._UZ(0,"i",55)}const Oe=function(n){return{disabled:n}};function Ee(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"span",29),e._uU(3,"Score"),e.qZA(),e.TgZ(4,"span",30),e.TgZ(5,"span"),e._uU(6),e.qZA(),e.YNc(7,Fe,2,0,"a",31),e.YNc(8,$e,2,0,"a",31),e.qZA(),e.qZA(),e.TgZ(9,"td"),e.TgZ(10,"span",29),e._uU(11,"Provider"),e.qZA(),e.TgZ(12,"span",30),e.TgZ(13,"span",32),e.TgZ(14,"span",33),e._uU(15),e.qZA(),e.TgZ(16,"ul",34),e.YNc(17,Je,2,1,"li",35),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"td"),e.TgZ(19,"span",29),e._uU(20,"Preview"),e.qZA(),e.TgZ(21,"div",36),e.TgZ(22,"a",37),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).showSubtitlePreview(a)}),e._UZ(23,"i",38),e.qZA(),e._UZ(24,"div",39),e.qZA(),e.qZA(),e.TgZ(25,"td",40),e.TgZ(26,"span",29),e._uU(27,"Visit website"),e.qZA(),e.TgZ(28,"span",30),e.TgZ(29,"a",41),e._UZ(30,"i",42),e.qZA(),e.qZA(),e.qZA(),e.TgZ(31,"td",40),e.TgZ(32,"span",29),e._uU(33,"Save subtitle"),e.qZA(),e.TgZ(34,"span",30),e.TgZ(35,"a",43),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).saveSubtitle(a)}),e.YNc(36,We,1,0,"i",44),e.YNc(37,Pe,1,0,"i",45),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"td",40),e.TgZ(39,"span",29),e._uU(40,"Delete subtitle"),e.qZA(),e.TgZ(41,"span",30),e.TgZ(42,"a",43),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).deleteSubtitle()}),e._UZ(43,"i",46),e.qZA(),e.qZA(),e.qZA(),e.TgZ(44,"td",40),e.TgZ(45,"span",29),e._uU(46,"Play video"),e.qZA(),e.TgZ(47,"span",30),e.TgZ(48,"a",47),e._UZ(49,"i",48),e.qZA(),e.qZA(),e.qZA(),e.TgZ(50,"td",40),e.TgZ(51,"span",29),e._uU(52,"Post process"),e.qZA(),e.TgZ(53,"span",30),e.TgZ(54,"a",49),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).postProcess(a)}),e._UZ(55,"i",50),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(6),e.Oqu(t.score),e.xp6(1),e.Q6J("ngIf",t.score<i.scores.min),e.xp6(1),e.Q6J("ngIf",t.score>=i.scores.min),e.xp6(7),e.hij(" ",t.providerName," "),e.xp6(2),e.Q6J("ngForOf",t.releases),e.xp6(7),e.Q6J("innerHTML",t.contentPreview,e.oJD),e.xp6(5),e.Q6J("href",i.getWebsiteUrl(t),e.LSH),e.xp6(7),e.Q6J("ngIf",t!==i.savedSubtitle),e.xp6(1),e.Q6J("ngIf",t===i.savedSubtitle),e.xp6(11),e.Q6J("href",i.getPlayVideoUrl(),e.LSH),e.xp6(6),e.Q6J("ngClass",e.VKq(11,Oe,!i.savedSubtitle))}}function Qe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-panel"),e.TgZ(1,"p-header",8),e.TgZ(2,"div",9),e._uU(3,"Manual search for subtitles"),e.qZA(),e.TgZ(4,"div"),e.TgZ(5,"p-button",10),e.NdJ("onClick",function(){return e.CHM(t),e.oxw().searchSubtitles()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"app-message",7),e._UZ(7,"i",11),e.TgZ(8,"span"),e._uU(9,"Searching subtitles..."),e.qZA(),e.qZA(),e.TgZ(10,"div",12),e.TgZ(11,"div",13),e._uU(12,"Wanted item"),e.qZA(),e.TgZ(13,"div",14),e.TgZ(14,"div",15),e.TgZ(15,"div",16),e.TgZ(16,"span",17),e._uU(17,"File name:"),e.qZA(),e.qZA(),e.TgZ(18,"div",18),e.TgZ(19,"span",19),e._uU(20),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",15),e.TgZ(22,"div",16),e.TgZ(23,"span",17),e._uU(24,"File path:"),e.qZA(),e.qZA(),e.TgZ(25,"div",18),e.TgZ(26,"span",19),e._uU(27),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"div",15),e.TgZ(29,"div",16),e.TgZ(30,"span",17),e._uU(31,"Language:"),e.qZA(),e.qZA(),e.TgZ(32,"div",18),e.TgZ(33,"span",20),e._uU(34),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(35,"div",12),e.TgZ(36,"div",13),e._uU(37),e.qZA(),e.TgZ(38,"p-table",21),e.YNc(39,Ne,16,0,"ng-template",22),e.YNc(40,Ee,56,13,"ng-template",23),e.qZA(),e.qZA(),e.TgZ(41,"p-footer"),e.TgZ(42,"div"),e.TgZ(43,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw().goHome()}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("disabled",t.searchInProgress),e.xp6(1),e.Q6J("visible",t.searchInProgress),e.xp6(14),e.Oqu(t.wantedItem.videoFileName),e.xp6(7),e.Oqu(t.wantedItem.videoFilePath),e.xp6(7),e.Oqu(t.language),e.xp6(3),e.hij("Subtitles\xa0(",t.subtitles.length,")"),e.xp6(1),e.Q6J("value",t.subtitles)("loading",t.searchInProgress)("autoLayout",!0)("rowHover",!0)}}function Ye(n,o){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function De(n,o){1&n&&e._UZ(0,"i",59)}function Re(n,o){1&n&&e._UZ(0,"i",60)}function Le(n,o){if(1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"div"),e._uU(2,"Matches:"),e.qZA(),e.TgZ(3,"ul"),e.YNc(4,Ye,2,1,"li",35),e.qZA(),e.TgZ(5,"div"),e._UZ(6,"i",56),e._uU(7),e.YNc(8,De,1,0,"i",57),e.YNc(9,Re,1,0,"i",58),e.qZA(),e._UZ(10,"br"),e.TgZ(11,"div"),e._uU(12),e.qZA(),e.TgZ(13,"div"),e._uU(14),e.qZA(),e.TgZ(15,"div"),e._uU(16),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.getScoreMatches()),e.xp6(3),e.hij(" Calculated score: ",t.score," "),e.xp6(1),e.Q6J("ngIf",t.score<t.scores.min),e.xp6(1),e.Q6J("ngIf",t.score>=t.scores.min),e.xp6(3),e.hij("Minimum required default score: ",t.scores.default,""),e.xp6(2),e.hij("Minimum required configured score: ",t.scores.min,""),e.xp6(2),e.hij("Maximum score: ",t.scores.max,"")}}const Ge=[{path:"",component:Me},{path:"search",component:(()=>{class n{constructor(t,i,s,a,r){this.route=t,this.router=i,this.domSanitizer=s,this.itemService=a,this.messageService=r,this.subtitles=[],this.searchInProgress=!1,this.postProcessInProgress=!1,this.showScoreDetailsDialog=!1,this.showSubtitlePreviewDialog=!1}ngOnInit(){this.route.queryParamMap.subscribe(t=>{const i=C(t.get("wantedItemId"));this.language=t.get("language"),this.itemService.getWantedItem(i).subscribe(s=>{this.wantedItem=s,this.scores=this.wantedItem.isEpisode?_.$0.episodeScores:_.$0.movieScores,this.searchSubtitles()},()=>this.messageService.showErrorMessage(`Unable to get the wanted item with id ${i}`))})}searchSubtitles(){this.searchInProgress=!0,this.subtitles=[],this.itemService.searchWantedItemSubtitles(this.wantedItem.id,this.language).subscribe(t=>{this.subtitles=t,this.searchInProgress=!1,this.messageService.showInfoMessage(`${this.subtitles.length} subtitles found.`)},()=>{this.searchInProgress=!1,this.messageService.showErrorMessage("Unable to search subtitles!")})}showScoreDetails(t){this.score=t.score,this.matches=t.matches,this.showScoreDetailsDialog=!0}getScoreMatches(){const t=[];return this.matches.includes("hash")&&t.push(`Hash: ${this.scores.hash}`),this.matches.includes("title")&&t.push(`Title: ${this.scores.title}`),this.matches.includes("year")&&t.push(`Year: ${this.scores.year}`),this.wantedItem.isEpisode&&(this.matches.includes("season")&&t.push(`Season: ${this.scores.season}`),this.matches.includes("episode")&&t.push(`Episode: ${this.scores.episode}`)),this.matches.includes("source")&&t.push(`Source: ${this.scores.source}`),this.matches.includes("resolution")&&t.push(`Quality: ${this.scores.quality}`),this.matches.includes("video_codec")&&t.push(`Codec: ${this.scores.codec}`),this.matches.includes("release_group")&&t.push(`Release group: ${this.scores.releaseGroup}`),this.matches.includes("hearing_impaired")&&t.push(`Hearing impaired: ${this.scores.hearingImpaired}`),t}showSubtitlePreview(t){this.subtitlePreview=t.contentPreview,this.showSubtitlePreviewDialog=!0}getWebsiteUrl(t){return(0,T.tF)(t.pageLink)}saveSubtitle(t){this.itemService.saveWantedItemSubtitle(this.wantedItem.id,t.subtitleIndex).subscribe(()=>{this.savedSubtitle=t,this.messageService.showInfoMessage("Subtitles saved.")},()=>this.messageService.showErrorMessage("Unable to save the subtitle!"))}deleteSubtitle(){this.itemService.deleteWantedItemSubtitle(this.wantedItem.id).subscribe(()=>{this.savedSubtitle=null,this.messageService.showInfoMessage("Subtitles deleted.")},()=>this.messageService.showErrorMessage("Unable to delete the subtitle!"))}getPlayVideoUrl(){return this.domSanitizer.bypassSecurityTrustResourceUrl((0,T.TZ)(this.wantedItem.videoFilePath,this.wantedItem.videoFileName))}postProcess(t){this.postProcessInProgress=!0,this.itemService.postProcessWantedItem(this.wantedItem.id,t.subtitleIndex).subscribe(()=>{this.postProcessInProgress=!1,this.messageService.showSuccessMessage(`Post processed ${this.wantedItem.longName}.`),this.goHome()},()=>{this.postProcessInProgress=!1,this.messageService.showErrorMessage(`Unable to post process ${this.wantedItem.longName}!`)})}goHome(){this.router.navigateByUrl("/home")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Z.gz),e.Y36(Z.F0),e.Y36(ye.H7),e.Y36(b),e.Y36(w.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-home-search"]],decls:8,vars:12,consts:[[1,"container-lg"],[4,"ngIf"],["header","Subtitle preview",3,"visible","modal","closable","resizable","visibleChange"],[1,"dialog-content"],[3,"innerHTML"],["header","Score details",3,"visible","modal","closable","resizable","visibleChange"],["class","dialog-content",4,"ngIf"],[3,"visible"],[1,"w-100"],[1,"p-panel-title"],["label","Search","icon","pi pi-refresh","styleClass","p-button-outlined",3,"disabled","onClick"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin","mr-2"],[1,"panel-section"],[1,"panel-section-header"],[1,"wanted-item-container"],[1,"row"],[1,"col-12","col-sm-12","col-md-2","col-lg-2"],[1,"wanted-item-label"],[1,"col-12","col-sm-12","col-md-10","col-lg-10"],[1,"wanted-item-value"],[1,"p-tag","language"],["styleClass","p-datatable-sm p-datatable-gridlines p-datatable-striped p-datatable-responsive-mode",3,"value","loading","autoLayout","rowHover"],["pTemplate","header"],["pTemplate","body"],["type","button","pButton","","icon","pi pi-chevron-left","label","Return",3,"click"],["pSortableColumn","score"],["field","score"],["pSortableColumn","providerName"],["field","providerName"],[1,"p-column-title"],[1,"p-column-data"],["class","icon-link ml-1",3,"click",4,"ngIf"],[1,"dropdown"],["data-toggle","dropdown","data-display","static","aria-haspopup","true","aria-expanded","false","title","Click to show releases",1,"dropdown-toggle","has-tip","icon-link"],[1,"dropdown-menu","has-tip"],[4,"ngFor","ngForOf"],[1,"p-column-data","subtitle-preview"],[1,"icon-link","subtitle-preview-icon",3,"click"],["aria-hidden","true","title","Click to show preview",1,"fa","fa-search-plus"],[1,"subtitle-preview-content",3,"innerHTML"],[1,"subtitle-action"],["target","_blank",1,"icon-link",3,"href"],["aria-hidden","true","title","Click to visit website",1,"fa","fa-external-link"],[1,"icon-link",3,"click"],["class","fa fa-floppy-o","aria-hidden","true","title","Click to save subtitle",4,"ngIf"],["class","fa fa-check-circle-o text-success","aria-hidden","true","title","Subtitle saved",4,"ngIf"],["aria-hidden","true","title","Click to delete subtitle",1,"fa","fa-times"],[1,"icon-link",3,"href"],["aria-hidden","true","title","Click to play video",1,"fa","fa-play-circle-o"],[1,"icon-link",3,"ngClass","click"],["aria-hidden","true","title","Click to execute post processing",1,"fa","fa-refresh"],[1,"icon-link","ml-1",3,"click"],["aria-hidden","true","title","Click to show score details",1,"fa","fa-times-circle","text-warning"],["aria-hidden","true","title","Click to show score details",1,"fa","fa-check-circle","text-success"],["aria-hidden","true","title","Click to save subtitle",1,"fa","fa-floppy-o"],["aria-hidden","true","title","Subtitle saved",1,"fa","fa-check-circle-o","text-success"],["aria-hidden","true",1,"fa","fa-arrow-right"],["class","fa fa-times-circle text-warning","aria-hidden","true","title","Below minimum required configured score",4,"ngIf"],["class","fa fa-check-circle text-success","aria-hidden","true","title","Equal or more than minimum required configured score",4,"ngIf"],["aria-hidden","true","title","Below minimum required configured score",1,"fa","fa-times-circle","text-warning"],["aria-hidden","true","title","Equal or more than minimum required configured score",1,"fa","fa-check-circle","text-success"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Qe,44,10,"p-panel",1),e.qZA(),e.TgZ(2,"p-dialog",2),e.NdJ("visibleChange",function(a){return i.showSubtitlePreviewDialog=a}),e.TgZ(3,"div",3),e._UZ(4,"div",4),e.qZA(),e.qZA(),e.TgZ(5,"p-dialog",5),e.NdJ("visibleChange",function(a){return i.showScoreDetailsDialog=a}),e.YNc(6,Le,17,7,"div",6),e.qZA(),e._UZ(7,"app-loading",7)),2&t&&(e.xp6(1),e.Q6J("ngIf",i.wantedItem),e.xp6(1),e.Q6J("visible",i.showSubtitlePreviewDialog)("modal",!0)("closable",!0)("resizable",!1),e.xp6(2),e.Q6J("innerHTML",i.subtitlePreview,e.oJD),e.xp6(1),e.Q6J("visible",i.showScoreDetailsDialog)("modal",!0)("closable",!0)("resizable",!1),e.xp6(1),e.Q6J("ngIf",i.matches),e.xp6(1),e.Q6J("visible",i.postProcessInProgress))},directives:[g.O5,N.V,He.N,S.s,d.h4,A.zx,ke.q,m.iA,d.jx,d.$_,A.Hq,m.lQ,m.fz,g.sg,g.mk],styles:[".wanted-item-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:.5rem}.dropdown[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{white-space:nowrap;margin-top:.5rem;padding:.5rem}.subtitle-preview[_ngcontent-%COMP%]{position:relative}.subtitle-preview[_ngcontent-%COMP%]   .subtitle-preview-icon[_ngcontent-%COMP%]{position:absolute;top:0rem;right:2rem}.subtitle-preview[_ngcontent-%COMP%]   .subtitle-preview-content[_ngcontent-%COMP%]{height:6.25rem;overflow-y:scroll;word-break:normal;white-space:nowrap}.subtitle-action[_ngcontent-%COMP%]{text-align:center!important}@media screen and (max-width: 767px){.subtitle-action[_ngcontent-%COMP%]{text-align:left!important}}.subtitle-action[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{pointer-events:none;-moz-filter:brightness(50%);-o-filter:brightness(50%);filter:brightness(50%)}  .p-datatable-auto-layout>.p-datatable-wrapper{overflow-x:visible!important}"]}),n})()},{path:"**",redirectTo:""}];let ze=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[Z.Bz.forChild(Ge)],Z.Bz]}),n})(),Ve=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[F.m,ze]]}),n})()}}]);