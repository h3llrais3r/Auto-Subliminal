"use strict";(self.webpackChunkautosubliminal=self.webpackChunkautosubliminal||[]).push([[985],{4985:(ot,I,r)=>{r.r(I),r.d(I,{LibraryModule:()=>at});var V=r(3082),g=r(4157),x=r(6716),d=r(3695),e=r(639),P=r(9075),A=r(6503),Z=r(6675),D=r(4873),m=r(1245),v=r(3013),_=r(4020),u=r(1131),$=r(5e3),w=r(8317),q=r(4250);let b=(()=>{class i{constructor(t,a){this.systemService=t,this.systemEventService=a,this.scanningInProgress=!1}ngOnInit(){this.systemService.getScheduler(u.$0.scanLibrary).subscribe(t=>{this.scanningInProgress=t.running}),this.systemEventService.schedulerStart.subscribe(t=>{this.scanningInProgress=t.name===u.$0.scanLibrary||this.scanningInProgress}),this.systemEventService.schedulerFinish.subscribe(t=>{this.scanningInProgress=t.name!==u.$0.scanLibrary&&this.scanningInProgress})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36($.o),e.Y36(w.h))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-library-scanning"]],decls:4,vars:1,consts:[[3,"visible"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin","mr-2"]],template:function(t,a){1&t&&(e.TgZ(0,"app-message",0),e._UZ(1,"i",1),e.TgZ(2,"span"),e._uU(3,"Scanning library..."),e.qZA(),e.qZA()),2&t&&e.Q6J("visible",a.scanningInProgress)},directives:[q.q],styles:[""]}),i})();var l=r(8583),J=r(3473),T=r(8604);let f=(()=>{class i{constructor(){this.value=0,this.total=100,this.showPercentage=!1}get percentage(){return Math.round(this.value/this.total*100)}getText(){return this.showPercentage?`${this.percentage}%`:`${this.value} of ${this.total}`}getStyleClass(){return"progress-"+5*Math.floor(this.percentage/5)}getWidth(){return`${this.percentage}%`}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-progress-bar"]],inputs:{value:"value",total:"total",showPercentage:"showPercentage"},decls:4,vars:5,consts:[[1,"progress-bar-container"],[1,"progress-bar-text"],[1,"progress-bar-progress"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._uU(2),e.qZA(),e._UZ(3,"div",2),e.qZA()),2&t&&(e.xp6(2),e.Oqu(a.getText()),e.xp6(1),e.Tol(a.getStyleClass()),e.Udp("width",a.getWidth()))},styles:[".progress-bar-container[_ngcontent-%COMP%]{position:relative;width:100%;background-color:#f4f4f4;border:1px solid var(--surface-d);border-radius:.25rem;color:#fff}.progress-bar-container[_ngcontent-%COMP%]   .progress-bar-text[_ngcontent-%COMP%]{position:absolute;left:0;right:0;color:#000;text-align:center;font-size:.875rem;margin:.0625rem}.progress-bar-container[_ngcontent-%COMP%]   .progress-bar-progress[_ngcontent-%COMP%]{min-width:15%;min-height:1.5rem;white-space:nowrap;overflow:hidden;border-radius:.125rem 0 0 .125rem}.progress-0[_ngcontent-%COMP%]{background:linear-gradient(#640000,#c80200);background:-o-linear-gradient(#640000,#c80200)}.progress-5[_ngcontent-%COMP%]{background:linear-gradient(#c80200,#ff1c00);background:-o-linear-gradient(#c80200,#ff1c00)}.progress-10[_ngcontent-%COMP%]{background:linear-gradient(#ff1c00,#ff3500);background:-o-linear-gradient(#ff1c00,#ff3500)}.progress-15[_ngcontent-%COMP%]{background:linear-gradient(#ff3500,#ff4e00);background:-o-linear-gradient(#ff3500,#ff4e00)}.progress-20[_ngcontent-%COMP%]{background:linear-gradient(#ff4e00,#ff6700);background:-o-linear-gradient(#ff4e00,#ff6700)}.progress-25[_ngcontent-%COMP%]{background:linear-gradient(#ff6700,#ff8100);background:-o-linear-gradient(#ff6700,#ff8100)}.progress-30[_ngcontent-%COMP%]{background:linear-gradient(#ff8100,#ff9a00);background:-o-linear-gradient(#ff8100,#ff9a00)}.progress-35[_ngcontent-%COMP%]{background:linear-gradient(#ff9a00,#ffb300);background:-o-linear-gradient(#ff9a00,#ffb300)}.progress-40[_ngcontent-%COMP%]{background:linear-gradient(#ffb300,#ffcc00);background:-o-linear-gradient(#ffb300,#ffcc00)}.progress-45[_ngcontent-%COMP%]{background:linear-gradient(#ffcc00,#ffe600);background:-o-linear-gradient(#ffcc00,#ffe600)}.progress-50[_ngcontent-%COMP%]{background:linear-gradient(#ffe600,yellow);background:-o-linear-gradient(#ffe600,yellow)}.progress-55[_ngcontent-%COMP%]{background:linear-gradient(yellow,#e6ff00);background:-o-linear-gradient(yellow,#e6ff00)}.progress-60[_ngcontent-%COMP%]{background:linear-gradient(#e6ff00,#ccff00);background:-o-linear-gradient(#e6ff00,#ccff00)}.progress-65[_ngcontent-%COMP%]{background:linear-gradient(#ccff00,#b3ff00);background:-o-linear-gradient(#ccff00,#b3ff00)}.progress-70[_ngcontent-%COMP%]{background:linear-gradient(#b3ff00,#9aff00);background:-o-linear-gradient(#b3ff00,#9aff00)}.progress-75[_ngcontent-%COMP%]{background:linear-gradient(#9aff00,#81ff00);background:-o-linear-gradient(#9aff00,#81ff00)}.progress-80[_ngcontent-%COMP%]{background:linear-gradient(#81ff00,#67ff00);background:-o-linear-gradient(#81ff00,#67ff00)}.progress-85[_ngcontent-%COMP%]{background:linear-gradient(#67ff00,#4eff00);background:-o-linear-gradient(#67ff00,#4eff00)}.progress-90[_ngcontent-%COMP%]{background:linear-gradient(#4eff00,#35ff00);background:-o-linear-gradient(#4eff00,#35ff00)}.progress-95[_ngcontent-%COMP%]{background:linear-gradient(#35ff00,#1cff00);background:-o-linear-gradient(#35ff00,#1cff00)}.progress-100[_ngcontent-%COMP%]{background:linear-gradient(#02c800,#029600);background:-o-linear-gradient(#02c800,#029600)}"]}),i})();var c=r(3380),z=r(2735),y=r(2571),h=r(3679),E=r(5121),H=r(1e3),S=r(4207);function K(i,o){if(1&i&&(e.TgZ(0,"form",3),e.TgZ(1,"div",4),e.TgZ(2,"div",5),e._uU(3,"Select the embedded hardcoded subtitle languages for video file:"),e.qZA(),e.TgZ(4,"div",6),e._uU(5),e.qZA(),e.qZA(),e.TgZ(6,"div",4),e.TgZ(7,"div",5),e._UZ(8,"app-input-multi-select",7),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.Q6J("formGroup",t.videoSubtitlesForm),e.xp6(5),e.Oqu(t.videoSubtitles.fileName),e.xp6(3),e.Q6J("options",t.languages)}}function j(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"p-button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e.qZA(),e.TgZ(1,"p-button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveVideoSubtitles()}),e.qZA()}}let F=(()=>{class i{constructor(t){this.fb=t,this.visible=!1,this.visibleChange=new e.vpe,this.save=new e.vpe}ngOnInit(){this.languages=y.h.languageSelectItems(),this.buildForm()}buildForm(){this.videoSubtitlesForm=this.fb.group({fileLocation:[this.videoSubtitles.fileLocation,[]],fileName:[this.videoSubtitles.fileName,[]],languages:[this.videoSubtitles.languages||[],[]]})}close(){this.visibleChange.emit(!1)}saveVideoSubtitles(){const t=new x.A;t.fileLocation=y.h.getFormControlValue(this.videoSubtitlesForm,"fileLocation"),t.fileName=y.h.getFormControlValue(this.videoSubtitlesForm,"fileName"),t.languages=y.h.getFormControlValue(this.videoSubtitlesForm,"languages"),this.save.emit(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(h.qu))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-library-video-subtitles"]],inputs:{visible:"visible",videoSubtitles:"videoSubtitles"},outputs:{visibleChange:"visibleChange",save:"save"},decls:3,vars:5,consts:[["header","Hardcoded/embedded video subtitles","styleClass","p-dialog-video-subtitles",3,"visible","modal","closable","resizable","visibleChange"],["class","form",3,"formGroup",4,"ngIf"],["pTemplate","footer"],[1,"form",3,"formGroup"],[1,"row","form-row"],[1,"col-12"],[1,"col-12","file"],["formControlName","languages","placeholder","Select languages",3,"options"],["icon","pi pi-times","label","Cancel","styleClass","p-button p-button-secondary",3,"click"],["icon","pi pi-check","label","Save","styleClass","p-button mr-0",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"p-dialog",0),e.NdJ("visibleChange",function(s){return a.visible=s}),e.YNc(1,K,9,3,"form",1),e.YNc(2,j,2,0,"ng-template",2),e.qZA()),2&t&&(e.Q6J("visible",a.visible)("modal",!0)("closable",!1)("resizable",!1),e.xp6(1),e.Q6J("ngIf",a.videoSubtitlesForm))},directives:[E.V,l.O5,v.jx,h._Y,h.JL,h.sg,H.K,h.JJ,h.u,S.zx],styles:[".p-dialog-video-subtitles{width:500px}.file[_ngcontent-%COMP%]{font-weight:500;font-style:italic}"]}),i})();function W(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"a",20),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addMoviePathToVideoPaths()}),e._UZ(1,"i",38),e.qZA()}}function B(i,o){if(1&i&&(e.TgZ(0,"span",39),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function R(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"a",20),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,s=e.oxw(2);return s.openVideoSubtitlesDialog(s.movie.path,n.filename,n.hardcodedLanguages)}),e._UZ(1,"i",43),e.qZA()}}function X(i,o){if(1&i&&(e.TgZ(0,"a",44),e._UZ(1,"i",45),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.Q6J("href",a.getPlayVideoUrl(a.movie.path,t.filename),e.LSH)}}function G(i,o){if(1&i&&(e.TgZ(0,"span",50),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function ee(i,o){if(1&i&&(e.TgZ(0,"span",50),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function te(i,o){1&i&&(e.TgZ(0,"span",50),e._uU(1,"internal"),e.qZA())}function ie(i,o){if(1&i&&(e.TgZ(0,"td",46),e.YNc(1,G,2,1,"span",47),e.YNc(2,ee,2,1,"span",47),e.YNc(3,te,2,0,"span",48),e.TgZ(4,"span",49),e._uU(5),e.qZA(),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.hardcodedLanguages),e.xp6(1),e.Q6J("ngForOf",t.embeddedLanguages),e.xp6(1),e.Q6J("ngIf",t.internalLanguagesAvailable),e.xp6(2),e.Oqu(t.type)}}function ae(i,o){if(1&i&&(e.TgZ(0,"span",50),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(t.language)}}function oe(i,o){if(1&i&&(e.TgZ(0,"td",46),e.YNc(1,ae,2,1,"span",48),e.TgZ(2,"span",49),e._uU(3),e.qZA(),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.language),e.xp6(2),e.Oqu(t.type)}}function ne(i,o){if(1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"td",40),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"span",17),e.YNc(5,R,2,0,"a",28),e.YNc(6,X,2,1,"a",41),e.qZA(),e.qZA(),e.YNc(7,ie,6,4,"td",42),e.YNc(8,oe,4,2,"td",42),e.qZA()),2&i){const t=o.$implicit;e.xp6(3),e.Oqu(t.filename),e.xp6(2),e.Q6J("ngIf",t.isVideo),e.xp6(1),e.Q6J("ngIf",t.isVideo),e.xp6(1),e.Q6J("ngIf",t.isVideo),e.xp6(1),e.Q6J("ngIf",t.isSubtitle)}}function se(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"div",9),e.TgZ(2,"div",10),e.TgZ(3,"div",11),e.TgZ(4,"a",12),e._UZ(5,"img",13),e.qZA(),e.qZA(),e.TgZ(6,"div",14),e.TgZ(7,"div",15),e.TgZ(8,"div",16),e.TgZ(9,"span"),e._uU(10),e.qZA(),e.TgZ(11,"span",17),e.TgZ(12,"a",18),e._UZ(13,"i",19),e.qZA(),e.TgZ(14,"a",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().openSettingsDialog()}),e._UZ(15,"i",21),e.qZA(),e.TgZ(16,"a",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().refreshMovieDetails()}),e._UZ(17,"i",22),e.qZA(),e.TgZ(18,"a",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().openDeleteDialog()}),e._UZ(19,"i",23),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"div",15),e.TgZ(21,"div",24),e._UZ(22,"hr"),e.qZA(),e.qZA(),e.TgZ(23,"div",9),e.TgZ(24,"div",24),e._uU(25),e.qZA(),e.qZA(),e.TgZ(26,"div",25),e.TgZ(27,"div",26),e._uU(28,"Location:"),e.qZA(),e.TgZ(29,"div",27),e._uU(30),e.YNc(31,W,2,0,"a",28),e.qZA(),e.qZA(),e.TgZ(32,"div",25),e.TgZ(33,"div",26),e._uU(34,"Wanted languages:"),e.qZA(),e.TgZ(35,"div",29),e.YNc(36,B,2,1,"span",30),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"div",9),e.TgZ(38,"div",24),e._UZ(39,"hr"),e.TgZ(40,"div",31),e.TgZ(41,"span",32),e._uU(42,"Files"),e.qZA(),e.TgZ(43,"span",33),e._UZ(44,"app-progress-bar",34),e.qZA(),e.qZA(),e._UZ(45,"hr"),e.qZA(),e.qZA(),e.TgZ(46,"div",9),e.TgZ(47,"div",35),e.TgZ(48,"p-table",36),e.YNc(49,ne,9,5,"ng-template",37),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.Q6J("href",t.getMoviePosterFullSizeUrl(),e.LSH),e.xp6(1),e.Q6J("lazyLoad",t.getMoviePosterThumbnailUrl())("defaultImage",t.getPosterPlaceholderUrl()),e.xp6(5),e.Oqu(t.movie.name),e.xp6(2),e.Q6J("href",t.getImdbUrl(),e.LSH),e.xp6(13),e.Oqu(t.movie.overview),e.xp6(5),e.hij(" ",t.movie.path," "),e.xp6(1),e.Q6J("ngIf",!t.movie.pathInVideoPaths),e.xp6(5),e.Q6J("ngForOf",t.movie.settings.wantedLanguages),e.xp6(8),e.Q6J("value",t.movie.totalSubtitlesAvailable)("total",t.movie.totalSubtitlesWanted),e.xp6(4),e.Q6J("value",t.movie.files)("autoLayout",!0)}}function re(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"app-movie-settings",51),e.NdJ("visibleChange",function(n){return e.CHM(t),e.oxw().showMovieSettings=n}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("visible",t.showMovieSettings)("imdbId",t.movie.imdbId)("title",t.movie.name)("movieSettings",t.movie.settings)}}function le(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"app-library-video-subtitles",52),e.NdJ("visibleChange",function(n){return e.CHM(t),e.oxw().showVideoSubtitles=n})("save",function(n){return e.CHM(t),e.oxw().saveHardcodedSubtitles(n)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("visible",t.showVideoSubtitles)("videoSubtitles",t.videoSubtitles)}}let ge=(()=>{class i{constructor(t,a,n,s,p,L,O,M){this.route=t,this.router=a,this.domSanitizer=n,this.movieService=s,this.artworkService=p,this.settingsService=L,this.messageService=O,this.confirmationService=M,this.loading=!1,this.refreshInProgress=!1,this.showMovieSettings=!1,this.showVideoSubtitles=!1}ngOnInit(){this.route.paramMap.subscribe(t=>{this.loading=!0;const a=t.get("imdbId");this.getMovieDetails(a)})}getMoviePosterFullSizeUrl(){return this.artworkService.getMoviePosterFullSizeUrl(this.movie.imdbId)}getMoviePosterThumbnailUrl(){return this.artworkService.getMoviePosterThumbnailUrl(this.movie.imdbId)}getPosterPlaceholderUrl(){return(0,d.WF)()}getImdbUrl(){return(0,d.$X)(this.movie.imdbId)}getPlayVideoUrl(t,a){return this.domSanitizer.bypassSecurityTrustResourceUrl((0,d.TZ)(t,a))}openSettingsDialog(){this.showMovieSettings=!0}refreshMovieDetails(){this.refreshInProgress=!0,this.movieService.refreshMovieDetails(this.movie.imdbId).subscribe(()=>{this.getMovieDetails(this.movie.imdbId),this.refreshInProgress=!1},()=>this.messageService.showErrorMessage("Unable to refresh the movie details!"))}openDeleteDialog(){this.confirmationService.confirm({message:`Are you sure that you want to delete <b>${this.movie.name}</b>?`,accept:()=>{this.movieService.deleteMovie(this.movie.imdbId).subscribe(()=>{this.router.navigateByUrl("/library/movie")},()=>this.messageService.showErrorMessage(`Unable to delete the movie ${this.movie.name}!`))}})}addMoviePathToVideoPaths(){this.settingsService.updateGeneralSetting("videoPaths",{videoPath:this.movie.path}).subscribe(()=>{this.messageService.showSuccessMessage(`Path ${this.movie.path} added to the video paths.`),this.getMovieDetails(this.movie.imdbId)},a=>{a.status&&409===a.status?this.messageService.showInfoMessage(`Path ${this.movie.path} already added to the video paths.`):this.messageService.showErrorMessage(`Unable to add path ${this.movie.path} to the video paths!`)})}openVideoSubtitlesDialog(t,a,n){this.videoSubtitles=new x.A,this.videoSubtitles.fileLocation=t,this.videoSubtitles.fileName=a,this.videoSubtitles.languages=n,this.showVideoSubtitles=!0}closeVideoSubtitlesDialog(){this.showVideoSubtitles=!1,this.videoSubtitles=null}saveHardcodedSubtitles(t){this.movieService.saveMovieHardcodedSubtitles(this.movie.imdbId,t).subscribe(()=>{this.closeVideoSubtitlesDialog(),this.getMovieDetails(this.movie.imdbId)},()=>this.messageService.showErrorMessage("Unable to save the hardcoded subtitles!"))}getMovieDetails(t){this.movieService.getMovieDetails(t).subscribe(a=>{this.movie=a,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the movie details!"))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.gz),e.Y36(g.F0),e.Y36(P.H7),e.Y36(A.u),e.Y36(Z.O),e.Y36(D.g),e.Y36(m.e),e.Y36(v.YP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-library-movie-detail"]],decls:11,vars:4,consts:[[1,"container-lg"],["header","Movie details"],[3,"visible"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin","mr-2"],["class","library-details-container",4,"ngIf"],["header","Confirmation","icon","pi pi-exclamation-triangle"],[3,"visible","imdbId","title","movieSettings","visibleChange",4,"ngIf"],[3,"visible","videoSubtitles","visibleChange","save",4,"ngIf"],[1,"library-details-container"],[1,"row","mb-3"],[1,"col-12","library-details-info-container"],[1,"library-details-info-poster"],["target","_blank",3,"href"],["title","Click to view full size",1,"library-details-info-poster-image",3,"lazyLoad","defaultImage"],[1,"library-details-info"],[1,"row"],[1,"col-12","library-details-info-title"],[1,"icon-group"],["target","_blank",1,"icon-link",3,"href"],["aria-hidden","true","title","Click to visit Imdb",1,"fa","fa-imdb"],[1,"icon-link",3,"click"],["aria-hidden","true","title","Click to edit movie settings",1,"fa","fa-wrench"],["aria-hidden","true","title","Click to refresh movie details",1,"fa","fa-repeat"],["aria-hidden","true","title","Click to delete movie from the database",1,"fa","fa-trash"],[1,"col-12"],[1,"row","mb-2"],[1,"col-3"],[1,"col-9","wrap-text"],["class","icon-link",3,"click",4,"ngIf"],[1,"col-9"],["class","p-tag language mr-2",4,"ngFor","ngForOf"],[1,"library-details-files-summary"],[1,"summary-title"],[1,"summary-progress-bar","ml-auto"],[3,"value","total"],[1,"col-12","library-details-files"],["styleClass","p-datatable-sm",3,"value","autoLayout"],["pTemplate","body"],["aria-hidden","true","title","Click to add the movie path to the video paths to scan",1,"fa","fa-plus"],[1,"p-tag","language","mr-2"],[1,"wrap-text"],["class","icon-link",3,"href",4,"ngIf"],["class","text-right",4,"ngIf"],["aria-hidden","true","title","Click to save hardcoded subtitle languages",1,"fa","fa-wrench"],[1,"icon-link",3,"href"],["aria-hidden","true","title","Click to play video",1,"fa","fa-play-circle-o"],[1,"text-right"],["class","p-tag language ml-2",4,"ngFor","ngForOf"],["class","p-tag language ml-2",4,"ngIf"],[1,"p-tag","filetype","ml-2"],[1,"p-tag","language","ml-2"],[3,"visible","imdbId","title","movieSettings","visibleChange"],[3,"visible","videoSubtitles","visibleChange","save"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"p-panel",1),e._UZ(2,"app-library-scanning"),e.TgZ(3,"app-message",2),e._UZ(4,"i",3),e.TgZ(5,"span"),e._uU(6,"Refreshing movie details..."),e.qZA(),e.qZA(),e.YNc(7,se,50,13,"div",4),e.qZA(),e.qZA(),e._UZ(8,"p-confirmDialog",5),e.YNc(9,re,1,4,"app-movie-settings",6),e.YNc(10,le,1,2,"app-library-video-subtitles",7)),2&t&&(e.xp6(3),e.Q6J("visible",a.refreshInProgress),e.xp6(4),e.Q6J("ngIf",a.movie),e.xp6(2),e.Q6J("ngIf",a.showMovieSettings),e.xp6(1),e.Q6J("ngIf",a.showVideoSubtitles))},directives:[_.s,b,q.q,l.O5,J.Q,T.z1,l.sg,f,c.iA,v.jx,z.T,F],styles:[""]}),i})();var k=r(7200),Y=r(1450);function ce(i,o){if(1&i&&(e.TgZ(0,"div",9),e.TgZ(1,"span",10),e._UZ(2,"p-button",11),e.qZA(),e.TgZ(3,"span",12),e._UZ(4,"app-table-filter",13),e.qZA(),e.qZA()),2&i){const t=e.oxw(),a=e.MAs(6);e.xp6(2),e.Q6J("label",t.nrOfMovies+" movies"),e.xp6(2),e.Q6J("table",a)("tableStateKey",t.tableStateKey)}}function pe(i,o){1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"th",14),e.TgZ(2,"span"),e._uU(3,"Title"),e._UZ(4,"p-sortIcon",15),e.qZA(),e.qZA(),e.TgZ(5,"th",16),e.TgZ(6,"span"),e._uU(7,"Year"),e._UZ(8,"p-sortIcon",17),e.qZA(),e.qZA(),e.TgZ(9,"th",18),e.TgZ(10,"span"),e._uU(11,"Path"),e._UZ(12,"p-sortIcon",19),e.qZA(),e.qZA(),e.TgZ(13,"th",20),e.TgZ(14,"span"),e._uU(15,"Wanted subtitles"),e._UZ(16,"p-sortIcon",21),e.qZA(),e.qZA(),e.TgZ(17,"th",22),e.TgZ(18,"span"),e._uU(19,"Subtitles"),e._UZ(20,"p-sortIcon",23),e.qZA(),e.qZA(),e.qZA())}function de(i,o){if(1&i&&e._UZ(0,"img",36),2&i){const t=e.oxw().$implicit,a=e.oxw();e.Q6J("lazyLoad",a.getMoviePosterThumbnailUrl(t.imdbId))("defaultImage",a.getPosterPlaceholderUrl())}}function ve(i,o){if(1&i&&(e.TgZ(0,"span",37),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}const Q=function(i){return["/library/movie/detail",i]};function ue(i,o){if(1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"span",24),e._uU(3,"Title"),e.qZA(),e.TgZ(4,"span",25),e.TgZ(5,"span",26),e.TgZ(6,"span",27),e.TgZ(7,"a",28),e.YNc(8,de,1,2,"img",29),e.qZA(),e.qZA(),e.TgZ(9,"span",30),e.TgZ(10,"a",31),e._uU(11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"td"),e.TgZ(13,"span",24),e._uU(14,"Year"),e.qZA(),e.TgZ(15,"span",32),e._uU(16),e.qZA(),e.qZA(),e.TgZ(17,"td"),e.TgZ(18,"span",24),e._uU(19,"Path"),e.qZA(),e.TgZ(20,"span",33),e._uU(21),e.qZA(),e.qZA(),e.TgZ(22,"td"),e.TgZ(23,"span",24),e._uU(24,"Wanted subtitles"),e.qZA(),e.TgZ(25,"span",32),e.YNc(26,ve,2,1,"span",34),e.qZA(),e.qZA(),e.TgZ(27,"td"),e.TgZ(28,"span",24),e._uU(29,"Subtitles"),e.qZA(),e.TgZ(30,"span",32),e._UZ(31,"app-progress-bar",35),e.qZA(),e.qZA(),e.qZA()),2&i){const t=o.$implicit;e.xp6(7),e.Q6J("routerLink",e.VKq(10,Q,t.imdbId))("title",t.title),e.xp6(1),e.Q6J("ngIf",t.poster),e.xp6(2),e.Q6J("routerLink",e.VKq(12,Q,t.imdbId)),e.xp6(1),e.Oqu(t.title),e.xp6(5),e.Oqu(t.year),e.xp6(5),e.Oqu(t.path),e.xp6(5),e.Q6J("ngForOf",t.settings.wantedLanguages),e.xp6(5),e.Q6J("value",t.totalSubtitlesAvailable)("total",t.totalSubtitlesWanted)}}const he=function(){return{showAll:"All"}},me=function(i){return[5,10,25,50,i]};let _e=(()=>{class i{constructor(t,a,n,s){this.systemEventService=t,this.movieService=a,this.artworkService=n,this.messageService=s,this.loading=!1,this.nrOfMovies=0,this.globalFilterFields=["title","year","path","settings.wantedLanguages","totalSubtitlesAvailable"],this.tableStateKey="autosubliminal-library-movie-overview-table"}ngOnInit(){this.loadOverview(),this.scanLibrarySubscription=this.systemEventService.schedulerFinish.subscribe(t=>{t.name===u.$0.scanLibrary&&this.loadOverview()})}ngOnDestroy(){this.scanLibrarySubscription.unsubscribe()}loadOverview(){this.loading=!0,this.movieService.getMovies().subscribe(t=>{this.movies=t,this.nrOfMovies=this.movies.length,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the movies!"))}sort(t){(0,k.S)(t)}getMoviePosterThumbnailUrl(t){return this.artworkService.getMoviePosterThumbnailUrl(t)}getPosterPlaceholderUrl(){return"assets/poster-placeholder.jpg"}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.h),e.Y36(A.u),e.Y36(Z.O),e.Y36(m.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-library-movie-overview"]],decls:10,vars:14,consts:[[1,"container-lg"],["header","Movie library"],[1,"row"],[1,"col-12","library-overview-container"],["stateStorage","local","currentPageReportTemplate","{first} to {last} of {totalRecords}","styleClass","p-datatable-sm p-datatable-gridlines p-datatable-striped p-datatable-responsive-mode",3,"value","stateKey","loading","autoLayout","rowHover","paginator","rows","rowsPerPageOptions","showCurrentPageReport","globalFilterFields","customSort","sortFunction"],["movieTable",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"caption"],[1,"w-100"],["styleClass","p-button-static p-button-outlined",3,"label"],[1,"ml-auto"],["matchMode","contains",3,"table","tableStateKey"],["pSortableColumn","title"],["field","title"],["pSortableColumn","year"],["field","year"],["pSortableColumn","path"],["field","path"],["pSortableColumn","settings.wantedLanguages"],["field","settings.wantedLanguages"],["pSortableColumn","totalSubtitlesAvailable"],["field","totalSubtitlesAvailable"],[1,"p-column-title"],[1,"p-column-data","title-container"],[1,"title-container-wrapper"],[1,"title-poster-container"],[3,"routerLink","title"],["class","title-poster-image",3,"lazyLoad","defaultImage",4,"ngIf"],[1,"title-text"],[3,"routerLink"],[1,"p-column-data"],[1,"p-column-data","wrap-text"],["class","p-tag p-tag-small p-tag-secondary mr-2",4,"ngFor","ngForOf"],[1,"w-100",3,"value","total"],[1,"title-poster-image",3,"lazyLoad","defaultImage"],[1,"p-tag","p-tag-small","p-tag-secondary","mr-2"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"p-panel",1),e._UZ(2,"app-library-scanning"),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e.TgZ(5,"p-table",4,5),e.NdJ("sortFunction",function(s){return a.sort(s)}),e.YNc(7,ce,5,3,"ng-template",6),e.YNc(8,pe,21,0,"ng-template",7),e.YNc(9,ue,32,14,"ng-template",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Q6J("value",a.movies)("stateKey",a.tableStateKey)("loading",a.loading)("autoLayout",!0)("rowHover",!0)("paginator",!0)("rows",10)("rowsPerPageOptions",e.VKq(12,me,e.DdM(11,he)))("showCurrentPageReport",!0)("globalFilterFields",a.globalFilterFields)("customSort",!0))},directives:[_.s,b,c.iA,v.jx,S.zx,Y.l,c.lQ,c.fz,g.yS,l.O5,l.sg,f,T.z1],styles:[""]}),i})();var be=r(5758),C=r(4915),N=r(1738);function fe(i,o){if(1&i&&(e.TgZ(0,"li"),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&i){const t=o.$implicit;e.xp6(2),e.Oqu(t)}}function Ze(i,o){if(1&i&&(e.TgZ(0,"app-icon-dropdown",12),e.TgZ(1,"li"),e.TgZ(2,"span",13),e._uU(3,"List of failed shows:"),e.qZA(),e.qZA(),e._UZ(4,"hr"),e.YNc(5,fe,3,1,"li",14),e.qZA()),2&i){const t=e.oxw(2);e.xp6(5),e.Q6J("ngForOf",t.showsOverview.failedShows)}}const we=function(){return["/library/show/overview"]};function Te(i,o){if(1&i&&(e.TgZ(0,"div",5),e.TgZ(1,"div",6),e.TgZ(2,"div",7),e.TgZ(3,"a",8),e._UZ(4,"img",9),e.qZA(),e.qZA(),e.TgZ(5,"div",7),e.TgZ(6,"span"),e.TgZ(7,"span"),e._uU(8),e.qZA(),e.YNc(9,Ze,6,1,"app-icon-dropdown",10),e.qZA(),e.TgZ(10,"span"),e._uU(11),e.qZA(),e.qZA(),e.TgZ(12,"div",7),e.TgZ(13,"span"),e._uU(14,"Total subtitles available:"),e.qZA(),e.qZA(),e.TgZ(15,"div",7),e._UZ(16,"app-progress-bar",11),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("routerLink",e.DdM(6,we)),e.xp6(5),e.hij("Total shows: ",t.showsOverview.totalShows,""),e.xp6(1),e.Q6J("ngIf",t.showsOverview.failedShows.length>0),e.xp6(2),e.hij("Total episodes: ",t.showsOverview.totalEpisodes,""),e.xp6(5),e.Q6J("value",t.showsOverview.totalSubtitlesAvailable)("total",t.showsOverview.totalSubtitlesWanted)}}function ye(i,o){if(1&i&&(e.TgZ(0,"li"),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&i){const t=o.$implicit;e.xp6(2),e.Oqu(t)}}function Se(i,o){if(1&i&&(e.TgZ(0,"app-icon-dropdown",12),e.TgZ(1,"li"),e.TgZ(2,"span",13),e._uU(3,"List of failed movies:"),e.qZA(),e.qZA(),e._UZ(4,"hr"),e.YNc(5,ye,3,1,"li",14),e.qZA()),2&i){const t=e.oxw(2);e.xp6(5),e.Q6J("ngForOf",t.moviesOverview.failedMovies)}}const xe=function(){return["/library/movie/overview"]};function Ae(i,o){if(1&i&&(e.TgZ(0,"div",15),e.TgZ(1,"div",6),e.TgZ(2,"div",7),e.TgZ(3,"a",8),e._UZ(4,"img",16),e.qZA(),e.qZA(),e.TgZ(5,"div",7),e.TgZ(6,"span"),e.TgZ(7,"span"),e._uU(8),e.qZA(),e.YNc(9,Se,6,1,"app-icon-dropdown",10),e.qZA(),e.qZA(),e.TgZ(10,"div",7),e.TgZ(11,"span"),e._uU(12,"Total subtitles available:"),e.qZA(),e.qZA(),e.TgZ(13,"div",7),e._UZ(14,"app-progress-bar",11),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("routerLink",e.DdM(5,xe)),e.xp6(5),e.hij("Total movies: ",t.moviesOverview.totalMovies,""),e.xp6(1),e.Q6J("ngIf",t.moviesOverview.failedMovies.length>0),e.xp6(5),e.Q6J("value",t.moviesOverview.totalSubtitlesAvailable)("total",t.moviesOverview.totalSubtitlesWanted)}}let qe=(()=>{class i{constructor(t,a,n,s){this.systemEventService=t,this.showService=a,this.movieService=n,this.messageService=s,this.loading=!1}ngOnInit(){this.loadOverview(),this.scanLibrarySubscription=this.systemEventService.schedulerFinish.subscribe(t=>{t.name===u.$0.scanLibrary&&this.loadOverview()})}ngOnDestroy(){this.scanLibrarySubscription.unsubscribe()}loadOverview(){this.loading=!0,(0,be.D)([this.showService.getShowsOverview(),this.movieService.getMoviesOverview()]).subscribe(([t,a])=>{this.showsOverview=t,this.moviesOverview=a,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the library overview!"))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.h),e.Y36(C.X),e.Y36(A.u),e.Y36(m.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-library-overview"]],decls:6,vars:2,consts:[[1,"container-lg"],["header","Library overview"],[1,"row"],["class","col-12 col-sm-12 col-md-6 col-lg-6 mb-3 mb-sm-3 mb-md-0 mb-lg-0",4,"ngIf"],["class","col-12 col-sm-12 col-md-6 col-lg-6",4,"ngIf"],[1,"col-12","col-sm-12","col-md-6","col-lg-6","mb-3","mb-sm-3","mb-md-0","mb-lg-0"],[1,"overview-container"],[1,"overview-data"],[3,"routerLink"],["src","assets/shows.jpg","title","Click to view shows",1,"overview-image"],["iconClass","fa fa-exclamation-triangle text-danger",4,"ngIf"],[1,"w-100",3,"value","total"],["iconClass","fa fa-exclamation-triangle text-danger"],[1,"icon-dropdown-title"],[4,"ngFor","ngForOf"],[1,"col-12","col-sm-12","col-md-6","col-lg-6"],["src","assets/movies.jpg","title","Click to view movies",1,"overview-image","image-hover"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"p-panel",1),e._UZ(2,"app-library-scanning"),e.TgZ(3,"div",2),e.YNc(4,Te,17,7,"div",3),e.YNc(5,Ae,15,6,"div",4),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",a.showsOverview),e.xp6(1),e.Q6J("ngIf",a.moviesOverview))},directives:[_.s,b,l.O5,g.yS,f,N.G,l.sg],styles:[".image-box[_ngcontent-%COMP%], .overview-container[_ngcontent-%COMP%]   .overview-image[_ngcontent-%COMP%]{box-shadow:3px 3px 3px #000;-webkit-box-shadow:3px 3px 3px #000000;-moz-box-shadow:3px 3px 3px #000000;border:1px solid #000000}.image-hover[_ngcontent-%COMP%]:hover, .overview-container[_ngcontent-%COMP%]   .overview-image[_ngcontent-%COMP%]:hover{-moz-filter:brightness(75%);-o-filter:brightness(75%);filter:brightness(75%)}.overview-container[_ngcontent-%COMP%]{border:1px solid var(--surface-d);border-radius:.25rem;padding:1rem}.overview-container[_ngcontent-%COMP%]   .overview-image[_ngcontent-%COMP%]{width:100%}.overview-container[_ngcontent-%COMP%]   .overview-data[_ngcontent-%COMP%]{display:flex;-moz-justify-content:space-between;-ms-justify-content:space-between;justify-content:space-between;-ms-flex-pack:space-between}.overview-container[_ngcontent-%COMP%]   .overview-data[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:.5rem}"]}),i})();var U=r(4627),Ce=r(3994);function Ue(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"a",20),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addShowPathToVideoPaths()}),e._UZ(1,"i",36),e.qZA()}}function Le(i,o){if(1&i&&(e.TgZ(0,"span",37),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function Oe(i,o){if(1&i&&e._UZ(0,"p-button",47),2&i){const t=o.$implicit,a=e.oxw(2).$implicit,n=e.oxw(2);e.Q6J("label",t)("badge",n.getNrOfSubtitles(a.files,t))}}function Me(i,o){if(1&i&&(e.TgZ(0,"div",42),e.TgZ(1,"div",43),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"app-icon-dropdown"),e.TgZ(5,"li"),e._uU(6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",44),e.YNc(8,Oe,1,2,"p-button",45),e._UZ(9,"p-button",46),e.qZA(),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(3),e.Oqu(t.seasonName),e.xp6(3),e.Oqu(t.seasonPath),e.xp6(2),e.Q6J("ngForOf",a.show.settings.wantedLanguages),e.xp6(1),e.Q6J("badge",a.getNrOfVideos(t.files))}}function Ie(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"a",20),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,s=e.oxw().$implicit;return e.oxw(2).openVideoSubtitlesDialog(n.tvdbId,s.seasonPath,n.filename,n.hardcodedLanguages)}),e._UZ(1,"i",51),e.qZA()}}function Pe(i,o){if(1&i&&(e.TgZ(0,"a",52),e._UZ(1,"i",53),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit,n=e.oxw(2);e.Q6J("href",n.getPlayVideoUrl(a.seasonPath,t.filename),e.LSH)}}function De(i,o){if(1&i&&(e.TgZ(0,"span",58),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function Je(i,o){if(1&i&&(e.TgZ(0,"span",58),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function Fe(i,o){1&i&&(e.TgZ(0,"span",58),e._uU(1,"internal"),e.qZA())}function ke(i,o){if(1&i&&(e.TgZ(0,"td",54),e.YNc(1,De,2,1,"span",55),e.YNc(2,Je,2,1,"span",55),e.YNc(3,Fe,2,0,"span",56),e.TgZ(4,"span",57),e._uU(5),e.qZA(),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.hardcodedLanguages),e.xp6(1),e.Q6J("ngForOf",t.embeddedLanguages),e.xp6(1),e.Q6J("ngIf",t.internalLanguagesAvailable),e.xp6(2),e.Oqu(t.type)}}function Ye(i,o){if(1&i&&(e.TgZ(0,"span",58),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(t.language)}}function Qe(i,o){if(1&i&&(e.TgZ(0,"td",54),e.YNc(1,Ye,2,1,"span",56),e.TgZ(2,"span",57),e._uU(3),e.qZA(),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.language),e.xp6(2),e.Oqu(t.type)}}function Ne(i,o){if(1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"td",48),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"span",17),e.YNc(5,Ie,2,0,"a",28),e.YNc(6,Pe,2,1,"a",49),e.qZA(),e.qZA(),e.YNc(7,ke,6,4,"td",50),e.YNc(8,Qe,4,2,"td",50),e.qZA()),2&i){const t=o.$implicit;e.xp6(3),e.Oqu(t.filename),e.xp6(2),e.Q6J("ngIf",t.isVideo),e.xp6(1),e.Q6J("ngIf",t.isVideo),e.xp6(1),e.Q6J("ngIf",t.isVideo),e.xp6(1),e.Q6J("ngIf",t.isSubtitle)}}function Ve(i,o){if(1&i&&(e.TgZ(0,"div",9),e.TgZ(1,"div",38),e.TgZ(2,"p-table",39),e.YNc(3,Me,10,4,"ng-template",40),e.YNc(4,Ne,9,5,"ng-template",41),e.qZA(),e.qZA(),e.qZA()),2&i){const t=o.$implicit;e.xp6(2),e.Q6J("value",t.files)("autoLayout",!0)}}function $e(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"div",9),e.TgZ(2,"div",10),e.TgZ(3,"div",11),e.TgZ(4,"a",12),e._UZ(5,"img",13),e.qZA(),e.qZA(),e.TgZ(6,"div",14),e.TgZ(7,"div",15),e.TgZ(8,"div",16),e.TgZ(9,"span"),e._uU(10),e.qZA(),e.TgZ(11,"span",17),e.TgZ(12,"a",18),e._UZ(13,"i",19),e.qZA(),e.TgZ(14,"a",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().openSettingsDialog()}),e._UZ(15,"i",21),e.qZA(),e.TgZ(16,"a",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().refreshShowDetails()}),e._UZ(17,"i",22),e.qZA(),e.TgZ(18,"a",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().openDeleteDialog()}),e._UZ(19,"i",23),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"div",15),e.TgZ(21,"div",24),e._UZ(22,"hr"),e.qZA(),e.qZA(),e.TgZ(23,"div",9),e.TgZ(24,"div",24),e._uU(25),e.qZA(),e.qZA(),e.TgZ(26,"div",25),e.TgZ(27,"div",26),e._uU(28,"Location:"),e.qZA(),e.TgZ(29,"div",27),e._uU(30),e.YNc(31,Ue,2,0,"a",28),e.qZA(),e.qZA(),e.TgZ(32,"div",25),e.TgZ(33,"div",26),e._uU(34,"Wanted languages:"),e.qZA(),e.TgZ(35,"div",29),e.YNc(36,Le,2,1,"span",30),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"div",9),e.TgZ(38,"div",24),e._UZ(39,"hr"),e.TgZ(40,"div",31),e.TgZ(41,"span",32),e._uU(42,"Files"),e.qZA(),e.TgZ(43,"span",33),e._UZ(44,"app-progress-bar",34),e.qZA(),e.qZA(),e._UZ(45,"hr"),e.qZA(),e.qZA(),e.YNc(46,Ve,5,2,"div",35),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.Q6J("href",t.getShowPosterFullSizeUrl(),e.LSH),e.xp6(1),e.Q6J("lazyLoad",t.getShowPosterThumbnailUrl())("defaultImage",t.getPosterPlaceholderUrl()),e.xp6(5),e.Oqu(t.show.name),e.xp6(2),e.Q6J("href",t.getTvdbUrl(),e.LSH),e.xp6(13),e.Oqu(t.show.overview),e.xp6(5),e.hij(" ",t.show.path," "),e.xp6(1),e.Q6J("ngIf",!t.show.pathInVideoPaths),e.xp6(5),e.Q6J("ngForOf",t.show.settings.wantedLanguages),e.xp6(8),e.Q6J("value",t.show.totalSubtitlesAvailable)("total",t.show.totalSubtitlesWanted),e.xp6(2),e.Q6J("ngForOf",t.show.seasons)}}function ze(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"app-show-settings",59),e.NdJ("visibleChange",function(n){return e.CHM(t),e.oxw().showShowSettings=n}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("visible",t.showShowSettings)("tvdbId",t.show.tvdbId)("title",t.show.name)("showSettings",t.show.settings)}}function Ee(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"app-library-video-subtitles",60),e.NdJ("visibleChange",function(n){return e.CHM(t),e.oxw().showVideoSubtitles=n})("save",function(n){return e.CHM(t),e.oxw().saveHardcodedSubtitles(n)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("visible",t.showVideoSubtitles)("videoSubtitles",t.videoSubtitles)}}let He=(()=>{class i{constructor(t,a,n,s,p,L,O,M){this.route=t,this.router=a,this.domSanitizer=n,this.showService=s,this.artworkService=p,this.settingsService=L,this.messageService=O,this.confirmationService=M,this.loading=!1,this.refreshInProgress=!1,this.showShowSettings=!1,this.showVideoSubtitles=!1}ngOnInit(){this.route.paramMap.subscribe(t=>{this.loading=!0;const a=Number(t.get("tvdbId"));this.getShowDetails(a)})}getShowPosterFullSizeUrl(){return this.artworkService.getShowPosterFullSizeUrl(this.show.tvdbId)}getShowPosterThumbnailUrl(){return this.artworkService.getShowPosterThumbnailUrl(this.show.tvdbId)}getPosterPlaceholderUrl(){return(0,d.WF)()}getTvdbUrl(){return(0,d.zS)(this.show.tvdbId)}getPlayVideoUrl(t,a){return this.domSanitizer.bypassSecurityTrustResourceUrl((0,d.TZ)(t,a))}openSettingsDialog(){this.showShowSettings=!0}refreshShowDetails(){this.refreshInProgress=!0,this.showService.refreshShowDetails(this.show.tvdbId).subscribe(()=>{this.getShowDetails(this.show.tvdbId),this.refreshInProgress=!1},()=>this.messageService.showErrorMessage("Unable to refresh the show details!"))}openDeleteDialog(){this.confirmationService.confirm({message:`Are you sure that you want to delete <b>${this.show.name}</b>?`,accept:()=>{this.showService.deleteShow(this.show.tvdbId).subscribe(()=>{this.router.navigateByUrl("/library/show")},()=>this.messageService.showErrorMessage(`Unable to delete the show ${this.show.name}!`))}})}addShowPathToVideoPaths(){this.settingsService.updateGeneralSetting("videoPaths",{videoPath:this.show.path}).subscribe(()=>{this.messageService.showSuccessMessage(`Path ${this.show.path} added to the video paths.`),this.getShowDetails(this.show.tvdbId)},a=>{a.status&&409===a.status?this.messageService.showWarningMessage(`Path ${this.show.path} already added to the video paths.`):this.messageService.showErrorMessage(`Unable to add path ${this.show.path} to the video paths!`)})}openVideoSubtitlesDialog(t,a,n,s){this.episodeTvdbId=t,this.videoSubtitles=new x.A,this.videoSubtitles.fileLocation=a,this.videoSubtitles.fileName=n,this.videoSubtitles.languages=s,this.showVideoSubtitles=!0}closeVideoSubtitlesDialog(){this.showVideoSubtitles=!1,this.videoSubtitles=null,this.episodeTvdbId=null}saveHardcodedSubtitles(t){this.showService.saveShowHardcodedSubtitles(this.show.tvdbId,this.episodeTvdbId,t).subscribe(()=>{this.closeVideoSubtitlesDialog(),this.getShowDetails(this.show.tvdbId)},()=>this.messageService.showErrorMessage("Unable to save the harcoded subtitles!"))}getNrOfSubtitles(t,a){let n=0;return t.forEach(s=>{s.type===U.T.SUBTITLE&&s.language&&s.language===a?n++:s.type===U.T.VIDEO&&(s.hardcodedLanguages&&s.hardcodedLanguages.forEach(p=>{p===a&&n++}),s.embeddedLanguages&&s.embeddedLanguages.forEach(p=>{p===a&&n++}))}),n.toString()}getNrOfVideos(t){let a=0;return t.forEach(n=>{n.type===U.T.VIDEO&&a++}),a.toString()}getShowDetails(t){this.showService.getShowDetails(t).subscribe(a=>{this.show=a,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the show details!"))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.gz),e.Y36(g.F0),e.Y36(P.H7),e.Y36(C.X),e.Y36(Z.O),e.Y36(D.g),e.Y36(m.e),e.Y36(v.YP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-library-show-detail"]],decls:11,vars:4,consts:[[1,"container-lg"],["header","Show details"],[3,"visible"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin","mr-2"],["class","library-details-container",4,"ngIf"],["header","Confirmation","icon","pi pi-exclamation-triangle"],[3,"visible","tvdbId","title","showSettings","visibleChange",4,"ngIf"],[3,"visible","videoSubtitles","visibleChange","save",4,"ngIf"],[1,"library-details-container"],[1,"row","mb-3"],[1,"col-12","library-details-info-container"],[1,"library-details-info-poster"],["target","_blank",3,"href"],["title","Click to view full size",1,"library-details-info-poster-image",3,"lazyLoad","defaultImage"],[1,"library-details-info"],[1,"row"],[1,"col-12","library-details-info-title"],[1,"icon-group"],["target","_blank",1,"icon-link",3,"href"],["aria-hidden","true","title","Click to visit Tvdb",1,"fa","fa-television"],[1,"icon-link",3,"click"],["aria-hidden","true","title","Click to edit show settings",1,"fa","fa-wrench"],["aria-hidden","true","title","Click to refresh show details",1,"fa","fa-repeat"],["aria-hidden","true","title","Click to delete show from the database",1,"fa","fa-trash"],[1,"col-12"],[1,"row","mb-2"],[1,"col-3"],[1,"col-9","wrap-text"],["class","icon-link",3,"click",4,"ngIf"],[1,"col-9"],["class","p-tag language mr-2",4,"ngFor","ngForOf"],[1,"library-details-files-summary"],[1,"summary-title"],[1,"summary-progress-bar","ml-auto"],[3,"value","total"],["class","row mb-3",4,"ngFor","ngForOf"],["aria-hidden","true","title","Click to add the show path to the video paths to scan",1,"fa","fa-plus"],[1,"p-tag","language","mr-2"],[1,"col-12","library-details-files"],["styleClass","p-datatable-sm",3,"value","autoLayout"],["pTemplate","caption"],["pTemplate","body"],[1,"table-caption"],[1,"table-caption-title"],[1,"ml-auto"],["styleClass","p-button-static p-button-outlined p-button-sm ml-2",3,"label","badge",4,"ngFor","ngForOf"],["label","video","styleClass","p-button-static p-button-outlined p-button-sm ml-2",3,"badge"],["styleClass","p-button-static p-button-outlined p-button-sm ml-2",3,"label","badge"],[1,"wrap-text"],["class","icon-link",3,"href",4,"ngIf"],["class","text-right",4,"ngIf"],["aria-hidden","true","title","Click to save hardcoded subtitle languages",1,"fa","fa-wrench"],[1,"icon-link",3,"href"],["aria-hidden","true","title","Click to play video",1,"fa","fa-play-circle-o"],[1,"text-right"],["class","p-tag language ml-2",4,"ngFor","ngForOf"],["class","p-tag language ml-2",4,"ngIf"],[1,"p-tag","filetype","ml-2"],[1,"p-tag","language","ml-2"],[3,"visible","tvdbId","title","showSettings","visibleChange"],[3,"visible","videoSubtitles","visibleChange","save"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"p-panel",1),e._UZ(2,"app-library-scanning"),e.TgZ(3,"app-message",2),e._UZ(4,"i",3),e.TgZ(5,"span"),e._uU(6,"Refreshing show details..."),e.qZA(),e.qZA(),e.YNc(7,$e,47,12,"div",4),e.qZA(),e.qZA(),e._UZ(8,"p-confirmDialog",5),e.YNc(9,ze,1,4,"app-show-settings",6),e.YNc(10,Ee,1,2,"app-library-video-subtitles",7)),2&t&&(e.xp6(3),e.Q6J("visible",a.refreshInProgress),e.xp6(4),e.Q6J("ngIf",a.show),e.xp6(2),e.Q6J("ngIf",a.showShowSettings),e.xp6(1),e.Q6J("ngIf",a.showVideoSubtitles))},directives:[_.s,b,q.q,l.O5,J.Q,T.z1,l.sg,f,c.iA,v.jx,N.G,S.zx,Ce.G,F],styles:[""]}),i})();function Ke(i,o){if(1&i&&(e.TgZ(0,"div",9),e.TgZ(1,"span",10),e._UZ(2,"p-button",11),e.qZA(),e.TgZ(3,"span",12),e._UZ(4,"app-table-filter",13),e.qZA(),e.qZA()),2&i){const t=e.oxw(),a=e.MAs(6);e.xp6(2),e.Q6J("label",t.nrOfShows+" shows"),e.xp6(2),e.Q6J("table",a)("tableStateKey",t.tableStateKey)}}function je(i,o){1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"th",14),e.TgZ(2,"span"),e._uU(3,"Title"),e._UZ(4,"p-sortIcon",15),e.qZA(),e.qZA(),e.TgZ(5,"th",16),e.TgZ(6,"span"),e._uU(7,"Year"),e._UZ(8,"p-sortIcon",17),e.qZA(),e.qZA(),e.TgZ(9,"th",18),e.TgZ(10,"span"),e._uU(11,"Path"),e._UZ(12,"p-sortIcon",19),e.qZA(),e.qZA(),e.TgZ(13,"th",20),e.TgZ(14,"span"),e._uU(15,"Wanted subtitles"),e._UZ(16,"p-sortIcon",21),e.qZA(),e.qZA(),e.TgZ(17,"th",22),e.TgZ(18,"span"),e._uU(19,"Subtitles"),e._UZ(20,"p-sortIcon",23),e.qZA(),e.qZA(),e.qZA())}function We(i,o){if(1&i&&e._UZ(0,"img",33),2&i){const t=e.oxw().$implicit,a=e.oxw();e.Q6J("lazyLoad",a.getShowBannerThumbnailUrl(t.tvdbId))("defaultImage",a.getBannerPlaceholderUrl())}}function Be(i,o){if(1&i&&(e.TgZ(0,"span",34),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}const Re=function(i){return["/library/show/detail",i]};function Xe(i,o){if(1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"span",24),e._uU(3,"Title"),e.qZA(),e.TgZ(4,"span",25),e.TgZ(5,"span",26),e.TgZ(6,"a",27),e.YNc(7,We,1,2,"img",28),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"td"),e.TgZ(9,"span",24),e._uU(10,"Year"),e.qZA(),e.TgZ(11,"span",29),e._uU(12),e.qZA(),e.qZA(),e.TgZ(13,"td"),e.TgZ(14,"span",24),e._uU(15,"Path"),e.qZA(),e.TgZ(16,"span",30),e._uU(17),e.qZA(),e.qZA(),e.TgZ(18,"td"),e.TgZ(19,"span",24),e._uU(20,"Wanted subtitles"),e.qZA(),e.TgZ(21,"span",29),e.YNc(22,Be,2,1,"span",31),e.qZA(),e.qZA(),e.TgZ(23,"td"),e.TgZ(24,"span",24),e._uU(25,"Subtitles"),e.qZA(),e.TgZ(26,"span",29),e._UZ(27,"app-progress-bar",32),e.qZA(),e.qZA(),e.qZA()),2&i){const t=o.$implicit;e.xp6(6),e.Q6J("routerLink",e.VKq(8,Re,t.tvdbId))("title",t.title),e.xp6(1),e.Q6J("ngIf",t.banner),e.xp6(5),e.Oqu(t.year),e.xp6(5),e.Oqu(t.path),e.xp6(5),e.Q6J("ngForOf",t.settings.wantedLanguages),e.xp6(5),e.Q6J("value",t.totalSubtitlesAvailable)("total",t.totalSubtitlesWanted)}}const Ge=function(){return{showAll:"All"}},et=function(i){return[5,10,25,50,i]},tt=[{path:"",redirectTo:"overview",pathMatch:"full"},{path:"overview",component:qe},{path:"show",children:[{path:"overview",component:(()=>{class i{constructor(t,a,n,s){this.systemEventService=t,this.showService=a,this.artworkService=n,this.messageService=s,this.nrOfShows=0,this.globalFilterFields=["title","year","path","settings.wantedLanguages","totalSubtitlesAvailable"],this.tableStateKey="autosubliminal-library-show-overview-table",this.loading=!1}ngOnInit(){this.loadOverview(),this.scanLibrarySubscription=this.systemEventService.schedulerFinish.subscribe(t=>{t.name===u.$0.scanLibrary&&this.loadOverview()})}ngOnDestroy(){this.scanLibrarySubscription.unsubscribe()}loadOverview(){this.loading=!0,this.showService.getShows().subscribe(t=>{this.shows=t,this.nrOfShows=this.shows.length,this.loading=!1},()=>this.messageService.showErrorMessage("Unable to get the shows!"))}sort(t){(0,k.S)(t)}getShowBannerThumbnailUrl(t){return this.artworkService.getShowBannerThumbnailUrl(t)}getBannerPlaceholderUrl(){return(0,d.Ug)()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.h),e.Y36(C.X),e.Y36(Z.O),e.Y36(m.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-library-show-overview"]],decls:10,vars:14,consts:[[1,"container-lg"],["header","Show library"],[1,"row"],[1,"col-12","library-overview-container"],["stateStorage","local","currentPageReportTemplate","{first} to {last} of {totalRecords}","styleClass","p-datatable-sm p-datatable-gridlines p-datatable-striped p-datatable-responsive-mode",3,"value","stateKey","loading","autoLayout","rowHover","paginator","rows","rowsPerPageOptions","showCurrentPageReport","globalFilterFields","customSort","sortFunction"],["showTable",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"caption"],[1,"w-100"],["styleClass","p-button-static p-button-outlined",3,"label"],[1,"ml-auto"],["matchMode","contains",3,"table","tableStateKey"],["pSortableColumn","title"],["field","title"],["pSortableColumn","year"],["field","year"],["pSortableColumn","path"],["field","path"],["pSortableColumn","settings.wantedLanguages"],["field","settings.wantedLanguages"],["pSortableColumn","totalSubtitlesAvailable"],["field","totalSubtitlesAvailable"],[1,"p-column-title"],[1,"p-column-data","title-banner-container"],[1,"title-banner"],[3,"routerLink","title"],["class","title-banner-image",3,"lazyLoad","defaultImage",4,"ngIf"],[1,"p-column-data"],[1,"p-column-data","wrap-text"],["class","p-tag p-tag-small p-tag-secondary mr-2",4,"ngFor","ngForOf"],[1,"w-100",3,"value","total"],[1,"title-banner-image",3,"lazyLoad","defaultImage"],[1,"p-tag","p-tag-small","p-tag-secondary","mr-2"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"p-panel",1),e._UZ(2,"app-library-scanning"),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e.TgZ(5,"p-table",4,5),e.NdJ("sortFunction",function(s){return a.sort(s)}),e.YNc(7,Ke,5,3,"ng-template",6),e.YNc(8,je,21,0,"ng-template",7),e.YNc(9,Xe,28,10,"ng-template",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Q6J("value",a.shows)("stateKey",a.tableStateKey)("loading",a.loading)("autoLayout",!0)("rowHover",!0)("paginator",!0)("rows",10)("rowsPerPageOptions",e.VKq(12,et,e.DdM(11,Ge)))("showCurrentPageReport",!0)("globalFilterFields",a.globalFilterFields)("customSort",!0))},directives:[_.s,b,c.iA,v.jx,S.zx,Y.l,c.lQ,c.fz,g.yS,l.O5,l.sg,f,T.z1],styles:[""]}),i})()},{path:"detail/:tvdbId",component:He}]},{path:"movie",children:[{path:"overview",component:_e},{path:"detail/:imdbId",component:ge}]},{path:"**",redirectTo:"overview"}];let it=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[g.Bz.forChild(tt)],g.Bz]}),i})(),at=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[V.m,it]]}),i})()}}]);